import{r as n,s as i}from"./index-BjEpDsqA.js";const E=()=>{const[p,a]=n.useState([]),[b,h]=n.useState(!0),[f,d]=n.useState(null),w=async()=>{try{h(!0),d(null);const{data:{session:r}}=await i.auth.getSession();if(!r)throw new Error("No active session");const t=await fetch("https://dkawxgwdqiirgmmjbvhc.supabase.co/functions/v1/bot-management",{method:"GET",headers:{Authorization:`Bearer ${r.access_token}`,"Content-Type":"application/json"}});if(!t.ok){const e=await t.text();throw console.error("Bot fetch error:",t.status,e),new Error(`Failed to fetch bots: ${t.status}`)}const o=await t.json();a(Array.isArray(o.bots)?o.bots:[])}catch(r){console.error("Error fetching bots:",r),d(r instanceof Error?r.message:"Failed to fetch bots"),a([])}finally{h(!1)}},l=async r=>{try{const{data:{session:t}}=await i.auth.getSession();if(!t)throw new Error("No active session");const o=await fetch("https://dkawxgwdqiirgmmjbvhc.supabase.co/functions/v1/bot-management",{method:"POST",headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"create",botData:r})});if(!o.ok){const s=await o.text();throw console.error("Bot creation error:",o.status,s),new Error(`Failed to create bot: ${o.status}`)}const e=await o.json();if(e.bot)return a(s=>[e.bot,...s]),e.bot;throw new Error("No bot data returned")}catch(t){throw console.error("Error creating bot:",t),t}},g=async(r,t)=>{try{const{data:{session:o}}=await i.auth.getSession();if(!o)throw new Error("No active session");const e=await fetch("https://dkawxgwdqiirgmmjbvhc.supabase.co/functions/v1/bot-management",{method:"POST",headers:{Authorization:`Bearer ${o.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"update",botId:r,updates:t})});if(!e.ok){const c=await e.text();throw console.error("Bot update error:",e.status,c),new Error(`Failed to update bot: ${e.status}`)}const s=await e.json();if(s.bot)return a(c=>c.map(u=>u.id===r?s.bot:u)),s.bot;throw new Error("No bot data returned")}catch(o){throw console.error("Error updating bot:",o),o}},m=async r=>{try{const{data:{session:t}}=await i.auth.getSession();if(!t)throw new Error("No active session");const o=await fetch("https://dkawxgwdqiirgmmjbvhc.supabase.co/functions/v1/bot-management",{method:"POST",headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"delete",botId:r})});if(!o.ok){const e=await o.text();throw console.error("Bot deletion error:",o.status,e),new Error(`Failed to delete bot: ${o.status}`)}a(e=>e.filter(s=>s.id!==r))}catch(t){throw console.error("Error deleting bot:",t),t}};return n.useEffect(()=>{w()},[]),{bots:p,loading:b,error:f,fetchBots:w,createBot:l,updateBot:g,deleteBot:m}};export{E as u};
//# sourceMappingURL=useBots-CQ5nlN-H.js.map
