{"version":3,"file":"page-b93ce2c2.js","sources":["../../src/pages/academy/page.tsx"],"sourcesContent":["import { useMemo } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Card from '../../components/base/Card';\r\nimport Button from '../../components/base/Button';\r\nimport Navigation from '../../components/feature/Navigation';\r\nimport Header from '../../components/feature/Header';\r\nimport { useAcademy, isModuleCompleted } from '../../hooks/useAcademy';\r\nimport { useAuth } from '../../hooks/useAuth';\r\n\r\nexport default function AcademyPage() {\r\n  const navigate = useNavigate();\r\n  const { user } = useAuth();\r\n  const { modules, summary, lessonProgress, loading, error } = useAcademy();\r\n\r\n  const modulesWithProgress = useMemo(\r\n    () =>\r\n      modules.map((module) => {\r\n        const total = module.lessons.length || 1;\r\n        const completedLessons = module.lessons.filter((lesson) =>\r\n          lessonProgress.find((p) => p.lesson_id === lesson.id && p.status === 'completed')\r\n        ).length;\r\n        const percent = Math.round((completedLessons / total) * 100);\r\n        const completed = isModuleCompleted(module, lessonProgress);\r\n        return { module, completedLessons, total, percent, completed };\r\n      }),\r\n    [modules, lessonProgress]\r\n  );\r\n\r\n  const modulesCompleted = summary?.modules_completed ?? 0;\r\n  const modulesAvailable = summary?.modules_available ?? modules.length;\r\n  const badgeEarned = summary?.badge_foundation_finisher ?? false;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 pb-24\">\r\n      <Header\r\n        title=\"Pablo Academy\"\r\n        subtitle=\"Master automation fundamentals with curated learning paths.\"\r\n        rightAction={\r\n          <Button variant=\"secondary\" size=\"sm\" onClick={() => navigate(summary?.badge_foundation_finisher ? '/dashboard' : '/academy/orientation-setup')}>\r\n            {modulesCompleted > 0 ? 'Continue Learning' : 'Start Orientation'}\r\n          </Button>\r\n        }\r\n      />\r\n\r\n      <main className=\"px-4 pt-24 pb-16\">\r\n        <div className=\"mx-auto flex max-w-6xl flex-col gap-6 lg:flex-row\">\r\n          <div className=\"flex-1 space-y-6\">\r\n            {error && (\r\n              <Card className=\"border border-red-200 bg-red-50 p-5 text-red-700\">\r\n                <p>We couldn&apos;t load Academy modules right now. Please try again shortly.</p>\r\n              </Card>\r\n            )}\r\n\r\n            {loading && !modules.length ? (\r\n              <Card className=\"p-6 text-center text-gray-500 dark:text-gray-300\">\r\n                <p>Loading Pablo Academy...</p>\r\n              </Card>\r\n            ) : (\r\n              modulesWithProgress.map(({ module, completed, percent, completedLessons, total }) => (\r\n                <Card\r\n                  key={module.id}\r\n                  className=\"group overflow-hidden border border-gray-200/70 bg-white/90 shadow-sm transition hover:-translate-y-1 hover:border-blue-300 hover:shadow-lg dark:border-gray-700 dark:bg-gray-900/90\"\r\n                >\r\n                  <div className=\"flex flex-col gap-4 p-6 md:flex-row md:gap-6\">\r\n                    <div className=\"flex w-full flex-col gap-3 md:w-[220px]\">\r\n                      <div className=\"aspect-video w-full overflow-hidden rounded-2xl bg-gray-100 dark:bg-gray-800 relative\">\r\n                        {module.media_url ? (\r\n                          (() => {\r\n                            const url = module.media_url.toLowerCase();\r\n                            const isImage = /\\.(jpg|jpeg|png|gif|webp|svg|avif)$/i.test(url) || url.includes('/images/') || url.includes('/img/');\r\n                            const isVideo = /\\.(mp4|webm|ogg|mov|avi)$/i.test(url) || url.includes('/videos/') || url.includes('/video/');\r\n                            \r\n                            if (isImage) {\r\n                              return (\r\n                                <img \r\n                                  src={module.media_url} \r\n                                  alt={module.title}\r\n                                  className=\"h-full w-full object-cover\" \r\n                                  loading=\"lazy\"\r\n                                />\r\n                              );\r\n                            } else if (isVideo) {\r\n                              return (\r\n                                <video \r\n                                  src={module.media_url} \r\n                                  className=\"h-full w-full object-cover\" \r\n                                  muted \r\n                                  playsInline \r\n                                />\r\n                              );\r\n                            } else {\r\n                              // Default: try as image\r\n                              return (\r\n                                <img \r\n                                  src={module.media_url} \r\n                                  alt={module.title}\r\n                                  className=\"h-full w-full object-cover\" \r\n                                  loading=\"lazy\"\r\n                                  onError={(e) => {\r\n                                    // Show placeholder on error\r\n                                    e.currentTarget.style.display = 'none';\r\n                                  }}\r\n                                />\r\n                              );\r\n                            }\r\n                          })()\r\n                        ) : (\r\n                          <div className=\"flex h-full items-center justify-center text-gray-400\">\r\n                            <i className=\"ri-image-line text-3xl\" />\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <div className=\"rounded-xl bg-blue-50 px-3 py-2 text-xs font-medium uppercase tracking-[0.3em] text-blue-600 dark:bg-blue-900/30 dark:text-blue-200/90\">\r\n                        Module {module.order_index ?? modules.indexOf(module) + 1}\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex-1 space-y-4\">\r\n                      <div>\r\n                        <div className=\"flex items-center gap-3\">\r\n                          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">{module.title}</h2>\r\n                          {completed && (\r\n                            <span className=\"inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-200\">\r\n                              <i className=\"ri-checkbox-circle-fill mr-1\" />\r\n                              Completed\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                        {module.summary && <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-300\">{module.summary}</p>}\r\n                      </div>\r\n\r\n                      <div className=\"flex flex-wrap items-center gap-4 text-xs font-medium text-gray-400 dark:text-gray-400\">\r\n                        {module.audience && (\r\n                          <span className=\"inline-flex items-center gap-1 rounded-full bg-gray-100 px-3 py-1 dark:bg-gray-800\">\r\n                            <i className=\"ri-user-star-line text-base\" />\r\n                            {module.audience}\r\n                          </span>\r\n                        )}\r\n                        <span className=\"inline-flex items-center gap-1 rounded-full bg-gray-100 px-3 py-1 dark:bg-gray-800\">\r\n                          <i className=\"ri-time-line text-base\" />\r\n                          {module.duration_minutes || 0} minutes\r\n                        </span>\r\n                        <span className=\"inline-flex items-center gap-1 rounded-full bg-gray-100 px-3 py-1 dark:bg-gray-800\">\r\n                          <i className=\"ri-play-list-2-line text-base\" />\r\n                          {total} lessons\r\n                        </span>\r\n                      </div>\r\n\r\n                      <div className=\"space-y-3\">\r\n                        <div className=\"flex items-center justify-between text-xs font-semibold text-gray-400\">\r\n                          <span>{completedLessons} of {total} lessons</span>\r\n                          <span>{percent}%</span>\r\n                        </div>\r\n                        <div className=\"h-2 w-full overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700\">\r\n                          <div\r\n                            className=\"h-full rounded-full bg-gradient-to-r from-sky-400 via-indigo-500 to-purple-500 transition-all\"\r\n                            style={{ width: `${percent}%` }}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"flex flex-wrap gap-3\">\r\n                        <Button onClick={() => navigate(`/academy/${module.slug}`)} size=\"sm\">\r\n                          {completed ? 'Review Module' : modulesCompleted > 0 ? 'Continue Module' : 'Start Module'}\r\n                        </Button>\r\n                        {!completed && (\r\n                          <Button\r\n                            variant=\"secondary\"\r\n                            size=\"sm\"\r\n                            onClick={() => navigate(`/academy/${module.slug}`)}\r\n                            className=\"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700\"\r\n                          >\r\n                            View Lessons\r\n                          </Button>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </Card>\r\n              ))\r\n            )}\r\n          </div>\r\n\r\n          <aside className=\"w-full max-w-xs space-y-6 lg:w-80\">\r\n            <Card className=\"space-y-4 border border-blue-100 bg-gradient-to-br from-white to-blue-50 p-6 shadow-sm dark:border-blue-900/40 dark:from-gray-900 dark:to-blue-950/40\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">Your Progress</h3>\r\n              <div className=\"text-3xl font-semibold text-blue-600 dark:text-blue-300\">\r\n                {loading ? '--' : modulesCompleted}\r\n                <span className=\"text-base font-medium text-gray-500 dark:text-gray-300\">\r\n                  {' '}\r\n                  / {modulesAvailable || modules.length} modules\r\n                </span>\r\n              </div>\r\n              <p className=\"text-sm text-gray-600 dark:text-gray-300\">\r\n                Track your progress as you unlock Pabloâ€™s capabilities. Complete the first three modules to earn your foundation badge.\r\n              </p>\r\n              <Button onClick={() => navigate('/academy/orientation-setup')} size=\"sm\">\r\n                {modulesCompleted > 0 ? 'Resume Learning' : 'Start Now'}\r\n              </Button>\r\n            </Card>\r\n\r\n            {badgeEarned && (\r\n              <Card className=\"space-y-3 border border-emerald-200 bg-emerald-50 p-5 text-emerald-800 dark:border-emerald-900/40 dark:bg-emerald-900/30 dark:text-emerald-200\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <span className=\"flex h-10 w-10 items-center justify-center rounded-full bg-emerald-100 text-emerald-600 dark:bg-emerald-900/60 dark:text-emerald-200\">\r\n                    <i className=\"ri-award-fill text-xl\" />\r\n                  </span>\r\n                  <div>\r\n                    <p className=\"text-sm font-semibold\">Foundation Finisher</p>\r\n                    <p className=\"text-xs opacity-80\">You completed the orientation trilogy. Keep going!</p>\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            )}\r\n\r\n            {!user && (\r\n              <Card className=\"space-y-3 border border-gray-200 bg-white p-5 text-sm text-gray-600 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300\">\r\n                <p>\r\n                  Create a Pablo account to save progress, unlock badges, and sync Academy outcomes to your automation workspace.\r\n                </p>\r\n                <Button variant=\"secondary\" onClick={() => navigate('/auth')} size=\"sm\">\r\n                  Sign In\r\n                </Button>\r\n              </Card>\r\n            )}\r\n          </aside>\r\n        </div>\r\n      </main>\r\n\r\n      <Navigation />\r\n    </div>\r\n  );\r\n}\r\n"],"names":["AcademyPage","navigate","useNavigate","user","useAuth","modules","summary","lessonProgress","loading","error","useAcademy","modulesWithProgress","useMemo","module","total","completedLessons","lesson","p","percent","completed","isModuleCompleted","modulesCompleted","modulesAvailable","badgeEarned","jsxs","jsx","Header","Button","Card","url","isImage","isVideo","e","Navigation"],"mappings":"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"}