{"version":3,"file":"page-ff23661f.js","sources":["../../src/services/pairRecommendations.ts","../../src/components/bot/PairRecommendations.tsx","../../src/pages/create-bot/page.tsx"],"sourcesContent":["/**\r\n * AI Pair-Based Recommendations Service\r\n * Provides optimized settings recommendations based on trading pair selection\r\n */\r\n\r\nimport { supabase } from '../lib/supabase';\r\nimport { openAIService } from './openai';\r\nimport type { TradingStrategy, AdvancedStrategyConfig } from '../types/trading';\r\n\r\nexport interface PairRecommendation {\r\n  symbol: string;\r\n  recommended: boolean;\r\n  confidence: number;\r\n  reasoning: string;\r\n  strategy: TradingStrategy;\r\n  advancedConfig?: AdvancedStrategyConfig;\r\n  expectedPerformance: string;\r\n  riskAssessment: 'low' | 'medium' | 'high';\r\n  suggestedTradeAmount: number;\r\n  suggestedLeverage: number;\r\n  suggestedStopLoss: number;\r\n  suggestedTakeProfit: number;\r\n  changes: {\r\n    parameter: string;\r\n    recommendedValue: any;\r\n    defaultValue: any;\r\n    reason: string;\r\n  }[];\r\n}\r\n\r\nclass PairRecommendationsService {\r\n  /**\r\n   * Get AI recommendations for a trading pair\r\n   */\r\n  async getRecommendationsForPair(\r\n    symbol: string,\r\n    tradingType: 'spot' | 'futures',\r\n    currentSettings?: {\r\n      strategy?: TradingStrategy;\r\n      advancedConfig?: AdvancedStrategyConfig;\r\n      tradeAmount?: number;\r\n      leverage?: number;\r\n      stopLoss?: number;\r\n      takeProfit?: number;\r\n    }\r\n  ): Promise<PairRecommendation | null> {\r\n    try {\r\n      // Fetch historical data for this pair from database\r\n      const { data: historicalTrades, error: tradesError } = await supabase\r\n        .from('trades')\r\n        .select('*')\r\n        .eq('symbol', symbol)\r\n        .gte('created_at', new Date(Date.now() - 90 * 24 * 60 * 60 * 1000).toISOString()) // Last 90 days\r\n        .order('created_at', { ascending: false })\r\n        .limit(100);\r\n\r\n      if (tradesError) {\r\n        console.error('Error fetching historical trades:', tradesError);\r\n      }\r\n\r\n      // Fetch existing bot configurations for this pair\r\n      const { data: existingBots, error: botsError } = await supabase\r\n        .from('trading_bots')\r\n        .select('strategy, strategy_config, trade_amount, leverage, status, win_rate, pnl')\r\n        .eq('symbol', symbol)\r\n        .in('status', ['running', 'paused'])\r\n        .order('created_at', { ascending: false })\r\n        .limit(10);\r\n\r\n      if (botsError) {\r\n        console.error('Error fetching existing bots:', botsError);\r\n      }\r\n\r\n      // Calculate performance metrics\r\n      const performanceMetrics = this.calculatePerformanceMetrics(\r\n        historicalTrades || [],\r\n        existingBots || []\r\n      );\r\n\r\n      // Build recommendation prompt\r\n      const recommendation = await this.buildRecommendation(\r\n        symbol,\r\n        tradingType,\r\n        performanceMetrics,\r\n        currentSettings\r\n      );\r\n\r\n      return recommendation;\r\n    } catch (error) {\r\n      console.error('Error getting pair recommendations:', error);\r\n      // Always return a default recommendation instead of null\r\n      return this.getDefaultRecommendations(symbol, tradingType, {\r\n        totalTrades: 0,\r\n        winRate: 0,\r\n        avgPnL: 0,\r\n        bestStrategy: undefined,\r\n        avgTradeAmount: 100,\r\n        avgLeverage: tradingType === 'futures' ? 5 : 1,\r\n        avgStopLoss: 2.0,\r\n        avgTakeProfit: 4.0\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Calculate performance metrics from historical data\r\n   */\r\n  private calculatePerformanceMetrics(\r\n    trades: any[],\r\n    bots: any[]\r\n  ): {\r\n    totalTrades: number;\r\n    winRate: number;\r\n    totalPnL: number;\r\n    avgPnL: number;\r\n    profitFactor: number;\r\n    sharpeRatio: number;\r\n    maxDrawdown: number;\r\n    bestStrategy?: any;\r\n    avgTradeAmount: number;\r\n    avgLeverage: number;\r\n    avgStopLoss: number;\r\n    avgTakeProfit: number;\r\n  } {\r\n    const closedTrades = trades.filter(t => t.status === 'filled' || t.status === 'closed' || t.status === 'completed');\r\n    const wins = closedTrades.filter(t => (t.pnl || 0) > 0);\r\n    const losses = closedTrades.filter(t => (t.pnl || 0) < 0);\r\n    const winRate = closedTrades.length > 0 ? (wins.length / closedTrades.length) * 100 : 0;\r\n    \r\n    // Calculate total PnL (sum of all trades)\r\n    const totalPnL = closedTrades.reduce((sum, t) => sum + (t.pnl || 0), 0);\r\n    \r\n    // Calculate average PnL\r\n    const avgPnL = closedTrades.length > 0 ? totalPnL / closedTrades.length : 0;\r\n\r\n    // Calculate Profit Factor (total profits / total losses)\r\n    const totalProfit = wins.reduce((sum, t) => sum + (t.pnl || 0), 0);\r\n    const totalLoss = Math.abs(losses.reduce((sum, t) => sum + (t.pnl || 0), 0));\r\n    const profitFactor = totalLoss > 0 ? totalProfit / totalLoss : (totalProfit > 0 ? 999 : 0);\r\n\r\n    // Calculate Sharpe Ratio (simplified: average return / standard deviation of returns)\r\n    const returns = closedTrades.map(t => t.pnl || 0);\r\n    const avgReturn = returns.length > 0 ? returns.reduce((sum, r) => sum + r, 0) / returns.length : 0;\r\n    const variance = returns.length > 0\r\n      ? returns.reduce((sum, r) => sum + Math.pow(r - avgReturn, 2), 0) / returns.length\r\n      : 0;\r\n    const sharpeRatio = variance > 0 ? avgReturn / Math.sqrt(variance) : 0;\r\n\r\n    // Calculate Max Drawdown (simplified: maximum consecutive loss period)\r\n    let maxDrawdown = 0;\r\n    let runningPnL = 0;\r\n    let peakPnL = 0;\r\n    for (const trade of closedTrades) {\r\n      runningPnL += (trade.pnl || 0);\r\n      if (runningPnL > peakPnL) {\r\n        peakPnL = runningPnL;\r\n      }\r\n      const drawdown = peakPnL - runningPnL;\r\n      if (drawdown > maxDrawdown) {\r\n        maxDrawdown = drawdown;\r\n      }\r\n    }\r\n    // Convert to percentage if peakPnL > 0\r\n    const maxDrawdownPercent = peakPnL > 0 ? (maxDrawdown / peakPnL) * 100 : 0;\r\n\r\n    // Find best performing bot configuration\r\n    const bestBot = bots.reduce((best, bot) => {\r\n      const currentWinRate = bot.win_rate || 0;\r\n      const bestWinRate = best?.win_rate || 0;\r\n      return currentWinRate > bestWinRate ? bot : best;\r\n    }, null);\r\n\r\n    const avgTradeAmount = bots.length > 0\r\n      ? bots.reduce((sum, b) => sum + (b.trade_amount || 100), 0) / bots.length\r\n      : 100;\r\n\r\n    const avgLeverage = bots.length > 0\r\n      ? bots.reduce((sum, b) => sum + (b.leverage || 5), 0) / bots.length\r\n      : 5;\r\n\r\n    // Default SL/TP if not available\r\n    const avgStopLoss = 2.0;\r\n    const avgTakeProfit = 4.0;\r\n\r\n    return {\r\n      totalTrades: closedTrades.length,\r\n      winRate,\r\n      totalPnL,\r\n      avgPnL,\r\n      profitFactor,\r\n      sharpeRatio,\r\n      maxDrawdown: maxDrawdownPercent,\r\n      bestStrategy: bestBot?.strategy,\r\n      avgTradeAmount,\r\n      avgLeverage,\r\n      avgStopLoss,\r\n      avgTakeProfit\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Build AI recommendation using OpenAI\r\n   */\r\n  private async buildRecommendation(\r\n    symbol: string,\r\n    tradingType: 'spot' | 'futures',\r\n    metrics: any,\r\n    currentSettings?: any\r\n  ): Promise<PairRecommendation> {\r\n    try {\r\n      // Get pair-specific recommended strategy\r\n      const pairStrategy = this.getPairSpecificStrategy(symbol);\r\n      \r\n      // Get default advanced config if not provided\r\n      const defaultAdvancedConfig: AdvancedStrategyConfig = currentSettings?.advancedConfig || this.getDefaultAdvancedConfig(symbol, tradingType);\r\n\r\n      // Use optimizeStrategy method with pair-specific baseline\r\n      const result = await openAIService.optimizeStrategy(\r\n        {\r\n          strategy: currentSettings?.strategy || pairStrategy,\r\n          advancedConfig: defaultAdvancedConfig\r\n        },\r\n        [], // No recent trades for new bot\r\n        {\r\n          ...metrics,\r\n          symbol,\r\n          tradingType,\r\n          pairCharacteristics: this.getPairCharacteristics(symbol)\r\n        }\r\n      );\r\n\r\n      // Get pair-specific basic settings\r\n      const pairBasicSettings = this.getPairBasicSettings(symbol, tradingType);\r\n\r\n      // Ensure advancedConfig is complete - merge AI result with defaults\r\n      const completeAdvancedConfig: AdvancedStrategyConfig = {\r\n        ...defaultAdvancedConfig,\r\n        ...(result.advancedConfig || {}),\r\n        // Ensure all critical parameters are set\r\n        risk_per_trade_pct: result.advancedConfig?.risk_per_trade_pct ?? defaultAdvancedConfig.risk_per_trade_pct,\r\n        adx_min_htf: result.advancedConfig?.adx_min_htf ?? defaultAdvancedConfig.adx_min_htf,\r\n        sl_atr_mult: result.advancedConfig?.sl_atr_mult ?? defaultAdvancedConfig.sl_atr_mult,\r\n        tp1_r: result.advancedConfig?.tp1_r ?? defaultAdvancedConfig.tp1_r,\r\n        tp2_r: result.advancedConfig?.tp2_r ?? defaultAdvancedConfig.tp2_r,\r\n      };\r\n\r\n      // Ensure strategy is complete - merge AI result with defaults\r\n      const completeStrategy: TradingStrategy = {\r\n        ...pairStrategy,\r\n        ...(result.strategy || {}),\r\n        // Ensure all required strategy parameters are set\r\n        rsiThreshold: result.strategy?.rsiThreshold ?? pairStrategy.rsiThreshold,\r\n        adxThreshold: result.strategy?.adxThreshold ?? pairStrategy.adxThreshold,\r\n        bbWidthThreshold: result.strategy?.bbWidthThreshold ?? pairStrategy.bbWidthThreshold,\r\n        emaSlope: result.strategy?.emaSlope ?? pairStrategy.emaSlope,\r\n        atrPercentage: result.strategy?.atrPercentage ?? pairStrategy.atrPercentage,\r\n        vwapDistance: result.strategy?.vwapDistance ?? pairStrategy.vwapDistance,\r\n        momentumThreshold: result.strategy?.momentumThreshold ?? pairStrategy.momentumThreshold,\r\n        useMLPrediction: result.strategy?.useMLPrediction ?? pairStrategy.useMLPrediction,\r\n        minSamplesForML: result.strategy?.minSamplesForML ?? pairStrategy.minSamplesForML\r\n      };\r\n\r\n      // Build recommendation from optimization result\r\n      // If no historical trades, customize the reasoning to be more helpful\r\n      const hasHistoricalData = metrics.totalTrades > 0;\r\n      const defaultReasoning = hasHistoricalData\r\n        ? `Optimized settings for ${symbol} based on ${metrics.totalTrades} historical trades (${metrics.winRate.toFixed(1)}% win rate, $${metrics.totalPnL.toFixed(2)} PnL)`\r\n        : `Recommended settings for ${symbol} based on pair characteristics. No historical trades found - these are baseline recommendations to get started.`;\r\n\r\n      return {\r\n        symbol,\r\n        recommended: true, // Always show as recommended (even with low confidence)\r\n        confidence: result.confidence || (hasHistoricalData ? 0.7 : 0.6), // Higher confidence if we have data\r\n        reasoning: result.reasoning || defaultReasoning,\r\n        strategy: completeStrategy, // Always include full strategy\r\n        advancedConfig: completeAdvancedConfig, // Always include full advanced config\r\n        expectedPerformance: result.expectedImprovement || \r\n          (hasHistoricalData \r\n            ? `Expected improved performance with optimized parameters for ${symbol}`\r\n            : `These baseline settings for ${symbol} are designed to start trading safely with pair-specific optimizations`),\r\n        riskAssessment: this.getPairRiskAssessment(symbol),\r\n        suggestedTradeAmount: pairBasicSettings.tradeAmount,\r\n        suggestedLeverage: pairBasicSettings.leverage,\r\n        suggestedStopLoss: pairBasicSettings.stopLoss,\r\n        suggestedTakeProfit: pairBasicSettings.takeProfit,\r\n        changes: this.buildChangesList(currentSettings, {\r\n          strategy: completeStrategy,\r\n          advancedConfig: completeAdvancedConfig\r\n        })\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting AI recommendation:', error);\r\n      // Return default recommendations if AI fails\r\n      return this.getDefaultRecommendations(symbol, tradingType, metrics);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get default advanced config for a pair\r\n   */\r\n  private getDefaultAdvancedConfig(symbol: string, tradingType: 'spot' | 'futures'): AdvancedStrategyConfig {\r\n    return {\r\n      // Directional Bias\r\n      bias_mode: 'auto',\r\n      htf_timeframe: '4h',\r\n      htf_trend_indicator: 'EMA200',\r\n      ema_fast_period: 50,\r\n      require_price_vs_trend: 'any',\r\n      adx_min_htf: 23,\r\n      require_adx_rising: true,\r\n      \r\n      // Regime Filter\r\n      regime_mode: 'auto',\r\n      adx_trend_min: 25,\r\n      adx_meanrev_max: 19,\r\n      \r\n      // Session/Timing\r\n      session_filter_enabled: false,\r\n      allowed_hours_utc: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],\r\n      cooldown_bars: 8,\r\n      \r\n      // Volatility/Liquidity Gates\r\n      atr_percentile_min: 20,\r\n      bb_width_min: 0.012,\r\n      bb_width_max: 0.03,\r\n      min_24h_volume_usd: 500000000,\r\n      max_spread_bps: 3,\r\n      \r\n      // Risk & Exits\r\n      risk_per_trade_pct: 0.75,\r\n      daily_loss_limit_pct: 3.0,\r\n      weekly_loss_limit_pct: 6.0,\r\n      max_trades_per_day: 8,\r\n      max_concurrent: 2,\r\n      max_consecutive_losses: 5,\r\n      sl_atr_mult: 1.3,\r\n      tp1_r: 1.0,\r\n      tp2_r: 2.0,\r\n      tp1_size: 0.5,\r\n      breakeven_at_r: 0.8,\r\n      trail_after_tp1_atr: 1.0,\r\n      time_stop_hours: 48,\r\n      \r\n      // Technical Indicators\r\n      rsi_period: 14,\r\n      rsi_oversold: 30,\r\n      rsi_overbought: 70,\r\n      atr_period: 14,\r\n      atr_tp_multiplier: 3,\r\n      \r\n      // ML/AI Settings\r\n      use_ml_prediction: true,\r\n      ml_confidence_threshold: 0.6,\r\n      ml_min_samples: 100\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get pair-specific strategy baseline\r\n   */\r\n  private getPairSpecificStrategy(symbol: string): TradingStrategy {\r\n    const pairStrategies: { [key: string]: Partial<TradingStrategy> } = {\r\n      'BTCUSDT': { rsiThreshold: 70, adxThreshold: 25, momentumThreshold: 0.8 },\r\n      'ETHUSDT': { rsiThreshold: 68, adxThreshold: 23, momentumThreshold: 0.85 },\r\n      'SOLUSDT': { rsiThreshold: 65, adxThreshold: 27, momentumThreshold: 0.9 },\r\n      'ADAUSDT': { rsiThreshold: 72, adxThreshold: 22, momentumThreshold: 0.75 },\r\n      'DOTUSDT': { rsiThreshold: 70, adxThreshold: 24, momentumThreshold: 0.8 },\r\n      'AVAXUSDT': { rsiThreshold: 65, adxThreshold: 28, momentumThreshold: 0.9 },\r\n      'BNBUSDT': { rsiThreshold: 70, adxThreshold: 25, momentumThreshold: 0.8 },\r\n      'XRPUSDT': { rsiThreshold: 72, adxThreshold: 20, momentumThreshold: 0.7 },\r\n      'MATICUSDT': { rsiThreshold: 70, adxThreshold: 24, momentumThreshold: 0.8 },\r\n      'LINKUSDT': { rsiThreshold: 68, adxThreshold: 26, momentumThreshold: 0.85 },\r\n      'UNIUSDT': { rsiThreshold: 70, adxThreshold: 25, momentumThreshold: 0.8 },\r\n      'LTCUSDT': { rsiThreshold: 72, adxThreshold: 22, momentumThreshold: 0.75 }\r\n    };\r\n\r\n    const pairStrategy = pairStrategies[symbol] || {};\r\n\r\n    return {\r\n      rsiThreshold: 70,\r\n      adxThreshold: 25,\r\n      bbWidthThreshold: 0.02,\r\n      emaSlope: 0.5,\r\n      atrPercentage: 2.5,\r\n      vwapDistance: 1.2,\r\n      momentumThreshold: 0.8,\r\n      useMLPrediction: true,\r\n      minSamplesForML: 100,\r\n      ...pairStrategy\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get pair-specific basic settings\r\n   */\r\n  private getPairBasicSettings(\r\n    symbol: string,\r\n    tradingType: 'spot' | 'futures'\r\n  ): {\r\n    tradeAmount: number;\r\n    leverage: number;\r\n    stopLoss: number;\r\n    takeProfit: number;\r\n  } {\r\n    const pairSettings: { [key: string]: { tradeAmount: number; stopLoss: number; takeProfit: number } } = {\r\n      'BTCUSDT': { tradeAmount: 100, stopLoss: 2.0, takeProfit: 4.0 },\r\n      'ETHUSDT': { tradeAmount: 100, stopLoss: 2.2, takeProfit: 4.5 },\r\n      'SOLUSDT': { tradeAmount: 75, stopLoss: 2.5, takeProfit: 5.0 },\r\n      'ADAUSDT': { tradeAmount: 100, stopLoss: 2.0, takeProfit: 4.0 },\r\n      'DOTUSDT': { tradeAmount: 100, stopLoss: 2.2, takeProfit: 4.5 },\r\n      'AVAXUSDT': { tradeAmount: 75, stopLoss: 2.5, takeProfit: 5.0 },\r\n      'BNBUSDT': { tradeAmount: 100, stopLoss: 2.0, takeProfit: 4.0 },\r\n      'XRPUSDT': { tradeAmount: 100, stopLoss: 1.8, takeProfit: 3.5 },\r\n      'MATICUSDT': { tradeAmount: 100, stopLoss: 2.2, takeProfit: 4.5 },\r\n      'LINKUSDT': { tradeAmount: 100, stopLoss: 2.2, takeProfit: 4.5 },\r\n      'UNIUSDT': { tradeAmount: 100, stopLoss: 2.0, takeProfit: 4.0 },\r\n      'LTCUSDT': { tradeAmount: 100, stopLoss: 2.0, takeProfit: 4.0 }\r\n    };\r\n\r\n    const settings = pairSettings[symbol] || { tradeAmount: 100, stopLoss: 2.0, takeProfit: 4.0 };\r\n\r\n    return {\r\n      ...settings,\r\n      leverage: tradingType === 'futures' ? 5 : 1\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get pair-specific risk assessment\r\n   */\r\n  private getPairRiskAssessment(symbol: string): 'low' | 'medium' | 'high' {\r\n    const riskMap: { [key: string]: 'low' | 'medium' | 'high' } = {\r\n      'BTCUSDT': 'medium',\r\n      'ETHUSDT': 'medium',\r\n      'SOLUSDT': 'high',\r\n      'ADAUSDT': 'medium',\r\n      'DOTUSDT': 'medium',\r\n      'AVAXUSDT': 'high',\r\n      'BNBUSDT': 'medium',\r\n      'XRPUSDT': 'medium',\r\n      'MATICUSDT': 'medium',\r\n      'LINKUSDT': 'medium',\r\n      'UNIUSDT': 'medium',\r\n      'LTCUSDT': 'low'\r\n    };\r\n\r\n    return riskMap[symbol] || 'medium';\r\n  }\r\n\r\n  /**\r\n   * Get pair characteristics based on symbol\r\n   */\r\n  private getPairCharacteristics(symbol: string): string {\r\n    const pairMap: { [key: string]: string } = {\r\n      'BTCUSDT': 'High liquidity, moderate volatility, trend-following preferred',\r\n      'ETHUSDT': 'High liquidity, moderate-high volatility, good for momentum',\r\n      'SOLUSDT': 'High volatility, strong trends, momentum strategies work well',\r\n      'ADAUSDT': 'Medium volatility, mean-reversion opportunities',\r\n      'DOTUSDT': 'Medium-high volatility, trend-following preferred',\r\n      'AVAXUSDT': 'High volatility, strong momentum, aggressive strategies',\r\n      'BNBUSDT': 'High liquidity, moderate volatility, stable trends',\r\n      'XRPUSDT': 'Medium volatility, news-sensitive, cautious approach',\r\n      'MATICUSDT': 'Medium volatility, good for both trend and mean-reversion',\r\n      'LINKUSDT': 'Medium-high volatility, momentum strategies',\r\n      'UNIUSDT': 'Medium volatility, DeFi correlation, trend-following',\r\n      'LTCUSDT': 'Medium volatility, stable trends, conservative approach'\r\n    };\r\n\r\n    return pairMap[symbol] || 'Medium volatility, standard trading approach recommended';\r\n  }\r\n\r\n  /**\r\n   * Build changes list comparing current vs recommended settings\r\n   */\r\n  private buildChangesList(\r\n    currentSettings?: any,\r\n    optimizationResult?: any\r\n  ): PairRecommendation['changes'] {\r\n    const changes: PairRecommendation['changes'] = [];\r\n\r\n    if (!optimizationResult) {\r\n      return changes;\r\n    }\r\n\r\n    // Compare strategy parameters\r\n    if (optimizationResult.strategy) {\r\n      const currentStrategy = currentSettings?.strategy || {};\r\n      Object.keys(optimizationResult.strategy).forEach(key => {\r\n        const recommendedValue = (optimizationResult.strategy as any)[key];\r\n        const currentValue = (currentStrategy as any)[key];\r\n        if (recommendedValue !== undefined && recommendedValue !== currentValue) {\r\n          changes.push({\r\n            parameter: `Strategy.${key}`,\r\n            recommendedValue,\r\n            defaultValue: currentValue,\r\n            reason: `Optimized for better performance`\r\n          });\r\n        }\r\n      });\r\n    }\r\n\r\n    // Compare advanced config parameters - check ALL important parameters\r\n    if (optimizationResult.advancedConfig) {\r\n      const currentAdvancedConfig = currentSettings?.advancedConfig || {};\r\n      const importantParams = [\r\n        // Risk Management\r\n        'risk_per_trade_pct',\r\n        'daily_loss_limit_pct',\r\n        'weekly_loss_limit_pct',\r\n        'max_trades_per_day',\r\n        'max_concurrent',\r\n        'max_consecutive_losses',\r\n        // Stop Loss / Take Profit\r\n        'sl_atr_mult',\r\n        'tp1_r',\r\n        'tp2_r',\r\n        'tp1_size',\r\n        'breakeven_at_r',\r\n        'trail_after_tp1_atr',\r\n        'time_stop_hours',\r\n        // Directional Bias\r\n        'bias_mode',\r\n        'adx_min_htf',\r\n        'htf_timeframe',\r\n        'htf_trend_indicator',\r\n        'require_adx_rising',\r\n        // Regime Filter\r\n        'regime_mode',\r\n        'adx_trend_min',\r\n        'adx_meanrev_max',\r\n        // Volatility/Liquidity\r\n        'atr_percentile_min',\r\n        'bb_width_min',\r\n        'bb_width_max',\r\n        'max_spread_bps',\r\n        // Technical Indicators\r\n        'rsi_oversold',\r\n        'rsi_overbought',\r\n        'rsi_period',\r\n        // ML/AI\r\n        'use_ml_prediction',\r\n        'ml_confidence_threshold',\r\n        'ml_min_samples'\r\n      ];\r\n\r\n      importantParams.forEach(key => {\r\n        const recommendedValue = (optimizationResult.advancedConfig as any)?.[key];\r\n        const currentValue = (currentAdvancedConfig as any)?.[key];\r\n        // Only add if value is different and recommended value is not undefined\r\n        if (recommendedValue !== undefined && recommendedValue !== currentValue) {\r\n          changes.push({\r\n            parameter: `Advanced.${key}`,\r\n            recommendedValue,\r\n            defaultValue: currentValue !== undefined ? currentValue : 'default',\r\n            reason: this.getParameterReason(key)\r\n          });\r\n        }\r\n      });\r\n    }\r\n\r\n    return changes;\r\n  }\r\n\r\n  /**\r\n   * Get reason for parameter change\r\n   */\r\n  private getParameterReason(parameter: string): string {\r\n    const reasonMap: { [key: string]: string } = {\r\n      'risk_per_trade_pct': 'Optimized risk per trade',\r\n      'adx_min_htf': 'Optimized trend strength requirement',\r\n      'sl_atr_mult': 'Optimized stop loss multiplier',\r\n      'tp1_r': 'Optimized take profit ratio',\r\n      'tp2_r': 'Optimized second take profit ratio',\r\n      'bias_mode': 'Optimized directional bias',\r\n      'regime_mode': 'Optimized market regime filter',\r\n      'max_trades_per_day': 'Optimized daily trade limit',\r\n      'max_concurrent': 'Optimized concurrent positions',\r\n      'rsi_oversold': 'Optimized RSI oversold level',\r\n      'rsi_overbought': 'Optimized RSI overbought level',\r\n      'use_ml_prediction': 'Optimized ML prediction usage',\r\n      'ml_confidence_threshold': 'Optimized ML confidence threshold'\r\n    };\r\n    return reasonMap[parameter] || 'Optimized for better performance';\r\n  }\r\n\r\n  /**\r\n   * Get default recommendations if AI fails\r\n   */\r\n  private getDefaultRecommendations(\r\n    symbol: string,\r\n    tradingType: 'spot' | 'futures',\r\n    metrics: any\r\n  ): PairRecommendation {\r\n    // Use pair-specific defaults instead of generic ones\r\n    const pairStrategy = this.getPairSpecificStrategy(symbol);\r\n    const pairBasicSettings = this.getPairBasicSettings(symbol, tradingType);\r\n    const pairRisk = this.getPairRiskAssessment(symbol);\r\n    const defaultAdvancedConfig = this.getDefaultAdvancedConfig(symbol, tradingType);\r\n\r\n    // Build changes list to show all parameters that differ from defaults\r\n    const changes = this.buildChangesList(\r\n      {\r\n        strategy: {\r\n          rsiThreshold: 70,\r\n          adxThreshold: 25,\r\n          bbWidthThreshold: 0.02,\r\n          emaSlope: 0.5,\r\n          atrPercentage: 2.5,\r\n          vwapDistance: 1.2,\r\n          momentumThreshold: 0.8,\r\n          useMLPrediction: true,\r\n          minSamplesForML: 100\r\n        },\r\n        advancedConfig: this.getDefaultAdvancedConfig(symbol, tradingType)\r\n      },\r\n      {\r\n        strategy: pairStrategy,\r\n        advancedConfig: defaultAdvancedConfig\r\n      }\r\n    );\r\n\r\n    return {\r\n      symbol,\r\n      recommended: true,\r\n      confidence: 0.7,\r\n      reasoning: `Pair-specific recommended settings for ${symbol} based on historical characteristics`,\r\n      strategy: pairStrategy,\r\n      advancedConfig: defaultAdvancedConfig, // Always include full advanced config\r\n      expectedPerformance: `Optimized settings for ${symbol} - expected improved performance`,\r\n      riskAssessment: pairRisk,\r\n      suggestedTradeAmount: pairBasicSettings.tradeAmount,\r\n      suggestedLeverage: pairBasicSettings.leverage,\r\n      suggestedStopLoss: pairBasicSettings.stopLoss,\r\n      suggestedTakeProfit: pairBasicSettings.takeProfit,\r\n      changes: changes // Show all parameter differences\r\n    };\r\n  }\r\n}\r\n\r\nexport const pairRecommendationsService = new PairRecommendationsService();\r\n\r\n","/**\r\n * Pair Recommendations Component\r\n * Displays AI-optimized settings recommendations based on selected trading pair\r\n */\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport Card from '../base/Card';\r\nimport Button from '../base/Button';\r\nimport { pairRecommendationsService, type PairRecommendation } from '../../services/pairRecommendations';\r\nimport { openAIService } from '../../services/openai';\r\nimport type { TradingStrategy, AdvancedStrategyConfig } from '../../types/trading';\r\n\r\ninterface PairRecommendationsProps {\r\n  symbol: string;\r\n  tradingType: 'spot' | 'futures';\r\n  currentStrategy?: TradingStrategy;\r\n  currentAdvancedConfig?: AdvancedStrategyConfig;\r\n  currentTradeAmount?: number;\r\n  currentLeverage?: number;\r\n  currentStopLoss?: number;\r\n  currentTakeProfit?: number;\r\n  onApplyRecommendation: (recommendation: PairRecommendation) => void;\r\n}\r\n\r\nexport default function PairRecommendations({\r\n  symbol,\r\n  tradingType,\r\n  currentStrategy,\r\n  currentAdvancedConfig,\r\n  currentTradeAmount,\r\n  currentLeverage,\r\n  currentStopLoss,\r\n  currentTakeProfit,\r\n  onApplyRecommendation\r\n}: PairRecommendationsProps) {\r\n  const [recommendation, setRecommendation] = useState<PairRecommendation | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [showDetails, setShowDetails] = useState(false);\r\n  const [hasAnyProvider, setHasAnyProvider] = useState(false);\r\n  const [aiProvider, setAiProvider] = useState<'openai' | 'deepseek'>(() => {\r\n    // Load from localStorage or default\r\n    const saved = localStorage.getItem('ai_provider_preference');\r\n    if (saved === 'openai' || saved === 'deepseek') {\r\n      return saved;\r\n    }\r\n    // Default to DeepSeek if available, otherwise OpenAI\r\n    return openAIService.isProviderAvailable('deepseek') ? 'deepseek' : 'openai';\r\n  });\r\n\r\n  const fetchRecommendations = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      // Set AI provider before fetching\r\n      openAIService.setProvider(aiProvider);\r\n      \r\n      const rec = await pairRecommendationsService.getRecommendationsForPair(\r\n        symbol,\r\n        tradingType,\r\n        {\r\n          strategy: currentStrategy,\r\n          advancedConfig: currentAdvancedConfig,\r\n          tradeAmount: currentTradeAmount,\r\n          leverage: currentLeverage,\r\n          stopLoss: currentStopLoss,\r\n          takeProfit: currentTakeProfit\r\n        }\r\n      );\r\n\r\n      if (rec) {\r\n        setRecommendation(rec);\r\n        setError(null); // Clear any previous errors\r\n      } else {\r\n        // If service returns null, it means it fell back to defaults\r\n        // Try to get default recommendations\r\n        console.warn('Recommendations service returned null, using fallback');\r\n        setError('AI recommendations unavailable, showing pair-specific defaults');\r\n        // Service should never return null, but if it does, we'll show error state\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Error fetching recommendations:', err);\r\n      setError(err.message || 'Error fetching recommendations');\r\n      // On error, still try to show something useful\r\n      // The service should handle errors internally and return defaults\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Check AI keys from Edge Function secrets on mount\r\n    const checkKeys = async () => {\r\n      console.log('üîç [PairRecommendations] Checking AI keys from Edge Function...');\r\n      try {\r\n        const status = await openAIService.checkKeysFromEdgeFunction();\r\n        console.log('‚úÖ [PairRecommendations] Keys status:', status);\r\n        \r\n        // Check availability after Edge Function check\r\n        const openai = await openAIService.isProviderAvailableAsync('openai');\r\n        const deepseek = await openAIService.isProviderAvailableAsync('deepseek');\r\n        \r\n        console.log(`üîç [PairRecommendations] Provider availability - OpenAI: ${openai}, DeepSeek: ${deepseek}`);\r\n        setHasAnyProvider(openai || deepseek);\r\n        \r\n        // Update provider selection based on availability\r\n        if (!openAIService.isProviderAvailable(aiProvider)) {\r\n          // Current provider not available, switch to available one\r\n          if (deepseek) {\r\n            setAiProvider('deepseek');\r\n            console.log('üîÑ [PairRecommendations] Switched to DeepSeek (current provider not available)');\r\n          } else if (openai) {\r\n            setAiProvider('openai');\r\n            console.log('üîÑ [PairRecommendations] Switched to OpenAI (current provider not available)');\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('‚ùå [PairRecommendations] Error checking keys:', error);\r\n      }\r\n    };\r\n    checkKeys();\r\n    \r\n    // Also refresh from localStorage (fallback)\r\n    openAIService.refreshKeys();\r\n    \r\n    // DO NOT auto-fetch - user must click \"Get AI Recommendations\" button\r\n    // Removed automatic fetching to give user control\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []); // Only run on mount\r\n\r\n  const handleProviderChange = (provider: 'openai' | 'deepseek') => {\r\n    if (!openAIService.isProviderAvailable(provider)) {\r\n      setError(`${provider === 'openai' ? 'OpenAI' : 'DeepSeek'} API key not configured. Please set it in your environment variables.`);\r\n      return;\r\n    }\r\n    setAiProvider(provider);\r\n    openAIService.setProvider(provider);\r\n    // fetchRecommendations will be called automatically by useEffect\r\n  };\r\n\r\n  const handleApply = () => {\r\n    if (recommendation) {\r\n      onApplyRecommendation(recommendation);\r\n    }\r\n  };\r\n\r\n  // Always show the component - show loading state if needed\r\n  if (loading) {\r\n    return (\r\n      <Card className=\"p-4 border-2 border-blue-200 bg-blue-50\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mr-3\"></div>\r\n            <span className=\"text-blue-700 font-medium\">ü§ñ AI ({aiProvider}) analyzing {symbol}...</span>\r\n          </div>\r\n          <div className=\"flex items-center gap-2 text-xs\">\r\n            <span className=\"text-gray-600\">Using:</span>\r\n            <select\r\n              value={aiProvider}\r\n              onChange={(e) => handleProviderChange(e.target.value as 'openai' | 'deepseek')}\r\n              className=\"px-2 py-1 border border-gray-300 rounded bg-white text-gray-700 text-xs\"\r\n              disabled={loading}\r\n            >\r\n              <option value=\"deepseek\" disabled={!openAIService.isProviderAvailable('deepseek')}>\r\n                DeepSeek {!openAIService.isProviderAvailable('deepseek') ? '(Not configured)' : ''}\r\n              </option>\r\n              <option value=\"openai\" disabled={!openAIService.isProviderAvailable('openai')}>\r\n                OpenAI {!openAIService.isProviderAvailable('openai') ? '(Not configured)' : ''}\r\n              </option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  // Show error state if there's an error and no recommendation\r\n  if (error && !recommendation) {\r\n    return (\r\n      <Card className=\"p-4 border-2 border-yellow-200 bg-yellow-50\">\r\n        <div className=\"space-y-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center\">\r\n              <i className=\"ri-information-line text-yellow-600 mr-2\"></i>\r\n              <span className=\"text-yellow-700\">‚ö†Ô∏è {error}</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <select\r\n                value={aiProvider}\r\n                onChange={(e) => handleProviderChange(e.target.value as 'openai' | 'deepseek')}\r\n                className=\"px-2 py-1 border border-gray-300 rounded bg-white text-gray-700 text-xs\"\r\n                disabled={loading}\r\n              >\r\n                <option value=\"deepseek\" disabled={!openAIService.isProviderAvailable('deepseek')}>\r\n                  DeepSeek {!openAIService.isProviderAvailable('deepseek') ? '(Not configured)' : ''}\r\n                </option>\r\n                <option value=\"openai\" disabled={!openAIService.isProviderAvailable('openai')}>\r\n                  OpenAI {!openAIService.isProviderAvailable('openai') ? '(Not configured)' : ''}\r\n                </option>\r\n              </select>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={fetchRecommendations}\r\n                className=\"text-xs\"\r\n              >\r\n                Retry\r\n              </Button>\r\n            </div>\r\n          </div>\r\n          <p className=\"text-xs text-yellow-600\">\r\n            The AI recommendation service may not be available. You can still create the bot with default settings.\r\n          </p>\r\n        </div>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  // If no recommendation but also no error/loading, show manual trigger button\r\n  if (!recommendation && !error && !loading) {\r\n    // Use state value from useEffect (checks Edge Function secrets)\r\n    const finalHasAnyProvider = hasAnyProvider || openAIService.isProviderAvailable('openai') || openAIService.isProviderAvailable('deepseek');\r\n    \r\n    return (\r\n      <Card className=\"p-4 border-2 border-gray-200 bg-gray-50\">\r\n        <div className=\"space-y-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h3 className=\"text-sm font-medium text-gray-700 mb-1\">ü§ñ AI Recommendations</h3>\r\n              <p className=\"text-xs text-gray-500\">\r\n                {hasAnyProvider \r\n                  ? `Get AI-powered recommendations for ${symbol}`\r\n                  : 'Configure AI API keys in Settings to get recommendations'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <select\r\n              value={aiProvider}\r\n              onChange={(e) => handleProviderChange(e.target.value as 'openai' | 'deepseek')}\r\n              className=\"px-2 py-1 border border-gray-300 rounded bg-white text-gray-700 text-xs\"\r\n              disabled={loading}\r\n            >\r\n              <option value=\"deepseek\" disabled={!openAIService.isProviderAvailable('deepseek')}>\r\n                DeepSeek {!openAIService.isProviderAvailable('deepseek') ? '(Not configured)' : ''}\r\n              </option>\r\n              <option value=\"openai\" disabled={!openAIService.isProviderAvailable('openai')}>\r\n                OpenAI {!openAIService.isProviderAvailable('openai') ? '(Not configured)' : ''}\r\n              </option>\r\n            </select>\r\n            <Button\r\n              variant=\"primary\"\r\n              size=\"sm\"\r\n              onClick={fetchRecommendations}\r\n              className=\"text-xs\"\r\n              disabled={loading || !hasAnyProvider}\r\n            >\r\n              <i className=\"ri-magic-line mr-1\"></i>\r\n              Get AI Recommendations\r\n            </Button>\r\n          </div>\r\n          {!hasAnyProvider && (\r\n            <p className=\"text-xs text-yellow-600\">\r\n              ‚ö†Ô∏è No AI providers configured. Go to Settings ‚Üí AI Recommendations to add your API keys.\r\n            </p>\r\n          )}\r\n        </div>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  // If still no recommendation at this point, return null (shouldn't happen)\r\n  if (!recommendation) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Card className=\"p-4 border-2 border-purple-300 bg-gradient-to-r from-purple-50 to-blue-50\">\r\n      <div className=\"space-y-3\">\r\n        {/* Header */}\r\n        <div className=\"flex items-start justify-between\">\r\n          <div className=\"flex-1\">\r\n            <div className=\"flex items-center mb-2 flex-wrap gap-2\">\r\n              <i className=\"ri-magic-line text-purple-600 text-xl mr-2\"></i>\r\n              <h3 className=\"text-lg font-bold text-gray-900\">\r\n                ü§ñ AI Recommendations for {symbol}\r\n              </h3>\r\n              <span className={`ml-2 px-2 py-1 rounded text-xs font-semibold ${\r\n                recommendation.confidence >= 0.8 ? 'bg-green-100 text-green-800' :\r\n                recommendation.confidence >= 0.6 ? 'bg-yellow-100 text-yellow-800' :\r\n                'bg-gray-100 text-gray-800'\r\n              }`}>\r\n                {Math.round(recommendation.confidence * 100)}% Confidence\r\n              </span>\r\n              <div className=\"flex items-center gap-2 ml-auto\">\r\n                <span className=\"text-xs text-gray-500\">AI Provider:</span>\r\n                <select\r\n                  value={aiProvider}\r\n                  onChange={(e) => handleProviderChange(e.target.value as 'openai' | 'deepseek')}\r\n                  className=\"px-2 py-1 border border-gray-300 rounded bg-white text-gray-700 text-xs font-medium\"\r\n                  disabled={loading}\r\n                >\r\n                  <option value=\"deepseek\" disabled={!openAIService.isProviderAvailable('deepseek')}>\r\n                    DeepSeek {!openAIService.isProviderAvailable('deepseek') ? '(Not configured)' : ''}\r\n                  </option>\r\n                  <option value=\"openai\" disabled={!openAIService.isProviderAvailable('openai')}>\r\n                    OpenAI {!openAIService.isProviderAvailable('openai') ? '(Not configured)' : ''}\r\n                  </option>\r\n                </select>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={fetchRecommendations}\r\n                  className=\"text-xs\"\r\n                  title=\"Refresh recommendations with current AI provider\"\r\n                >\r\n                  <i className=\"ri-refresh-line mr-1\"></i>\r\n                  Refresh\r\n                </Button>\r\n              </div>\r\n            </div>\r\n            <p className=\"text-sm text-gray-700 mb-2\">\r\n              {recommendation.reasoning}\r\n            </p>\r\n            <div className=\"flex items-center gap-4 text-xs text-gray-600\">\r\n              <span className=\"flex items-center\">\r\n                <i className=\"ri-line-chart-line mr-1\"></i>\r\n                {recommendation.expectedPerformance}\r\n              </span>\r\n              <span className=\"flex items-center\">\r\n                <i className=\"ri-shield-line mr-1\"></i>\r\n                Risk: <span className=\"font-semibold capitalize ml-1\">{recommendation.riskAssessment}</span>\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Quick Stats */}\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 mt-4\">\r\n          <div className=\"bg-white rounded-lg p-3 border border-gray-200\">\r\n            <div className=\"text-xs text-gray-500 mb-1\">Trade Amount</div>\r\n            <div className=\"text-sm font-bold text-gray-900\">${recommendation.suggestedTradeAmount}</div>\r\n            {currentTradeAmount && currentTradeAmount !== recommendation.suggestedTradeAmount && (\r\n              <div className=\"text-xs text-gray-400 line-through\">${currentTradeAmount}</div>\r\n            )}\r\n          </div>\r\n          {tradingType === 'futures' && (\r\n            <div className=\"bg-white rounded-lg p-3 border border-gray-200\">\r\n              <div className=\"text-xs text-gray-500 mb-1\">Leverage</div>\r\n              <div className=\"text-sm font-bold text-gray-900\">{recommendation.suggestedLeverage}x</div>\r\n              {currentLeverage && currentLeverage !== recommendation.suggestedLeverage && (\r\n                <div className=\"text-xs text-gray-400 line-through\">{currentLeverage}x</div>\r\n              )}\r\n            </div>\r\n          )}\r\n          <div className=\"bg-white rounded-lg p-3 border border-gray-200\">\r\n            <div className=\"text-xs text-gray-500 mb-1\">Stop Loss</div>\r\n            <div className=\"text-sm font-bold text-gray-900\">{recommendation.suggestedStopLoss}%</div>\r\n            {currentStopLoss && currentStopLoss !== recommendation.suggestedStopLoss && (\r\n              <div className=\"text-xs text-gray-400 line-through\">{currentStopLoss}%</div>\r\n            )}\r\n          </div>\r\n          <div className=\"bg-white rounded-lg p-3 border border-gray-200\">\r\n            <div className=\"text-xs text-gray-500 mb-1\">Take Profit</div>\r\n            <div className=\"text-sm font-bold text-gray-900\">{recommendation.suggestedTakeProfit}%</div>\r\n            {currentTakeProfit && currentTakeProfit !== recommendation.suggestedTakeProfit && (\r\n              <div className=\"text-xs text-gray-400 line-through\">{currentTakeProfit}%</div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Strategy & Advanced Config Changes - Always show */}\r\n        <div className=\"mt-4\">\r\n          <button\r\n            onClick={() => setShowDetails(!showDetails)}\r\n            className=\"text-sm text-purple-600 hover:text-purple-800 font-medium flex items-center\"\r\n          >\r\n            <i className={`ri-arrow-${showDetails ? 'up' : 'down'}-s-line mr-1`}></i>\r\n            {recommendation.changes.length > 0 ? (\r\n              <>\r\n                {recommendation.changes.length} Optimization{recommendation.changes.length !== 1 ? 's' : ''} Recommended\r\n                <span className=\"ml-2 text-xs text-gray-500\">\r\n                  ({recommendation.changes.filter(c => c.parameter.startsWith('Strategy.')).length} Strategy, {recommendation.changes.filter(c => c.parameter.startsWith('Advanced.')).length} Advanced)\r\n                </span>\r\n              </>\r\n            ) : (\r\n              <>\r\n                View All Recommended Parameters\r\n                <span className=\"ml-2 text-xs text-gray-500\">\r\n                  (Strategy + Advanced Config)\r\n                </span>\r\n              </>\r\n            )}\r\n          </button>\r\n\r\n          {showDetails && (\r\n            <div className=\"mt-2 bg-white rounded-lg p-3 border border-gray-200\">\r\n              <div className=\"space-y-3\">\r\n                {/* Strategy Parameters - Always show */}\r\n                <div>\r\n                  <h4 className=\"text-xs font-semibold text-gray-700 mb-2 flex items-center\">\r\n                    <i className=\"ri-settings-3-line mr-1\"></i>\r\n                    Strategy Parameters\r\n                  </h4>\r\n                  <div className=\"space-y-1 max-h-48 overflow-y-auto\">\r\n                    {recommendation.strategy && (\r\n                      <>\r\n                        <div className=\"flex items-center justify-between text-xs py-1 px-2 bg-blue-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">RSI Threshold:</span>\r\n                          <span className=\"text-green-600 font-semibold\">{recommendation.strategy.rsiThreshold}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between text-xs py-1 px-2 bg-blue-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">ADX Threshold:</span>\r\n                          <span className=\"text-green-600 font-semibold\">{recommendation.strategy.adxThreshold}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between text-xs py-1 px-2 bg-blue-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">BB Width Threshold:</span>\r\n                          <span className=\"text-green-600 font-semibold\">{recommendation.strategy.bbWidthThreshold}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between text-xs py-1 px-2 bg-blue-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">EMA Slope:</span>\r\n                          <span className=\"text-green-600 font-semibold\">{recommendation.strategy.emaSlope}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between text-xs py-1 px-2 bg-blue-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">ATR Percentage:</span>\r\n                          <span className=\"text-green-600 font-semibold\">{recommendation.strategy.atrPercentage}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between text-xs py-1 px-2 bg-blue-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">Momentum Threshold:</span>\r\n                          <span className=\"text-green-600 font-semibold\">{recommendation.strategy.momentumThreshold}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between text-xs py-1 px-2 bg-blue-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">Use ML Prediction:</span>\r\n                          <span className=\"text-green-600 font-semibold\">{recommendation.strategy.useMLPrediction ? 'Yes' : 'No'}</span>\r\n                        </div>\r\n                      </>\r\n                    )}\r\n                    {/* Show changes if any */}\r\n                    {recommendation.changes\r\n                      .filter(c => c.parameter.startsWith('Strategy.'))\r\n                      .map((change, idx) => (\r\n                        <div key={`change-${idx}`} className=\"flex items-center justify-between text-xs py-1 px-2 bg-yellow-50 rounded border border-yellow-200\">\r\n                          <div className=\"flex-1\">\r\n                            <span className=\"font-medium text-gray-700\">{change.parameter.replace('Strategy.', '')}:</span>\r\n                            <span className=\"ml-2 text-gray-500 line-through\">{String(change.defaultValue)}</span>\r\n                            <span className=\"mx-2 text-gray-400\">‚Üí</span>\r\n                            <span className=\"text-green-600 font-semibold\">{String(change.recommendedValue)}</span>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Advanced Config Parameters - Always show */}\r\n                {recommendation.advancedConfig && (\r\n                  <div>\r\n                    <h4 className=\"text-xs font-semibold text-gray-700 mb-2 flex items-center\">\r\n                      <i className=\"ri-settings-4-line mr-1\"></i>\r\n                      ‚öôÔ∏è Advanced Strategy Configuration\r\n                    </h4>\r\n                    <div className=\"space-y-1 max-h-64 overflow-y-auto\">\r\n                      {/* Show key advanced config parameters */}\r\n                      <div className=\"grid grid-cols-2 gap-1 text-xs\">\r\n                        <div className=\"py-1 px-2 bg-purple-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">Risk/Trade:</span>\r\n                          <span className=\"ml-1 text-green-600 font-semibold\">{recommendation.advancedConfig.risk_per_trade_pct}%</span>\r\n                        </div>\r\n                        <div className=\"py-1 px-2 bg-purple-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">Max Trades/Day:</span>\r\n                          <span className=\"ml-1 text-green-600 font-semibold\">{recommendation.advancedConfig.max_trades_per_day}</span>\r\n                        </div>\r\n                        <div className=\"py-1 px-2 bg-purple-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">SL ATR Mult:</span>\r\n                          <span className=\"ml-1 text-green-600 font-semibold\">{recommendation.advancedConfig.sl_atr_mult}</span>\r\n                        </div>\r\n                        <div className=\"py-1 px-2 bg-purple-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">TP1 Ratio:</span>\r\n                          <span className=\"ml-1 text-green-600 font-semibold\">{recommendation.advancedConfig.tp1_r}</span>\r\n                        </div>\r\n                        <div className=\"py-1 px-2 bg-purple-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">TP2 Ratio:</span>\r\n                          <span className=\"ml-1 text-green-600 font-semibold\">{recommendation.advancedConfig.tp2_r}</span>\r\n                        </div>\r\n                        <div className=\"py-1 px-2 bg-purple-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">ADX Min HTF:</span>\r\n                          <span className=\"ml-1 text-green-600 font-semibold\">{recommendation.advancedConfig.adx_min_htf}</span>\r\n                        </div>\r\n                        <div className=\"py-1 px-2 bg-purple-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">Bias Mode:</span>\r\n                          <span className=\"ml-1 text-green-600 font-semibold\">{recommendation.advancedConfig.bias_mode}</span>\r\n                        </div>\r\n                        <div className=\"py-1 px-2 bg-purple-50 rounded\">\r\n                          <span className=\"font-medium text-gray-700\">Regime Mode:</span>\r\n                          <span className=\"ml-1 text-green-600 font-semibold\">{recommendation.advancedConfig.regime_mode}</span>\r\n                        </div>\r\n                      </div>\r\n                      {/* Show changes if any */}\r\n                      {recommendation.changes\r\n                        .filter(c => c.parameter.startsWith('Advanced.'))\r\n                        .map((change, idx) => (\r\n                          <div key={`adv-change-${idx}`} className=\"flex items-center justify-between text-xs py-1 px-2 bg-yellow-50 rounded border border-yellow-200\">\r\n                            <div className=\"flex-1\">\r\n                              <span className=\"font-medium text-gray-700\">{change.parameter.replace('Advanced.', '')}:</span>\r\n                              <span className=\"ml-2 text-gray-500 line-through\">{String(change.defaultValue)}</span>\r\n                              <span className=\"mx-2 text-gray-400\">‚Üí</span>\r\n                              <span className=\"text-green-600 font-semibold\">{String(change.recommendedValue)}</span>\r\n                              <span className=\"ml-2 text-xs text-gray-400\">({change.reason})</span>\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      <p className=\"text-xs text-gray-500 mt-2 italic\">\r\n                        All 30+ Advanced Config parameters are configured and will be applied.\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n\r\n        {/* Action Buttons */}\r\n        <div className=\"flex items-center gap-2 mt-4 pt-4 border-t border-purple-200\">\r\n          <Button\r\n            onClick={handleApply}\r\n            className=\"flex-1 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-semibold\"\r\n          >\r\n            <i className=\"ri-check-line mr-2\"></i>\r\n            Apply AI Recommendations\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            onClick={fetchRecommendations}\r\n            className=\"px-3\"\r\n            title=\"Refresh recommendations\"\r\n          >\r\n            <i className=\"ri-refresh-line\"></i>\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </Card>\r\n  );\r\n}\r\n\r\n","\n\nimport { useState, useEffect } from 'react';\nimport { useNavigate, useSearchParams, useLocation } from 'react-router-dom';\nimport Button from '../../components/base/Button';\nimport Card from '../../components/base/Card';\nimport Header from '../../components/feature/Header';\nimport type { TradingStrategy, AdvancedStrategyConfig } from '../../types/trading';\nimport { useBots } from '../../hooks/useBots';\nimport { supabase } from '../../lib/supabase';\nimport PairRecommendations from '../../components/bot/PairRecommendations';\nimport type { PairRecommendation } from '../../services/pairRecommendations';\nimport { STRATEGY_PRESETS, type StrategyPreset } from '../../constants/strategyPresets';\nimport {\n  HTF_TIMEFRAME_OPTIONS,\n  HTF_TREND_INDICATOR_OPTIONS\n} from '../../constants/strategyOptions';\n\nexport default function CreateBotPage() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [searchParams] = useSearchParams();\n  const { createBot } = useBots();\n  \n  // Check if coming from backtest\n  const backtestData = location.state as any;\n  const isFromBacktest = backtestData?.fromBacktest === true;\n  \n  // Check if coming from Pablo Ready template\n  const isFromPabloReady = searchParams.get('template') === 'pablo-ready';\n  const pabloReadyBotId = searchParams.get('botId');\n  \n  // Get initial values from URL params (for navigation from Futures Pairs Finder or Pablo Ready)\n  const urlSymbol = searchParams.get('symbol') || 'BTCUSDT';\n  const urlExchange = (searchParams.get('exchange') || 'bybit') as 'bybit' | 'okx';\n  const urlTradingType = (searchParams.get('tradingType') || 'spot') as 'spot' | 'futures';\n  const urlLeverage = searchParams.get('leverage') ? parseInt(searchParams.get('leverage')!) : 5;\n  const urlRiskLevel = (searchParams.get('riskLevel') || 'medium') as 'low' | 'medium' | 'high';\n  const urlTradeAmount = searchParams.get('tradeAmount') ? parseFloat(searchParams.get('tradeAmount')!) : 100;\n  const urlStopLoss = searchParams.get('stopLoss') ? parseFloat(searchParams.get('stopLoss')!) : 2.0;\n  const urlTakeProfit = searchParams.get('takeProfit') ? parseFloat(searchParams.get('takeProfit')!) : 4.0;\n  const urlTimeframe = (searchParams.get('timeframe') || '1h') as '1m' | '5m' | '15m' | '1h' | '2h' | '3h' | '4h' | '1d' | '1w';\n  const urlStrategy = searchParams.get('strategy');\n  const urlStrategyConfig = searchParams.get('strategyConfig');\n  \n  const [formData, setFormData] = useState({\n    name: isFromBacktest && backtestData?.botName ? backtestData.botName : (isFromPabloReady && searchParams.get('name') ? searchParams.get('name')! : ''),\n    exchange: isFromBacktest && backtestData?.backtestConfig?.exchange ? backtestData.backtestConfig.exchange : urlExchange,\n    tradingType: isFromBacktest && backtestData?.backtestConfig?.tradingType ? backtestData.backtestConfig.tradingType : urlTradingType,\n    symbol: isFromBacktest && backtestData?.backtestConfig?.symbols?.[0] ? backtestData.backtestConfig.symbols[0] : urlSymbol,\n    timeframe: isFromBacktest && backtestData?.backtestConfig?.timeframe ? backtestData.backtestConfig.timeframe : urlTimeframe,\n    leverage: isFromBacktest && backtestData?.backtestConfig?.leverage ? backtestData.backtestConfig.leverage : urlLeverage,\n    riskLevel: isFromBacktest && backtestData?.backtestConfig?.riskLevel ? backtestData.backtestConfig.riskLevel : urlRiskLevel,\n    tradeAmount: isFromBacktest && backtestData?.backtestConfig?.tradeAmount ? backtestData.backtestConfig.tradeAmount : urlTradeAmount,\n    stopLoss: isFromBacktest && backtestData?.backtestConfig?.stopLoss ? backtestData.backtestConfig.stopLoss : urlStopLoss,\n    takeProfit: isFromBacktest && backtestData?.backtestConfig?.takeProfit ? backtestData.backtestConfig.takeProfit : urlTakeProfit,\n    paperTrading: false // Paper trading mode toggle\n  });\n\n  // Update form data when URL params change\n  useEffect(() => {\n    if (urlSymbol) {\n      setFormData(prev => ({\n        ...prev,\n        symbol: urlSymbol,\n        exchange: urlExchange,\n        tradingType: urlTradingType,\n        timeframe: urlTimeframe,\n        leverage: urlLeverage,\n        riskLevel: urlRiskLevel,\n        tradeAmount: urlTradeAmount,\n        stopLoss: urlStopLoss,\n        takeProfit: urlTakeProfit\n      }));\n    }\n  }, [urlSymbol, urlExchange, urlTradingType, urlTimeframe, urlLeverage, urlRiskLevel, urlTradeAmount, urlStopLoss, urlTakeProfit]);\n\n  const [customSymbol, setCustomSymbol] = useState<string>('');\n  const [customSymbolError, setCustomSymbolError] = useState<string>('');\n  const [useMultiplePairs, setUseMultiplePairs] = useState<boolean>(false);\n  const [customPairs, setCustomPairs] = useState<string>('');\n\n  // Load Pablo Ready bot data if template is provided\n  useEffect(() => {\n    if (isFromPabloReady && pabloReadyBotId) {\n      const loadPabloReadyBot = async () => {\n        try {\n          const { data, error } = await supabase\n            .from('pablo_ready_bots')\n            .select('*')\n            .eq('id', pabloReadyBotId)\n            .eq('enabled', true)\n            .single();\n\n          if (error) throw error;\n\n          if (data) {\n            // Parse strategy and config from URL params or database\n            let parsedStrategy = data.strategy || {};\n            let parsedConfig = data.strategy_config || {};\n\n            if (urlStrategy) {\n              try {\n                parsedStrategy = JSON.parse(urlStrategy);\n              } catch (e) {\n                console.warn('Failed to parse strategy from URL');\n              }\n            }\n\n            if (urlStrategyConfig) {\n              try {\n                parsedConfig = JSON.parse(urlStrategyConfig);\n              } catch (e) {\n                console.warn('Failed to parse strategy config from URL');\n              }\n            }\n\n            setFormData(prev => ({\n              ...prev,\n              name: searchParams.get('name') || data.name || prev.name,\n              exchange: (searchParams.get('exchange') || data.exchange || prev.exchange) as 'bybit' | 'okx',\n              tradingType: (searchParams.get('tradingType') || data.trading_type || prev.tradingType) as 'spot' | 'futures',\n              symbol: searchParams.get('symbol') || data.symbol || prev.symbol,\n              timeframe: (searchParams.get('timeframe') || data.timeframe || prev.timeframe) as any,\n              leverage: searchParams.get('leverage') ? parseInt(searchParams.get('leverage')!) : (data.leverage || prev.leverage),\n              riskLevel: (searchParams.get('riskLevel') || data.risk_level || prev.riskLevel) as 'low' | 'medium' | 'high',\n              tradeAmount: searchParams.get('tradeAmount') ? parseFloat(searchParams.get('tradeAmount')!) : (data.trade_amount || prev.tradeAmount),\n              stopLoss: searchParams.get('stopLoss') ? parseFloat(searchParams.get('stopLoss')!) : (data.stop_loss || prev.stopLoss),\n              takeProfit: searchParams.get('takeProfit') ? parseFloat(searchParams.get('takeProfit')!) : (data.take_profit || prev.takeProfit),\n            }));\n\n            // Set strategy and config - merge with defaults to ensure all required fields are present\n            if (parsedStrategy && Object.keys(parsedStrategy).length > 0) {\n              setStrategy(parsedStrategy as TradingStrategy);\n            }\n            if (parsedConfig && Object.keys(parsedConfig).length > 0) {\n              // Merge with default config to ensure all required fields are present\n              const defaultConfig: AdvancedStrategyConfig = {\n                bias_mode: 'auto',\n                htf_timeframe: '4h',\n                htf_trend_indicator: 'EMA200',\n                ema_fast_period: 50,\n                require_price_vs_trend: 'any',\n                adx_min_htf: 23,\n                require_adx_rising: true,\n                regime_mode: 'auto',\n                adx_trend_min: 25,\n                adx_meanrev_max: 19,\n                session_filter_enabled: false,\n                allowed_hours_utc: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],\n                cooldown_bars: 8,\n                atr_percentile_min: 20,\n                bb_width_min: 0.012,\n                bb_width_max: 0.03,\n                min_24h_volume_usd: 500000000,\n                max_spread_bps: 3,\n                risk_per_trade_pct: 0.75,\n                daily_loss_limit_pct: 3.0,\n                weekly_loss_limit_pct: 6.0,\n                max_trades_per_day: 8,\n                max_concurrent: 2,\n                max_consecutive_losses: 5,\n                sl_atr_mult: 1.3,\n                tp1_r: 1.0,\n                tp2_r: 2.0,\n                tp1_size: 0.5,\n                breakeven_at_r: 0.8,\n                trail_after_tp1_atr: 1.0,\n                time_stop_hours: 48,\n                rsi_period: 14,\n                rsi_oversold: 30,\n                rsi_overbought: 70,\n                atr_period: 14,\n                atr_tp_multiplier: 3,\n                use_ml_prediction: true,\n                ml_confidence_threshold: 0.6,\n                ml_min_samples: 100\n              };\n              setAdvancedConfig({ ...defaultConfig, ...parsedConfig } as AdvancedStrategyConfig);\n            }\n          }\n        } catch (error: any) {\n          console.error('Failed to load Pablo Ready bot:', error);\n        }\n      };\n\n      loadPabloReadyBot();\n    }\n  }, [isFromPabloReady, pabloReadyBotId]);\n\n  const [strategy, setStrategy] = useState<TradingStrategy>(\n    isFromBacktest && backtestData?.backtestStrategy\n      ? backtestData.backtestStrategy\n      : {\n          rsiThreshold: 70,\n          adxThreshold: 25,\n          bbWidthThreshold: 0.02,\n          emaSlope: 0.5,\n          atrPercentage: 2.5,\n          vwapDistance: 1.2,\n          momentumThreshold: 0.8,\n          useMLPrediction: true,\n          minSamplesForML: 100\n        }\n  );\n\n  const [advancedConfig, setAdvancedConfig] = useState<AdvancedStrategyConfig>(\n    isFromBacktest && backtestData?.backtestAdvancedConfig\n      ? backtestData.backtestAdvancedConfig\n      : {\n          // Directional Bias\n          bias_mode: 'auto',\n          htf_timeframe: '4h',\n          htf_trend_indicator: 'EMA200',\n          ema_fast_period: 50,\n          require_price_vs_trend: 'any',\n          adx_min_htf: 23,\n          require_adx_rising: true,\n          \n          // Regime Filter\n          regime_mode: 'auto',\n          adx_trend_min: 25,\n          adx_meanrev_max: 19,\n          \n          // Session/Timing\n          session_filter_enabled: false,\n          allowed_hours_utc: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],\n          cooldown_bars: 8,\n          \n          // Volatility/Liquidity Gates\n          atr_percentile_min: 20,\n          bb_width_min: 0.012,\n          bb_width_max: 0.03,\n          min_24h_volume_usd: 500000000,\n          max_spread_bps: 3,\n          \n          // Risk & Exits\n          risk_per_trade_pct: 0.75,\n          daily_loss_limit_pct: 3.0,\n          weekly_loss_limit_pct: 6.0,\n          max_trades_per_day: 8,\n          max_concurrent: 2,\n          max_consecutive_losses: 5, // Safety: auto-pause after 5 consecutive losses\n          sl_atr_mult: 1.3,\n          tp1_r: 1.0,\n          tp2_r: 2.0,\n          tp1_size: 0.5,\n          breakeven_at_r: 0.8,\n          trail_after_tp1_atr: 1.0,\n          time_stop_hours: 48,\n          \n          // Technical Indicators\n          rsi_period: 14,\n          rsi_oversold: 30,\n          rsi_overbought: 70,\n          atr_period: 14,\n          atr_tp_multiplier: 3,\n          \n          // ML/AI Settings\n          use_ml_prediction: true,\n          ml_confidence_threshold: 0.6,\n          ml_min_samples: 100\n        }\n  );\n  \n  // Handle multiple pairs from backtest\n  useEffect(() => {\n    if (isFromBacktest && backtestData?.backtestConfig?.symbols) {\n      const symbols = backtestData.backtestConfig.symbols;\n      if (symbols.length > 1) {\n        setUseMultiplePairs(true);\n        setCustomPairs(symbols.join(', '));\n      }\n    }\n  }, [isFromBacktest, backtestData]);\n\n  const [showAdvanced, setShowAdvanced] = useState(false);\n  const [isCreating, setIsCreating] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const popularSymbols = [\n    'BTCUSDT', 'ETHUSDT', 'SOLUSDT', 'ADAUSDT', 'DOTUSDT', 'AVAXUSDT',\n    'BNBUSDT', 'XRPUSDT', 'MATICUSDT', 'LINKUSDT', 'UNIUSDT', 'LTCUSDT'\n  ];\n\n  // Exchange balance validation removed - will be handled by real API integration\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsCreating(true);\n    setError(null);\n    \n    try {\n      // Handle multiple pairs or single pair\n      let finalSymbol = formData.symbol;\n      let symbols: string[] = [];\n      let customPairsInput = '';\n      \n      if (useMultiplePairs) {\n        // Multiple pairs mode\n        if (!customPairs.trim()) {\n          setError('Please enter at least one trading pair');\n          setIsCreating(false);\n          return;\n        }\n        \n        // Parse pairs (comma or newline separated)\n        const parsedPairs = customPairs\n          .split(/[\\n,]/)\n          .map(pair => pair.trim().toUpperCase())\n          .filter(pair => pair.length > 0);\n        \n        if (parsedPairs.length === 0) {\n          setError('Please enter at least one valid trading pair');\n          setIsCreating(false);\n          return;\n        }\n        \n        // Validate each pair\n        const invalidPairs = parsedPairs.filter(pair => !/^[A-Z0-9]{2,20}USDT$/.test(pair));\n        if (invalidPairs.length > 0) {\n          setError(`Invalid pair format: ${invalidPairs.join(', ')}. Must be uppercase and end with USDT`);\n          setIsCreating(false);\n          return;\n        }\n        \n        symbols = parsedPairs;\n        finalSymbol = parsedPairs[0]; // Use first pair as primary symbol\n        customPairsInput = customPairs.trim();\n      } else {\n        // Single pair mode (existing logic)\n        if (customSymbol.trim()) {\n          const raw = customSymbol.trim().toUpperCase();\n          const isValid = /^[A-Z0-9]{2,20}USDT$/.test(raw);\n          if (!isValid) {\n            setCustomSymbolError('Symbol must be uppercase and end with USDT (e.g., DOGEUSDT)');\n            setIsCreating(false);\n            return;\n          }\n          setCustomSymbolError('');\n          finalSymbol = raw;\n        }\n        symbols = [finalSymbol];\n      }\n      \n      // Debug: Log the form data being sent\n      const botData = {\n        name: formData.name,\n        exchange: formData.exchange,\n        tradingType: formData.tradingType,\n        symbol: finalSymbol,\n        symbols: symbols.length > 1 ? symbols : undefined, // Only include if multiple pairs\n        customPairs: customPairsInput || undefined,\n        timeframe: formData.timeframe,\n        leverage: formData.leverage,\n        riskLevel: formData.riskLevel,\n        tradeAmount: formData.tradeAmount,\n        stopLoss: formData.stopLoss,\n        takeProfit: formData.takeProfit,\n        paperTrading: formData.paperTrading,\n        strategy: strategy,\n        strategyConfig: advancedConfig,  // Include advanced configuration\n        // Initialize with default values\n        status: 'stopped' as const,\n        pnl: 0,\n        pnlPercentage: 0,\n        totalTrades: 0,\n        winRate: 0,\n        lastTradeAt: undefined\n      };\n      \n      console.log('Frontend: Sending bot data:', botData);\n      console.log('Frontend: Exchange value:', formData.exchange, 'Type:', typeof formData.exchange);\n      \n      // Create bot using the hook\n      await createBot(botData);\n      \n      // Navigate back to bots page with success message\n      navigate('/bots', { state: { message: `Bot \"${formData.name}\" created successfully!` } });\n    } catch (error: any) {\n      setError(error.message || 'Failed to create bot');\n    } finally {\n      setIsCreating(false);\n    }\n  };\n\n  const handleInputChange = (field: string, value: any) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const handleStrategyChange = (field: keyof TradingStrategy, value: any) => {\n    setStrategy(prev => ({ ...prev, [field]: value }));\n  };\n\n  const applyStrategyPreset = (preset: StrategyPreset) => {\n    setStrategy({ ...preset.strategy });\n    setAdvancedConfig(prev => ({\n      ...prev,\n      ...preset.advanced,\n      allowed_hours_utc: [...preset.advanced.allowed_hours_utc]\n    }));\n    setShowAdvanced(true);\n    setFormData(prev => ({\n      ...prev,\n      tradeAmount: preset.recommendedTradeAmount ?? prev.tradeAmount,\n      stopLoss: preset.recommendedStopLoss ?? prev.stopLoss,\n      takeProfit: preset.recommendedTakeProfit ?? prev.takeProfit,\n      riskLevel: preset.recommendedRiskLevel ?? prev.riskLevel\n    }));\n    console.log('Applied strategy preset:', preset.key);\n  };\n\n  const handleApplyRecommendation = (recommendation: PairRecommendation) => {\n    // Apply recommended strategy parameters\n    if (recommendation.strategy) {\n      setStrategy(recommendation.strategy);\n      console.log('‚úÖ Applied Strategy Parameters:', recommendation.strategy);\n    }\n\n    // Apply recommended advanced config - ensure ALL parameters are applied\n    if (recommendation.advancedConfig) {\n      setAdvancedConfig(prev => {\n        // Deep merge to ensure all advanced config parameters are included\n        const merged: AdvancedStrategyConfig = {\n          ...prev,\n          ...recommendation.advancedConfig,\n          // Ensure nested arrays are properly merged\n          allowed_hours_utc: recommendation.advancedConfig!.allowed_hours_utc || prev.allowed_hours_utc\n        };\n        console.log('‚úÖ Applied Advanced Strategy Config:', merged);\n        return merged;\n      });\n    }\n\n    // Apply recommended basic settings\n    setFormData(prev => ({\n      ...prev,\n      tradeAmount: recommendation.suggestedTradeAmount,\n      leverage: recommendation.suggestedLeverage,\n      stopLoss: recommendation.suggestedStopLoss,\n      takeProfit: recommendation.suggestedTakeProfit,\n      riskLevel: recommendation.riskAssessment as 'low' | 'medium' | 'high'\n    }));\n\n    // Count strategy and advanced config changes separately\n    const strategyChanges = recommendation.changes.filter(c => c.parameter.startsWith('Strategy.')).length;\n    const advancedChanges = recommendation.changes.filter(c => c.parameter.startsWith('Advanced.')).length;\n    const totalChanges = recommendation.changes.length;\n\n    // Show detailed success message\n    const message = `‚úÖ AI Recommendations Applied!\n\nüìä Summary:\n‚Ä¢ Strategy Parameters: ${strategyChanges} optimized\n‚Ä¢ Advanced Config: ${advancedChanges} optimized\n‚Ä¢ Basic Settings: Updated\n‚Ä¢ Total Changes: ${totalChanges} parameters\n\nAll settings have been applied to your bot configuration.`;\n    \n    alert(message);\n    \n    console.log('üìã All Applied Changes:', recommendation.changes);\n  };\n\n  // Get the effective symbol (dropdown or custom)\n  const effectiveSymbol = useMultiplePairs \n    ? (customPairs.trim() ? customPairs.split(/[\\n,]/).map(p => p.trim().toUpperCase()).filter(p => p.length > 0)[0] : formData.symbol)\n    : (customSymbol.trim() ? customSymbol.trim().toUpperCase() : formData.symbol);\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Header title=\"Create New Bot\" />\n      \n      <div className=\"pt-16 pb-6 px-4\">\n        <div className=\"max-w-2xl mx-auto\">\n          <div className=\"flex items-center mb-6\">\n            <button\n              onClick={() => navigate('/bots')}\n              className=\"mr-3 p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n            >\n              <i className=\"ri-arrow-left-line text-xl\"></i>\n            </button>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Create New Bot</h1>\n          </div>\n\n          {error && (\n            <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg\">\n              <div className=\"flex items-center\">\n                <i className=\"ri-error-warning-line text-red-500 mr-2\"></i>\n                <span className=\"text-red-700\">{error}</span>\n              </div>\n            </div>\n          )}\n\n          {/* Notification when coming from backtest */}\n          {isFromBacktest && backtestData && (\n            <Card className=\"p-4 mb-6 bg-green-50 border-2 border-green-300\">\n              <div className=\"flex items-start\">\n                <div className=\"flex-shrink-0\">\n                  <i className=\"ri-checkbox-circle-line text-2xl text-green-600\"></i>\n                </div>\n                <div className=\"ml-3 flex-1\">\n                  <h3 className=\"text-sm font-semibold text-green-900 mb-1\">\n                    ‚úÖ Form Pre-filled from Backtest\n                  </h3>\n                  <p className=\"text-sm text-green-700 mb-2\">\n                    Your bot settings have been automatically filled from the backtest results. Review and adjust as needed, then click \"Create Bot\" to create your trading bot.\n                  </p>\n                  {backtestData?.backtestResults && (\n                    <div className=\"text-xs text-green-600 mt-2\">\n                      <span className=\"font-semibold\">Backtest Performance:</span> {backtestData.backtestResults.win_rate?.toFixed(1) || 0}% win rate, \n                      ${(backtestData.backtestResults.net_profit || backtestData.backtestResults.total_pnl || 0).toFixed(2)} net profit\n                    </div>\n                  )}\n                </div>\n              </div>\n            </Card>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            {/* Basic Configuration */}\n            <Card className=\"p-6\">\n              <h2 className=\"text-lg font-semibold mb-4 text-gray-900\">Basic Configuration</h2>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Bot Name\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => handleInputChange('name', e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    placeholder=\"Enter bot name\"\n                    required\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Exchange\n                  </label>\n                  <select\n                    value={formData.exchange}\n                    onChange={(e) => handleInputChange('exchange', e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  >\n                    <option value=\"bybit\">Bybit</option>\n                    <option value=\"okx\">OKX</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Trading Type\n                  </label>\n                  <select\n                    value={formData.tradingType}\n                    onChange={(e) => handleInputChange('tradingType', e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  >\n                    <option value=\"spot\">Spot Trading</option>\n                    <option value=\"futures\">Futures Trading</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Trading Pair\n                  </label>\n                  <select\n                    value={formData.symbol}\n                    onChange={(e) => handleInputChange('symbol', e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  >\n                    {popularSymbols.map(symbol => (\n                      <option key={symbol} value={symbol}>{symbol}</option>\n                    ))}\n                  </select>\n                  <div className=\"mt-2\">\n                    <div className=\"flex items-center space-x-4 mb-3\">\n                      <label className=\"flex items-center\">\n                        <input\n                          type=\"radio\"\n                          name=\"pairMode\"\n                          checked={!useMultiplePairs}\n                          onChange={() => setUseMultiplePairs(false)}\n                          className=\"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300\"\n                        />\n                        <span className=\"text-sm text-gray-700\">Single Pair</span>\n                      </label>\n                      <label className=\"flex items-center\">\n                        <input\n                          type=\"radio\"\n                          name=\"pairMode\"\n                          checked={useMultiplePairs}\n                          onChange={() => setUseMultiplePairs(true)}\n                          className=\"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300\"\n                        />\n                        <span className=\"text-sm text-gray-700\">Multiple Pairs</span>\n                      </label>\n                    </div>\n                    \n                    {!useMultiplePairs ? (\n                      <>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Or enter a custom pair (e.g., DOGEUSDT)\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={customSymbol}\n                          onChange={(e) => setCustomSymbol(e.target.value)}\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase\"\n                          placeholder=\"e.g., PEPEUSDT\"\n                        />\n                        {customSymbolError && (\n                          <p className=\"text-xs text-red-600 mt-1\">{customSymbolError}</p>\n                        )}\n                        <p className=\"text-xs text-gray-500 mt-1\">Uppercase; must end with USDT. If provided, overrides dropdown.</p>\n                      </>\n                    ) : (\n                      <>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                          Enter multiple trading pairs\n                        </label>\n                        <textarea\n                          value={customPairs}\n                          onChange={(e) => setCustomPairs(e.target.value)}\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent uppercase font-mono text-sm\"\n                          placeholder=\"BTCUSDT&#10;ETHUSDT&#10;SOLUSDT&#10;&#10;Or comma-separated: BTCUSDT, ETHUSDT, SOLUSDT\"\n                          rows={6}\n                        />\n                        <p className=\"text-xs text-gray-500 mt-1\">\n                          Enter pairs separated by commas or new lines. Each pair must be uppercase and end with USDT.\n                          <br />\n                          Example: <code className=\"bg-gray-100 px-1 rounded\">BTCUSDT, ETHUSDT, SOLUSDT</code> or one per line\n                        </p>\n                        {customPairs.trim() && (\n                          <div className=\"mt-2 p-2 bg-blue-50 rounded border border-blue-200\">\n                            <p className=\"text-xs font-medium text-blue-900 mb-1\">\n                              {customPairs.split(/[\\n,]/).filter(p => p.trim().length > 0).length} pair(s) detected:\n                            </p>\n                            <div className=\"flex flex-wrap gap-1\">\n                              {customPairs\n                                .split(/[\\n,]/)\n                                .map(p => p.trim().toUpperCase())\n                                .filter(p => p.length > 0)\n                                .map((pair, idx) => (\n                                  <span key={idx} className=\"text-xs bg-white px-2 py-1 rounded border border-blue-300 text-blue-700\">\n                                    {pair}\n                                  </span>\n                                ))}\n                            </div>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n\n                  {/* AI Recommendations */}\n                  {effectiveSymbol && (\n                    <div className=\"mt-4\">\n                      <PairRecommendations\n                        symbol={effectiveSymbol}\n                        tradingType={formData.tradingType}\n                        currentStrategy={strategy}\n                        currentAdvancedConfig={advancedConfig}\n                        currentTradeAmount={formData.tradeAmount}\n                        currentLeverage={formData.leverage}\n                        currentStopLoss={formData.stopLoss}\n                        currentTakeProfit={formData.takeProfit}\n                        onApplyRecommendation={handleApplyRecommendation}\n                      />\n                    </div>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Time Frame\n                  </label>\n                  <select\n                    value={formData.timeframe}\n                    onChange={(e) => handleInputChange('timeframe', e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  >\n                    <option value=\"1m\">1 Minute</option>\n                    <option value=\"5m\">5 Minutes</option>\n                    <option value=\"15m\">15 Minutes</option>\n                    <option value=\"1h\">1 Hour</option>\n                    <option value=\"2h\">2 Hours</option>\n                    <option value=\"3h\">3 Hours</option>\n                    <option value=\"4h\">4 Hours</option>\n                    <option value=\"1d\">1 Day</option>\n                    <option value=\"1w\">1 Week</option>\n                  </select>\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Chart interval for technical analysis\n                  </p>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Leverage\n                  </label>\n                  <select\n                    value={formData.leverage}\n                    onChange={(e) => handleInputChange('leverage', parseInt(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  >\n                    <option value={1}>1x</option>\n                    <option value={2}>2x</option>\n                    <option value={3}>3x</option>\n                    <option value={5}>5x</option>\n                    <option value={10}>10x</option>\n                    <option value={20}>20x</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Risk Level\n                  </label>\n                  <select\n                    value={formData.riskLevel}\n                    onChange={(e) => handleInputChange('riskLevel', e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  >\n                    <option value=\"low\">Low Risk</option>\n                    <option value=\"medium\">Medium Risk</option>\n                    <option value=\"high\">High Risk</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Trade Amount (USD)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={formData.tradeAmount}\n                    onChange={(e) => handleInputChange('tradeAmount', parseFloat(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"10\"\n                    max=\"10000\"\n                    step=\"10\"\n                    required\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Base trade amount in USD (will be multiplied by leverage and risk level)\n                  </p>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Stop Loss (%)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={(formData as any).stopLoss}\n                    onChange={(e) => handleInputChange('stopLoss', parseFloat(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"0.5\"\n                    max=\"10\"\n                    step=\"0.5\"\n                    required\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Maximum loss percentage before closing position\n                  </p>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Take Profit (%)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={(formData as any).takeProfit}\n                    onChange={(e) => handleInputChange('takeProfit', parseFloat(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"1\"\n                    max=\"20\"\n                    step=\"0.5\"\n                    required\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Target profit percentage before closing position\n                  </p>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Cooldown (Bars)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={advancedConfig.cooldown_bars}\n                    onChange={(e) => setAdvancedConfig(prev => ({ ...prev, cooldown_bars: parseInt(e.target.value) || 8 }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"1\"\n                    max=\"100\"\n                    step=\"1\"\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Number of bars to wait between trades (prevents overtrading)\n                  </p>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Allowed Trading Hours (EST)\n                  </label>\n                  <div className=\"border border-gray-300 rounded-lg p-3 bg-gray-50 max-h-48 overflow-y-auto\">\n                    <div className=\"flex items-center mb-2\">\n                      <input\n                        type=\"checkbox\"\n                        checked={(advancedConfig.allowed_hours_utc || []).length === 24}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setAdvancedConfig(prev => ({ \n                              ...prev, \n                              allowed_hours_utc: [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],\n                              session_filter_enabled: false\n                            }));\n                          } else {\n                            setAdvancedConfig(prev => ({ \n                              ...prev, \n                              allowed_hours_utc: [],\n                              session_filter_enabled: true\n                            }));\n                          }\n                        }}\n                        className=\"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <span className=\"text-sm font-medium text-gray-700\">Select All (24/7)</span>\n                    </div>\n                    <div className=\"grid grid-cols-4 gap-2\">\n                      {Array.from({ length: 24 }, (_, i) => {\n                        // Convert UTC hour to EST for display (EST = UTC - 5)\n                        const estHour = (i - 5 + 24) % 24;\n                        const isSelected = (advancedConfig.allowed_hours_utc || []).includes(i);\n                        return (\n                          <label key={i} className=\"flex items-center\">\n                            <input\n                              type=\"checkbox\"\n                              checked={isSelected}\n                              onChange={(e) => {\n                                if (e.target.checked) {\n                                  setAdvancedConfig(prev => ({\n                                    ...prev,\n                                    allowed_hours_utc: [...(prev.allowed_hours_utc || []), i].sort((a, b) => a - b),\n                                    session_filter_enabled: true\n                                  }));\n                                } else {\n                                  setAdvancedConfig(prev => ({\n                                    ...prev,\n                                    allowed_hours_utc: (prev.allowed_hours_utc || []).filter(h => h !== i),\n                                    session_filter_enabled: (prev.allowed_hours_utc || []).filter(h => h !== i).length > 0\n                                  }));\n                                }\n                              }}\n                              className=\"mr-1 h-3 w-3 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                            />\n                            <span className=\"text-xs text-gray-700\">\n                              {estHour.toString().padStart(2, '0')}:00 EST\n                            </span>\n                          </label>\n                        );\n                      })}\n                    </div>\n                  </div>\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Select hours when bot is allowed to trade (stored in UTC, displayed in EST)\n                  </p>\n                </div>\n              </div>\n            </Card>\n\n            {/* Paper Trading Toggle */}\n            <Card className=\"p-6 bg-yellow-50 border-2 border-yellow-200\">\n              <div className=\"flex items-start mb-2\">\n                <input\n                  type=\"checkbox\"\n                  id=\"paperTrading\"\n                  checked={formData.paperTrading}\n                  onChange={(e) => setFormData(prev => ({ ...prev, paperTrading: e.target.checked }))}\n                  className=\"mr-3 h-5 w-5 text-yellow-600 focus:ring-yellow-500 border-gray-300 rounded mt-1\"\n                />\n                <div className=\"flex-1\">\n                  <label htmlFor=\"paperTrading\" className=\"text-lg font-semibold text-gray-900 cursor-pointer\">\n                    üìù Enable Paper Trading (Simulation Mode)\n                  </label>\n                  <p className=\"text-sm text-gray-700 mt-1\">\n                    Uses REAL mainnet market data but simulates all trades. Perfect for testing strategies risk-free.\n                    No real orders will be placed when this is enabled.\n                  </p>\n                  {formData.paperTrading && (\n                    <div className=\"mt-3 p-3 bg-white rounded border border-yellow-300\">\n                      <p className=\"text-xs text-green-600 font-medium mb-2\">\n                        ‚úÖ Paper Trading Enabled - All trades will be simulated\n                      </p>\n                      <p className=\"text-xs text-gray-600\">\n                        ‚Ä¢ Uses real mainnet market data for accuracy<br/>\n                        ‚Ä¢ Virtual balance: $10,000 (can be adjusted in settings)<br/>\n                        ‚Ä¢ No real API orders will be placed<br/>\n                        ‚Ä¢ Perfect for strategy testing\n                      </p>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </Card>\n\n            {/* Strategy Configuration */}\n            <Card className=\"p-6\">\n              <h2 className=\"text-lg font-semibold mb-4 text-gray-900\">Strategy Parameters</h2>\n              <div className=\"mb-6\">\n                <div className=\"bg-purple-50 border border-purple-200 rounded-lg p-4\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <h3 className=\"font-semibold text-purple-900 flex items-center gap-2 text-sm md:text-base\">\n                      <i className=\"ri-brain-line\"></i>\n                      AI Strategy Presets\n                    </h3>\n                    <span className=\"hidden md:block text-xs text-purple-700\">\n                      Apply vetted AI configurations in one click\n                    </span>\n                  </div>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {STRATEGY_PRESETS.map((preset) => (\n                      <button\n                        key={preset.key}\n                        type=\"button\"\n                        onClick={() => applyStrategyPreset(preset)}\n                        className=\"px-3 py-2 rounded-lg border border-purple-300 bg-white text-purple-700 hover:bg-purple-100 text-sm font-medium flex items-center gap-2 transition-colors\"\n                      >\n                        <i className=\"ri-flashlight-line\"></i>\n                        {preset.label}\n                      </button>\n                    ))}\n                  </div>\n                  <p className=\"text-xs text-purple-700 mt-3\">\n                    Presets automatically tune core indicators, risk controls, and recommended trade sizing.\n                  </p>\n                </div>\n              </div>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    RSI Threshold\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={strategy.rsiThreshold}\n                    onChange={(e) => handleStrategyChange('rsiThreshold', parseFloat(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"30\"\n                    max=\"90\"\n                    step=\"5\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    ADX Threshold\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={strategy.adxThreshold}\n                    onChange={(e) => handleStrategyChange('adxThreshold', parseFloat(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"10\"\n                    max=\"50\"\n                    step=\"5\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    BB Width Threshold\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={strategy.bbWidthThreshold}\n                    onChange={(e) => handleStrategyChange('bbWidthThreshold', parseFloat(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"0.01\"\n                    max=\"0.1\"\n                    step=\"0.005\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    EMA Slope\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={strategy.emaSlope}\n                    onChange={(e) => handleStrategyChange('emaSlope', parseFloat(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"0.1\"\n                    max=\"2\"\n                    step=\"0.1\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    ATR Percentage\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={strategy.atrPercentage}\n                    onChange={(e) => handleStrategyChange('atrPercentage', parseFloat(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"1\"\n                    max=\"10\"\n                    step=\"0.5\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    VWAP Distance\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={strategy.vwapDistance}\n                    onChange={(e) => handleStrategyChange('vwapDistance', parseFloat(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"0.5\"\n                    max=\"3\"\n                    step=\"0.1\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Momentum Threshold\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={strategy.momentumThreshold}\n                    onChange={(e) => handleStrategyChange('momentumThreshold', parseFloat(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"0.1\"\n                    max=\"2\"\n                    step=\"0.1\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Min Samples for ML\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={strategy.minSamplesForML}\n                    onChange={(e) => handleStrategyChange('minSamplesForML', parseInt(e.target.value))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    min=\"50\"\n                    max=\"500\"\n                    step=\"25\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"mt-4\">\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"checkbox\"\n                    checked={strategy.useMLPrediction}\n                    onChange={(e) => handleStrategyChange('useMLPrediction', e.target.checked)}\n                    className=\"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                  />\n                  <span className=\"text-sm font-medium text-gray-700\">\n                    Enable ML Prediction (fallback to rules until min samples)\n                  </span>\n                </label>\n              </div>\n            </Card>\n\n            {/* Advanced Configuration - Collapsible */}\n            <Card className=\"p-6\">\n              <button\n                type=\"button\"\n                onClick={() => setShowAdvanced(!showAdvanced)}\n                className=\"w-full flex items-center justify-between text-left\"\n              >\n                <h2 className=\"text-lg font-semibold text-gray-900\">\n                  ‚öôÔ∏è Advanced Strategy Configuration\n                </h2>\n                <i className={`ri-arrow-${showAdvanced ? 'up' : 'down'}-s-line text-2xl text-gray-600`}></i>\n              </button>\n              \n              {showAdvanced && (\n                <div className=\"mt-6 space-y-6\">\n                  {/* Directional Bias */}\n                  <div className=\"border-l-4 border-purple-500 pl-4\">\n                    <h3 className=\"text-md font-semibold text-gray-800 mb-3\">üéØ Directional Bias</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Bias Mode\n                        </label>\n                        <select\n                          value={advancedConfig.bias_mode}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, bias_mode: e.target.value as any }))}\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                        >\n                          <option value=\"auto\">Auto (Follow HTF Trend)</option>\n                          <option value=\"long-only\">Long Only</option>\n                          <option value=\"short-only\">Short Only</option>\n                          <option value=\"both\">Both Directions</option>\n                        </select>\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          HTF Timeframe\n                        </label>\n                        <select\n                          value={advancedConfig.htf_timeframe}\n                          onChange={(e) =>\n                            setAdvancedConfig(prev => ({\n                              ...prev,\n                              htf_timeframe: e.target.value as typeof prev.htf_timeframe\n                            }))\n                          }\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                        >\n                          {HTF_TIMEFRAME_OPTIONS.map(option => (\n                            <option key={option.value} value={option.value}>\n                              {option.label}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          HTF Trend Indicator\n                        </label>\n                        <select\n                          value={advancedConfig.htf_trend_indicator}\n                          onChange={(e) =>\n                            setAdvancedConfig(prev => ({\n                              ...prev,\n                              htf_trend_indicator: e.target.value as typeof prev.htf_trend_indicator\n                            }))\n                          }\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                        >\n                          {HTF_TREND_INDICATOR_OPTIONS.map(option => (\n                            <option key={option.value} value={option.value}>\n                              {option.label}\n                            </option>\n                          ))}\n                        </select>\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          ADX Min (HTF): {advancedConfig.adx_min_htf}\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.adx_min_htf}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, adx_min_htf: parseFloat(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"15\"\n                          max=\"35\"\n                          step=\"1\"\n                        />\n                        <p className=\"text-xs text-gray-500\">Minimum ADX for trend confirmation</p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Indicator Settings */}\n                  <div className=\"border-l-4 border-indigo-500 pl-4\">\n                    <h3 className=\"text-md font-semibold text-gray-800 mb-3\">üìê Indicator Settings</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          EMA Length\n                        </label>\n                        <input\n                          type=\"number\"\n                          value={advancedConfig.ema_fast_period ?? 50}\n                          onChange={(e) =>\n                            setAdvancedConfig(prev => ({\n                              ...prev,\n                              ema_fast_period: parseInt(e.target.value) || 50\n                            }))\n                          }\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                          min={1}\n                          max={500}\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          ATR Length\n                        </label>\n                        <input\n                          type=\"number\"\n                          value={advancedConfig.atr_period ?? 14}\n                          onChange={(e) =>\n                            setAdvancedConfig(prev => ({\n                              ...prev,\n                              atr_period: parseInt(e.target.value) || 14\n                            }))\n                          }\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                          min={1}\n                          max={200}\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          ATR TP Multiplier\n                        </label>\n                        <input\n                          type=\"number\"\n                          value={advancedConfig.atr_tp_multiplier ?? 3}\n                          onChange={(e) =>\n                            setAdvancedConfig(prev => ({\n                              ...prev,\n                              atr_tp_multiplier: parseFloat(e.target.value) || 3\n                            }))\n                          }\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                          min={0.5}\n                          max={10}\n                          step={0.1}\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          ATR SL Multiplier\n                        </label>\n                        <input\n                          type=\"number\"\n                          value={advancedConfig.sl_atr_mult}\n                          onChange={(e) =>\n                            setAdvancedConfig(prev => ({\n                              ...prev,\n                              sl_atr_mult: parseFloat(e.target.value) || prev.sl_atr_mult\n                            }))\n                          }\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                          min={0.5}\n                          max={5}\n                          step={0.1}\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          RSI Length\n                        </label>\n                        <input\n                          type=\"number\"\n                          value={advancedConfig.rsi_period ?? 14}\n                          onChange={(e) =>\n                            setAdvancedConfig(prev => ({\n                              ...prev,\n                              rsi_period: parseInt(e.target.value) || 14\n                            }))\n                          }\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                          min={5}\n                          max={50}\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          RSI Overbought\n                        </label>\n                        <input\n                          type=\"number\"\n                          value={advancedConfig.rsi_overbought ?? 70}\n                          onChange={(e) =>\n                            setAdvancedConfig(prev => ({\n                              ...prev,\n                              rsi_overbought: parseInt(e.target.value) || 70\n                            }))\n                          }\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                          min={50}\n                          max={100}\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          RSI Oversold\n                        </label>\n                        <input\n                          type=\"number\"\n                          value={advancedConfig.rsi_oversold ?? 30}\n                          onChange={(e) =>\n                            setAdvancedConfig(prev => ({\n                              ...prev,\n                              rsi_oversold: parseInt(e.target.value) || 30\n                            }))\n                          }\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                          min={0}\n                          max={50}\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Regime Filter */}\n                  <div className=\"border-l-4 border-blue-500 pl-4\">\n                    <h3 className=\"text-md font-semibold text-gray-800 mb-3\">üìä Regime Filter</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Regime Mode\n                        </label>\n                        <select\n                          value={advancedConfig.regime_mode}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, regime_mode: e.target.value as any }))}\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                        >\n                          <option value=\"auto\">Auto Detect</option>\n                          <option value=\"trend\">Trend Only</option>\n                          <option value=\"mean-reversion\">Mean Reversion Only</option>\n                        </select>\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          ADX Trend Min: {advancedConfig.adx_trend_min}\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.adx_trend_min}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, adx_trend_min: parseFloat(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"20\"\n                          max=\"35\"\n                          step=\"1\"\n                        />\n                        <p className=\"text-xs text-gray-500\">ADX ‚â• this = trending</p>\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          ADX Mean Rev Max: {advancedConfig.adx_meanrev_max}\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.adx_meanrev_max}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, adx_meanrev_max: parseFloat(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"15\"\n                          max=\"25\"\n                          step=\"1\"\n                        />\n                        <p className=\"text-xs text-gray-500\">ADX ‚â§ this = ranging</p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Risk Management */}\n                  <div className=\"border-l-4 border-red-500 pl-4\">\n                    <h3 className=\"text-md font-semibold text-gray-800 mb-3\">üõ°Ô∏è Risk Management</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Risk Per Trade: {advancedConfig.risk_per_trade_pct}%\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.risk_per_trade_pct}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, risk_per_trade_pct: parseFloat(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"0.25\"\n                          max=\"2.0\"\n                          step=\"0.25\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Daily Loss Limit: {advancedConfig.daily_loss_limit_pct}%\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.daily_loss_limit_pct}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, daily_loss_limit_pct: parseFloat(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"1\"\n                          max=\"10\"\n                          step=\"0.5\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Max Trades/Day: {advancedConfig.max_trades_per_day}\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.max_trades_per_day}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, max_trades_per_day: parseInt(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"1\"\n                          max=\"200\"\n                          step=\"1\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Weekly Loss Limit: {advancedConfig.weekly_loss_limit_pct}%\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.weekly_loss_limit_pct}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, weekly_loss_limit_pct: parseFloat(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"2\"\n                          max=\"15\"\n                          step=\"0.5\"\n                        />\n                        <p className=\"text-xs text-gray-500\">Auto-pause if weekly loss exceeds</p>\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Max Concurrent Positions: {advancedConfig.max_concurrent}\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.max_concurrent}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, max_concurrent: parseInt(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"1\"\n                          max=\"5\"\n                          step=\"1\"\n                        />\n                        <p className=\"text-xs text-gray-500\">Max open positions simultaneously</p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Safety Features */}\n                  <div className=\"border-l-4 border-orange-500 pl-4 mt-6\">\n                    <h3 className=\"text-md font-semibold text-gray-800 mb-3\">üõ°Ô∏è Safety Features</h3>\n                    <p className=\"text-sm text-gray-600 mb-4\">\n                      Configure automatic safety limits to protect your bot from excessive losses.\n                    </p>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Max Consecutive Losses: {advancedConfig.max_consecutive_losses || 5}\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.max_consecutive_losses || 5}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, max_consecutive_losses: parseInt(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"2\"\n                          max=\"10\"\n                          step=\"1\"\n                        />\n                        <p className=\"text-xs text-gray-500 mt-1\">\n                          Auto-pause bot after this many consecutive losses\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Exit Strategy */}\n                  <div className=\"border-l-4 border-green-500 pl-4\">\n                    <h3 className=\"text-md font-semibold text-gray-800 mb-3\">üéØ Exit Strategy</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          TP1 (R): {advancedConfig.tp1_r}\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.tp1_r}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, tp1_r: parseFloat(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"0.5\"\n                          max=\"3.0\"\n                          step=\"0.25\"\n                        />\n                        <p className=\"text-xs text-gray-500\">First take profit (R = Risk units)</p>\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          TP2 (R): {advancedConfig.tp2_r}\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.tp2_r}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, tp2_r: parseFloat(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"1.0\"\n                          max=\"5.0\"\n                          step=\"0.25\"\n                        />\n                        <p className=\"text-xs text-gray-500\">Second take profit</p>\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          TP1 Size: {(advancedConfig.tp1_size * 100).toFixed(0)}%\n                        </label>\n                        <input\n                          type=\"range\"\n                          value={advancedConfig.tp1_size}\n                          onChange={(e) => setAdvancedConfig(prev => ({ ...prev, tp1_size: parseFloat(e.target.value) }))}\n                          className=\"w-full\"\n                          min=\"0.25\"\n                          max=\"0.75\"\n                          step=\"0.05\"\n                        />\n                        <p className=\"text-xs text-gray-500\">% to close at TP1</p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Quick Presets */}\n                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                    <h4 className=\"font-semibold text-blue-900 mb-3\">‚ö° Quick Presets</h4>\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setAdvancedConfig({\n                          ...advancedConfig,\n                          bias_mode: 'auto',\n                          regime_mode: 'trend',\n                          risk_per_trade_pct: 0.5,\n                          max_trades_per_day: 6,\n                          tp1_r: 1.5,\n                          tp2_r: 3.0\n                        })}\n                        className=\"px-4 py-2 bg-white border-2 border-blue-300 text-blue-700 rounded-lg hover:bg-blue-50 font-medium\"\n                      >\n                        üê¢ Conservative\n                      </button>\n                      <button\n                        type=\"button\"\n                        onClick={() => setAdvancedConfig({\n                          ...advancedConfig,\n                          bias_mode: 'auto',\n                          regime_mode: 'auto',\n                          risk_per_trade_pct: 0.75,\n                          max_trades_per_day: 8,\n                          tp1_r: 1.0,\n                          tp2_r: 2.0\n                        })}\n                        className=\"px-4 py-2 bg-white border-2 border-blue-300 text-blue-700 rounded-lg hover:bg-blue-50 font-medium\"\n                      >\n                        ‚öñÔ∏è Balanced\n                      </button>\n                      <button\n                        type=\"button\"\n                        onClick={() => setAdvancedConfig({\n                          ...advancedConfig,\n                          bias_mode: 'both',\n                          regime_mode: 'auto',\n                          risk_per_trade_pct: 1.0,\n                          max_trades_per_day: 12,\n                          tp1_r: 0.8,\n                          tp2_r: 1.5\n                        })}\n                        className=\"px-4 py-2 bg-white border-2 border-blue-300 text-blue-700 rounded-lg hover:bg-blue-50 font-medium\"\n                      >\n                        üöÄ Aggressive\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </Card>\n\n            {/* Action Buttons */}\n            <div className=\"flex gap-4\">\n              <Button\n                type=\"button\"\n                variant=\"secondary\"\n                onClick={() => navigate('/bots')}\n                className=\"flex-1\"\n              >\n                Cancel\n              </Button>\n              <Button\n                type=\"submit\"\n                variant=\"primary\"\n                loading={isCreating}\n                className=\"flex-1\"\n              >\n                {isCreating ? 'Creating Bot...' : 'Create Bot'}\n              </Button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n"],"names":["PairRecommendationsService","symbol","tradingType","currentSettings","historicalTrades","tradesError","supabase","existingBots","botsError","performanceMetrics","error","trades","bots","closedTrades","t","wins","losses","winRate","totalPnL","sum","avgPnL","totalProfit","totalLoss","profitFactor","returns","avgReturn","r","variance","sharpeRatio","maxDrawdown","runningPnL","peakPnL","trade","drawdown","maxDrawdownPercent","bestBot","best","bot","currentWinRate","bestWinRate","avgTradeAmount","b","avgLeverage","avgStopLoss","avgTakeProfit","metrics","pairStrategy","defaultAdvancedConfig","result","openAIService","pairBasicSettings","completeAdvancedConfig","_a","_b","_c","_d","_e","completeStrategy","_f","_g","_h","_i","_j","_k","_l","_m","_n","hasHistoricalData","defaultReasoning","optimizationResult","changes","currentStrategy","key","recommendedValue","currentValue","currentAdvancedConfig","parameter","pairRisk","pairRecommendationsService","PairRecommendations","currentTradeAmount","currentLeverage","currentStopLoss","currentTakeProfit","onApplyRecommendation","recommendation","setRecommendation","useState","loading","setLoading","setError","showDetails","setShowDetails","hasAnyProvider","setHasAnyProvider","aiProvider","setAiProvider","saved","fetchRecommendations","rec","err","useEffect","status","openai","deepseek","handleProviderChange","provider","handleApply","Card","jsxs","jsx","e","Button","Fragment","c","change","idx","CreateBotPage","navigate","useNavigate","location","useLocation","searchParams","useSearchParams","createBot","useBots","backtestData","isFromBacktest","isFromPabloReady","pabloReadyBotId","urlSymbol","urlExchange","urlTradingType","urlLeverage","urlRiskLevel","urlTradeAmount","urlStopLoss","urlTakeProfit","urlTimeframe","urlStrategy","urlStrategyConfig","formData","setFormData","prev","customSymbol","setCustomSymbol","customSymbolError","setCustomSymbolError","useMultiplePairs","setUseMultiplePairs","customPairs","setCustomPairs","data","parsedStrategy","parsedConfig","setStrategy","setAdvancedConfig","strategy","advancedConfig","symbols","showAdvanced","setShowAdvanced","isCreating","setIsCreating","popularSymbols","handleSubmit","finalSymbol","customPairsInput","parsedPairs","pair","invalidPairs","raw","botData","handleInputChange","field","value","handleStrategyChange","applyStrategyPreset","preset","handleApplyRecommendation","merged","strategyChanges","advancedChanges","totalChanges","message","effectiveSymbol","p","Header","_","i","estHour","isSelected","a","h","STRATEGY_PRESETS","HTF_TIMEFRAME_OPTIONS","option","HTF_TREND_INDICATOR_OPTIONS"],"mappings":"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"}