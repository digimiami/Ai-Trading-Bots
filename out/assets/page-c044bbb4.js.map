{"version":3,"file":"page-c044bbb4.js","sources":["../../src/hooks/usePerformance.ts","../../src/pages/performance/page.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { supabase } from '../lib/supabase';\r\n\r\nexport interface PerformanceData {\r\n  totalPnL: number;\r\n  tradingVolume: number;\r\n  totalTrades: number;\r\n  winRate: number;\r\n  avgWin: number;\r\n  avgLoss: number;\r\n  profitableDays: number;\r\n  totalDays: number;\r\n}\r\n\r\nexport interface DailyPnL {\r\n  date: string;\r\n  pnl: number;\r\n  volume: number;\r\n  trades: number;\r\n  profit: number;\r\n  loss: number;\r\n}\r\n\r\nexport interface SymbolPnL {\r\n  symbol: string;\r\n  pnl: number;\r\n  volume: number;\r\n  trades: number;\r\n  winRate: number;\r\n}\r\n\r\nexport interface PerformanceMetrics {\r\n  overview: PerformanceData;\r\n  dailyPnL: DailyPnL[];\r\n  symbolRanking: SymbolPnL[];\r\n}\r\n\r\nexport function usePerformance(\r\n  startDate?: Date,\r\n  endDate?: Date,\r\n  assetType?: 'all' | 'perpetuals' | 'spot'\r\n) {\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [metrics, setMetrics] = useState<PerformanceMetrics | null>(null);\r\n  const [abortController, setAbortController] = useState<AbortController | null>(null);\r\n\r\n  const fetchPerformance = async () => {\r\n    // Cancel any pending request\r\n    if (abortController) {\r\n      abortController.abort();\r\n    }\r\n\r\n    // Create new abort controller for this request\r\n    const controller = new AbortController();\r\n    setAbortController(controller);\r\n\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      // Default to last 7 days if no dates provided\r\n      const end = endDate || new Date();\r\n      const start = startDate || new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\r\n\r\n      // Fetch all trades within date range\r\n      // Use executed_at, created_at, or timestamp - whichever is available\r\n      let query = supabase\r\n        .from('trades')\r\n        .select('*, trading_bots(symbol, trading_type)')\r\n        .gte('created_at', start.toISOString())\r\n        .lte('created_at', end.toISOString())\r\n        .order('created_at', { ascending: false })\r\n        .limit(10000); // Limit to prevent excessive data\r\n\r\n      const { data: trades, error: tradesError } = await query;\r\n\r\n      // Check if request was aborted\r\n      if (controller.signal.aborted) {\r\n        return;\r\n      }\r\n      \r\n      if (tradesError) throw tradesError;\r\n\r\n      // Filter by asset type if specified\r\n      let filteredTrades = trades || [];\r\n      if (assetType && assetType !== 'all') {\r\n        const tradingType = assetType === 'perpetuals' ? 'futures' : 'spot';\r\n        filteredTrades = filteredTrades.filter(\r\n          (t: any) => t.trading_bots?.trading_type === tradingType\r\n        );\r\n      }\r\n\r\n      if (!filteredTrades || filteredTrades.length === 0) {\r\n        setMetrics({\r\n          overview: {\r\n            totalPnL: 0,\r\n            tradingVolume: 0,\r\n            totalTrades: 0,\r\n            winRate: 0,\r\n            avgWin: 0,\r\n            avgLoss: 0,\r\n            profitableDays: 0,\r\n            totalDays: 0,\r\n          },\r\n          dailyPnL: [],\r\n          symbolRanking: [],\r\n        });\r\n        return;\r\n      }\r\n\r\n      // Debug: Log sample trade data to see what we're getting\r\n      if (filteredTrades.length > 0) {\r\n        const firstTrade = filteredTrades[0];\r\n        const statuses = [...new Set(filteredTrades.map((t: any) => t.status))];\r\n        const sides = [...new Set(filteredTrades.map((t: any) => t.side))];\r\n        const hasExitPrices = filteredTrades.filter((t: any) => t.exit_price).length;\r\n        console.log(`ðŸ“Š Sample trade data: Count=${filteredTrades.length}, Statuses=[${statuses.join(', ')}], Sides=[${sides.join(', ')}], HasExitPrice=${hasExitPrices}/${filteredTrades.length}`);\r\n        console.log(`ðŸ“Š First trade: ID=${firstTrade.id?.substring(0, 8)}, Status=${firstTrade.status}, Side=${firstTrade.side}, Entry=${firstTrade.entry_price || firstTrade.price}, Exit=${firstTrade.exit_price || 'none'}, Size=${firstTrade.size || firstTrade.amount}, PnL=${firstTrade.pnl || 0}`);\r\n      }\r\n\r\n      // Calculate overview metrics\r\n      // Include all filled trades, even if PnL is 0 (it may be calculated later)\r\n      const closedTrades = filteredTrades.filter(\r\n        (t: any) => t.status === 'filled' || t.status === 'closed' || t.status === 'completed'\r\n      );\r\n      \r\n      // For spot trading, match buy/sell pairs to calculate PnL\r\n      // Group trades by symbol and try to match long/short pairs\r\n      const symbolGroups = new Map<string, any[]>();\r\n      closedTrades.forEach((t: any) => {\r\n        const symbol = t.symbol || t.trading_bots?.symbol;\r\n        if (!symbolGroups.has(symbol)) {\r\n          symbolGroups.set(symbol, []);\r\n        }\r\n        symbolGroups.get(symbol)!.push(t);\r\n      });\r\n      \r\n      // Match buy/sell pairs for spot trading and calculate PnL\r\n      const processedTradesMap = new Map<string, any>();\r\n      \r\n      symbolGroups.forEach((trades, symbol) => {\r\n        // Sort by date (oldest first)\r\n        trades.sort((a, b) => {\r\n          const dateA = new Date(a.executed_at || a.created_at || a.timestamp || 0).getTime();\r\n          const dateB = new Date(b.executed_at || b.created_at || b.timestamp || 0).getTime();\r\n          return dateA - dateB;\r\n        });\r\n        \r\n        // Match buys and sells (long and short)\r\n        const buys: any[] = [];\r\n        const sells: any[] = [];\r\n        \r\n        trades.forEach((t: any) => {\r\n          const side = (t.side || 'long').toLowerCase();\r\n          if (side === 'long' || side === 'buy') {\r\n            buys.push(t);\r\n          } else if (side === 'short' || side === 'sell') {\r\n            sells.push(t);\r\n          }\r\n        });\r\n        \r\n        // Match buy/sell pairs using FIFO (First In First Out)\r\n        let buyIndex = 0;\r\n        sells.forEach((sell: any) => {\r\n          while (buyIndex < buys.length) {\r\n            const buy = buys[buyIndex];\r\n            \r\n            // Get prices and sizes\r\n            const buyPrice = parseFloat(buy.entry_price || buy.price || 0);\r\n            const sellPrice = parseFloat(sell.entry_price || sell.price || 0);\r\n            const buySize = parseFloat(buy.size || buy.amount || 0);\r\n            const sellSize = parseFloat(sell.size || sell.amount || 0);\r\n            \r\n            if (buyPrice > 0 && sellPrice > 0 && buySize > 0 && sellSize > 0) {\r\n              // Calculate PnL for this pair\r\n              const matchedSize = Math.min(buySize, sellSize);\r\n              const pnl = (sellPrice - buyPrice) * matchedSize;\r\n              \r\n              // Update buy trade with PnL\r\n              if (!processedTradesMap.has(buy.id)) {\r\n                processedTradesMap.set(buy.id, { ...buy, pnl: pnl, matched: true });\r\n              } else {\r\n                const existing = processedTradesMap.get(buy.id);\r\n                processedTradesMap.set(buy.id, { ...existing, pnl: (existing.pnl || 0) + pnl });\r\n              }\r\n              \r\n              // Update sell trade with PnL (same value)\r\n              if (!processedTradesMap.has(sell.id)) {\r\n                processedTradesMap.set(sell.id, { ...sell, pnl: pnl, matched: true });\r\n              } else {\r\n                const existing = processedTradesMap.get(sell.id);\r\n                processedTradesMap.set(sell.id, { ...existing, pnl: (existing.pnl || 0) + pnl });\r\n              }\r\n              \r\n              // Reduce remaining sizes\r\n              if (sellSize >= buySize) {\r\n                buyIndex++;\r\n                break;\r\n              } else {\r\n                buys[buyIndex] = { ...buy, size: buySize - sellSize };\r\n                break;\r\n              }\r\n            } else {\r\n              buyIndex++;\r\n            }\r\n          }\r\n        });\r\n      });\r\n      \r\n      // Try to calculate PnL for trades that don't have it yet\r\n      // This handles trades where PnL wasn't calculated when closed\r\n      const processedTrades = closedTrades.map((t: any) => {\r\n        // If already processed from matching, use that\r\n        if (processedTradesMap.has(t.id)) {\r\n          return processedTradesMap.get(t.id);\r\n        }\r\n        // If PnL is already calculated and non-zero, use it\r\n        if (t.pnl !== null && t.pnl !== undefined && parseFloat(t.pnl) !== 0) {\r\n          return t;\r\n        }\r\n        \r\n        // Get entry price and size (handle field variations)\r\n        const entryPrice = parseFloat(t.entry_price || t.price || 0);\r\n        const exitPrice = parseFloat(t.exit_price || 0);\r\n        const size = parseFloat(t.size || t.amount || 0);\r\n        const side = (t.side || 'long').toLowerCase();\r\n        const fee = parseFloat(t.fee || 0);\r\n        \r\n        // Debug: Log trade details to understand why PnL can't be calculated\r\n        // Only log first few trades to avoid console spam\r\n        const shouldLog = closedTrades.length > 0 && !t.pnl && closedTrades.indexOf(t) < 3;\r\n        if (shouldLog) {\r\n          const reason = !exitPrice ? 'Missing exit_price' : entryPrice === 0 ? 'Missing entry_price' : size === 0 ? 'Missing size' : 'Unknown';\r\n          console.log(`ðŸ“Š Trade PnL calculation (first 3): ID=${t.id?.substring(0, 8) || 'unknown'}, Status=${t.status}, Side=${side}, Entry=${entryPrice}, Exit=${exitPrice}, Size=${size}, Reason=\"${reason}\", CanCalculate=${entryPrice > 0 && exitPrice > 0 && size > 0}`);\r\n        }\r\n        \r\n        // If we have exit price, calculate realized PnL\r\n        if (entryPrice > 0 && exitPrice > 0 && size > 0) {\r\n          let calculatedPnL = 0;\r\n          if (side === 'long') {\r\n            calculatedPnL = (exitPrice - entryPrice) * size - fee;\r\n          } else {\r\n            calculatedPnL = (entryPrice - exitPrice) * size - fee;\r\n          }\r\n          \r\n          return {\r\n            ...t,\r\n            pnl: calculatedPnL\r\n          };\r\n        }\r\n        \r\n        // Return trade as-is if we can't calculate PnL (no exit_price)\r\n        return t;\r\n      });\r\n      \r\n      // Separate trades with actual PnL vs trades with PnL = 0 or null\r\n      const tradesWithPnL = processedTrades.filter(\r\n        (t: any) => {\r\n          const pnl = parseFloat(t.pnl || 0);\r\n          return !isNaN(pnl) && pnl !== 0;\r\n        }\r\n      );\r\n      \r\n      const winningTrades = tradesWithPnL.filter((t: any) => (parseFloat(t.pnl) || 0) > 0);\r\n      const losingTrades = tradesWithPnL.filter((t: any) => (parseFloat(t.pnl) || 0) <= 0);\r\n\r\n      // Calculate total P&L from trades that have actual PnL values\r\n      const totalPnL = tradesWithPnL.reduce(\r\n        (sum: number, t: any) => sum + (parseFloat(t.pnl) || 0),\r\n        0\r\n      );\r\n\r\n      // Calculate trading volume - try both field name variations\r\n      const tradingVolume = filteredTrades.reduce(\r\n        (sum: number, t: any) => {\r\n          const amount = parseFloat(t.amount || t.size || 0);\r\n          const price = parseFloat(t.price || t.entry_price || 0);\r\n          return sum + (amount * price);\r\n        },\r\n        0\r\n      );\r\n\r\n      // Win rate should only be calculated from trades with actual PnL values\r\n      const winRate =\r\n        tradesWithPnL.length > 0\r\n          ? (winningTrades.length / tradesWithPnL.length) * 100\r\n          : 0;\r\n\r\n      const avgWin =\r\n        winningTrades.length > 0\r\n          ? winningTrades.reduce(\r\n              (sum: number, t: any) => sum + (parseFloat(t.pnl) || 0),\r\n              0\r\n            ) / winningTrades.length\r\n          : 0;\r\n\r\n      const avgLoss =\r\n        losingTrades.length > 0\r\n          ? losingTrades.reduce(\r\n              (sum: number, t: any) => sum + Math.abs(parseFloat(t.pnl) || 0),\r\n              0\r\n            ) / losingTrades.length\r\n          : 0;\r\n\r\n      // Calculate daily P&L\r\n      const dailyPnLMap = new Map<string, DailyPnL>();\r\n\r\n      // Use processed trades for daily PnL calculation\r\n      processedTrades.forEach((trade: any) => {\r\n        const tradeDate = trade.executed_at || trade.created_at || trade.timestamp;\r\n        const date = new Date(tradeDate).toISOString().split('T')[0];\r\n\r\n        if (!dailyPnLMap.has(date)) {\r\n          dailyPnLMap.set(date, {\r\n            date,\r\n            pnl: 0,\r\n            volume: 0,\r\n            trades: 0,\r\n            profit: 0,\r\n            loss: 0,\r\n          });\r\n        }\r\n\r\n        const daily = dailyPnLMap.get(date)!;\r\n        // Use calculated PnL if available\r\n        let pnl = parseFloat(trade.pnl) || 0;\r\n        \r\n        // If PnL is 0, try to calculate from entry/exit prices\r\n        if (pnl === 0) {\r\n          const entryPrice = parseFloat(trade.entry_price || trade.price || 0);\r\n          const exitPrice = parseFloat(trade.exit_price || 0);\r\n          const size = parseFloat(trade.size || trade.amount || 0);\r\n          const side = (trade.side || 'long').toLowerCase();\r\n          const fee = parseFloat(trade.fee || 0);\r\n          \r\n          if (entryPrice > 0 && exitPrice > 0 && size > 0) {\r\n            if (side === 'long') {\r\n              pnl = (exitPrice - entryPrice) * size - fee;\r\n            } else {\r\n              pnl = (entryPrice - exitPrice) * size - fee;\r\n            }\r\n          }\r\n        }\r\n        \r\n        const amount = parseFloat(trade.amount || trade.size || 0);\r\n        const price = parseFloat(trade.price || trade.entry_price || 0);\r\n        const volume = amount * price;\r\n\r\n        daily.pnl += pnl;\r\n        daily.volume += volume;\r\n        daily.trades += 1;\r\n\r\n        if (pnl > 0) {\r\n          daily.profit += pnl;\r\n        } else if (pnl < 0) {\r\n          daily.loss += Math.abs(pnl);\r\n        }\r\n      });\r\n\r\n      const dailyPnL = Array.from(dailyPnLMap.values())\r\n        .sort((a, b) => a.date.localeCompare(b.date))\r\n        .map((day) => ({\r\n          ...day,\r\n          pnl: parseFloat(day.pnl.toFixed(2)),\r\n          volume: parseFloat(day.volume.toFixed(2)),\r\n        }));\r\n\r\n      const profitableDays = dailyPnL.filter((day) => day.pnl > 0).length;\r\n\r\n      // Calculate symbol ranking - only use trades with actual PnL\r\n      const symbolMap = new Map<string, SymbolPnL>();\r\n\r\n      tradesWithPnL.forEach((trade: any) => {\r\n        const symbol = trade.symbol;\r\n        const pnl = parseFloat(trade.pnl) || 0;\r\n        const amount = parseFloat(trade.amount || trade.size || 0);\r\n        const price = parseFloat(trade.price || trade.entry_price || 0);\r\n        const volume = amount * price;\r\n\r\n        if (!symbolMap.has(symbol)) {\r\n          symbolMap.set(symbol, {\r\n            symbol,\r\n            pnl: 0,\r\n            volume: 0,\r\n            trades: 0,\r\n            winRate: 0,\r\n          });\r\n        }\r\n\r\n        const symbolData = symbolMap.get(symbol)!;\r\n        symbolData.pnl += pnl;\r\n        symbolData.volume += volume;\r\n        symbolData.trades += 1;\r\n      });\r\n\r\n      // Also count total trades per symbol (including those with PnL = 0) for volume\r\n      filteredTrades.forEach((trade: any) => {\r\n        const symbol = trade.symbol;\r\n        if (!symbolMap.has(symbol)) {\r\n          symbolMap.set(symbol, {\r\n            symbol,\r\n            pnl: 0,\r\n            volume: 0,\r\n            trades: 0,\r\n            winRate: 0,\r\n          });\r\n        }\r\n        const symbolData = symbolMap.get(symbol)!;\r\n        // Only add volume if not already added from tradesWithPnL\r\n        if (!tradesWithPnL.find((t: any) => t.id === trade.id)) {\r\n          const amount = parseFloat(trade.amount || trade.size || 0);\r\n          const price = parseFloat(trade.price || trade.entry_price || 0);\r\n          symbolData.volume += amount * price;\r\n        }\r\n        symbolData.trades += 1;\r\n      });\r\n\r\n      // Calculate win rate for each symbol (only from trades with actual PnL)\r\n      symbolMap.forEach((symbolData, symbol) => {\r\n        const symbolTradesWithPnL = tradesWithPnL.filter(\r\n          (t: any) => t.symbol === symbol\r\n        );\r\n        if (symbolTradesWithPnL.length > 0) {\r\n          const wins = symbolTradesWithPnL.filter(\r\n            (t: any) => (parseFloat(t.pnl) || 0) > 0\r\n          ).length;\r\n          symbolData.winRate = (wins / symbolTradesWithPnL.length) * 100;\r\n        }\r\n      });\r\n\r\n      const symbolRanking = Array.from(symbolMap.values())\r\n        .sort((a, b) => a.pnl - b.pnl) // Sort by P&L (ascending - worst to best)\r\n        .map((s) => ({\r\n          ...s,\r\n          pnl: parseFloat(s.pnl.toFixed(2)),\r\n          volume: parseFloat(s.volume.toFixed(2)),\r\n          winRate: parseFloat(s.winRate.toFixed(2)),\r\n        }));\r\n\r\n      // Calculate total days in range\r\n      const daysDiff = Math.ceil(\r\n        (end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24)\r\n      );\r\n\r\n      setMetrics({\r\n        overview: {\r\n          totalPnL: parseFloat(totalPnL.toFixed(2)),\r\n          tradingVolume: parseFloat(tradingVolume.toFixed(2)),\r\n          totalTrades: filteredTrades.length,\r\n          winRate: parseFloat(winRate.toFixed(2)),\r\n          avgWin: parseFloat(avgWin.toFixed(2)),\r\n          avgLoss: parseFloat(avgLoss.toFixed(2)),\r\n          profitableDays,\r\n          totalDays: daysDiff,\r\n        },\r\n        dailyPnL,\r\n        symbolRanking,\r\n      });\r\n    } catch (err: any) {\r\n      // Don't set error if request was aborted\r\n      if (err?.name === 'AbortError' || controller.signal.aborted) {\r\n        return;\r\n      }\r\n      console.error('Error fetching performance data:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to fetch performance data');\r\n    } finally {\r\n      if (!controller.signal.aborted) {\r\n        setLoading(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Only fetch if dates are valid\r\n    if (!startDate || !endDate || isNaN(startDate.getTime()) || isNaN(endDate.getTime())) {\r\n      return;\r\n    }\r\n\r\n    fetchPerformance();\r\n\r\n    // Cleanup: abort request on unmount or dependency change\r\n    return () => {\r\n      if (abortController) {\r\n        abortController.abort();\r\n      }\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [startDate?.getTime(), endDate?.getTime(), assetType]);\r\n\r\n  return {\r\n    metrics,\r\n    loading,\r\n    error,\r\n    refetch: fetchPerformance,\r\n  };\r\n}\r\n\r\n","import { useState, useMemo, useEffect, useCallback } from 'react';\nimport { supabase } from '../../lib/supabase';\nimport Header from '../../components/feature/Header';\nimport Navigation from '../../components/feature/Navigation';\nimport Card from '../../components/base/Card';\nimport PaperTradingPerformance from '../../components/paper/PaperTradingPerformance';\nimport { usePerformance } from '../../hooks/usePerformance';\n\nexport default function Performance() {\n  const [assetType, setAssetType] = useState<'all' | 'perpetuals' | 'spot'>('all');\n  const [selectedPeriod, setSelectedPeriod] = useState('7d');\n  const [selectedPair, setSelectedPair] = useState<string>('');\n  const [availablePairs, setAvailablePairs] = useState<string[]>([]);\n\n  const fetchPairs = useCallback(async () => {\n    try {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) {\n        setAvailablePairs([]);\n        setSelectedPair('');\n        return;\n      }\n\n      const { data: positions } = await supabase\n        .from('paper_trading_positions')\n        .select('symbol')\n        .eq('user_id', user.id)\n        .eq('status', 'open');\n\n      const uniquePairs = positions && positions.length > 0\n        ? [...new Set(positions.map(p => p.symbol))].sort()\n        : [];\n\n      setAvailablePairs(uniquePairs);\n      setSelectedPair(prev => {\n        if (uniquePairs.length === 0) {\n          return '';\n        }\n        if (prev === 'all') {\n          return 'all';\n        }\n        if (prev && uniquePairs.includes(prev)) {\n          return prev;\n        }\n        return '';\n      });\n    } catch (error) {\n      console.error('Error fetching pairs:', error);\n      setAvailablePairs([]);\n      setSelectedPair('');\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchPairs();\n  }, [fetchPairs]);\n\n  // Calculate date range based on selected period - memoized to prevent infinite loops\n  const dateRange = useMemo(() => {\n    const end = new Date();\n    let start = new Date();\n\n    switch (selectedPeriod) {\n      case '7d':\n        start = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n        break;\n      case '30d':\n        start = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);\n        break;\n      case '60d':\n        start = new Date(Date.now() - 60 * 24 * 60 * 60 * 1000);\n        break;\n      case '90d':\n        start = new Date(Date.now() - 90 * 24 * 60 * 60 * 1000);\n        break;\n      case '180d':\n        start = new Date(Date.now() - 180 * 24 * 60 * 60 * 1000);\n        break;\n      default:\n        start = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n    }\n\n    return { start, end };\n  }, [selectedPeriod]);\n\n  const { metrics, loading, error } = usePerformance(dateRange.start, dateRange.end, assetType);\n\n  const formatCurrency = (value: number) => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(value);\n  };\n\n  const formatVolume = (value: number) => {\n    if (value >= 1000000) {\n      return `${(value / 1000000).toFixed(2)}M`;\n    }\n    if (value >= 1000) {\n      return `${(value / 1000).toFixed(2)}K`;\n    }\n    return value.toFixed(2);\n  };\n\n  // Prepare chart data\n  const chartData = metrics?.dailyPnL || [];\n  const maxPnL = Math.max(...(chartData.map(d => Math.abs(d.pnl)) || [0]), 1);\n  const minPnL = Math.min(...(chartData.map(d => d.pnl) || [0]), 0);\n\n  // Get worst performing symbol (most negative P&L)\n  const worstSymbol = metrics?.symbolRanking?.[0] || null;\n  const bestSymbol = metrics?.symbolRanking?.[metrics?.symbolRanking.length - 1] || null;\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n        <Header title=\"Performance & P&L Analysis\" />\n        <div className=\"pt-20 pb-20 px-4\">\n          <div className=\"text-center py-12\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n            <p className=\"text-gray-600 dark:text-gray-400\">Loading performance data...</p>\n          </div>\n        </div>\n        <Navigation />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n        <Header title=\"Performance & P&L Analysis\" />\n        <div className=\"pt-20 pb-20 px-4\">\n          <Card className=\"p-6 text-center\">\n            <i className=\"ri-error-warning-line text-4xl text-red-500 mb-4\"></i>\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">Error Loading Data</h3>\n            <p className=\"text-gray-600 dark:text-gray-400\">{error}</p>\n          </Card>\n        </div>\n        <Navigation />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      <Header title=\"Performance & P&L Analysis\" />\n      \n      <div className=\"pt-20 pb-20 px-4 space-y-6\">\n        {/* Pair Selection */}\n        {availablePairs.length > 0 && (\n          <Card className=\"p-4\">\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n              Select Trading Pair\n            </label>\n            <select\n              value={selectedPair}\n              onChange={(e) => setSelectedPair(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            >\n              <option value=\"\">-- Select a Pair --</option>\n              <option value=\"all\">Select All</option>\n              {availablePairs.map((pair) => (\n                <option key={pair} value={pair}>\n                  {pair}\n                </option>\n              ))}\n            </select>\n            {selectedPair && (\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n                {selectedPair === 'all' \n                  ? `Showing report for all pairs (${availablePairs.length} pairs)`\n                  : (\n                    <>\n                      Showing report for <span className=\"font-semibold\">{selectedPair}</span>\n                    </>\n                  )\n                }\n              </p>\n            )}\n          </Card>\n        )}\n\n        {/* Paper Trading Performance - Show when a pair is selected or \"all\" is selected */}\n        {selectedPair ? (\n          <PaperTradingPerformance\n            selectedPair={selectedPair === 'all' ? '' : selectedPair}\n            onReset={fetchPairs}\n          />\n        ) : availablePairs.length > 0 ? (\n          <Card className=\"p-6 text-center\">\n            <i className=\"ri-search-line text-4xl text-gray-300 dark:text-gray-600 mb-4\"></i>\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n              Select a Trading Pair\n            </h3>\n            <p className=\"text-gray-500 dark:text-gray-400\">\n              Choose a pair from the dropdown above to view detailed performance report and open positions ({availablePairs.length} pairs available).\n            </p>\n          </Card>\n        ) : (\n          <PaperTradingPerformance\n            selectedPair={selectedPair}\n            onReset={fetchPairs}\n          />\n        )}\n\n        {/* Asset Type Tabs */}\n        <Card className=\"p-4\">\n          <div className=\"flex space-x-2 mb-4\">\n            {[\n              { key: 'all', label: 'All Assets' },\n              { key: 'perpetuals', label: 'Perpetuals & Futures' },\n              { key: 'spot', label: 'Spot' },\n            ].map(({ key, label }) => (\n              <button\n                key={key}\n                onClick={() => setAssetType(key as any)}\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${\n                  assetType === key\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\n                }`}\n              >\n                {label}\n              </button>\n            ))}\n          </div>\n\n          {/* Period Selection */}\n          <div className=\"flex space-x-2\">\n            {[\n              { key: '7d', label: 'Last 7 D' },\n              { key: '30d', label: 'Last 30 D' },\n              { key: '60d', label: 'Last 60 D' },\n              { key: '90d', label: 'Last 90 D' },\n              { key: '180d', label: 'Last 180 D' },\n            ].map(({ key, label }) => (\n              <button\n                key={key}\n                onClick={() => setSelectedPeriod(key)}\n                className={`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${\n                  selectedPeriod === key\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600'\n                }`}\n              >\n                {label}\n              </button>\n            ))}\n          </div>\n        </Card>\n\n        {/* Key Performance Indicators */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          <Card className=\"p-6\">\n            <div className=\"text-center\">\n              <div className={`text-3xl font-bold mb-2 ${\n                (metrics?.overview.totalPnL || 0) >= 0 \n                  ? 'text-green-600 dark:text-green-400' \n                  : 'text-red-600 dark:text-red-400'\n              }`}>\n                {formatCurrency(metrics?.overview.totalPnL || 0)}\n              </div>\n              <div className=\"text-sm text-gray-500 dark:text-gray-400\">Total P&L</div>\n            </div>\n          </Card>\n\n          <Card className=\"p-6\">\n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-blue-600 dark:text-blue-400 mb-2\">\n                +{formatVolume(metrics?.overview.tradingVolume || 0)}\n              </div>\n              <div className=\"text-sm text-gray-500 dark:text-gray-400\">Trading Volume</div>\n            </div>\n          </Card>\n        </div>\n\n        {/* P&L Chart */}\n        {chartData.length > 0 && (\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">P&L Chart</h3>\n            <div className=\"relative h-64 bg-gray-50 dark:bg-gray-800 rounded-lg p-4\">\n              <svg className=\"w-full h-full\" viewBox={`0 0 ${chartData.length * 40} 200`} preserveAspectRatio=\"none\">\n                {/* X-axis */}\n                <line\n                  x1=\"0\"\n                  y1=\"100\"\n                  x2={chartData.length * 40}\n                  y2=\"100\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"1\"\n                  className=\"text-gray-300 dark:text-gray-600\"\n                />\n                \n                {/* P&L Line */}\n                <polyline\n                  points={chartData\n                    .map((d, i) => {\n                      const x = i * 40 + 20;\n                      // Scale P&L to fit chart (100 is center/zero line)\n                      const y = 100 - (d.pnl / maxPnL) * 80;\n                      return `${x},${y}`;\n                    })\n                    .join(' ')}\n                  fill=\"none\"\n                  stroke={metrics?.overview.totalPnL >= 0 ? '#10b981' : '#ef4444'}\n                  strokeWidth=\"2\"\n                  className=\"dark:opacity-80\"\n                />\n                \n                {/* Area under curve */}\n                {chartData.map((d, i) => {\n                  const x = i * 40 + 20;\n                  const y = 100 - (d.pnl / maxPnL) * 80;\n                  const height = 100 - y;\n                  return (\n                    <rect\n                      key={i}\n                      x={x - 15}\n                      y={y}\n                      width=\"30\"\n                      height={height}\n                      fill={d.pnl >= 0 ? 'rgba(16, 185, 129, 0.2)' : 'rgba(239, 68, 68, 0.2)'}\n                      className=\"dark:opacity-50\"\n                    />\n                  );\n                })}\n              </svg>\n              \n              {/* Date labels (show first, middle, last) */}\n              <div className=\"absolute bottom-2 left-0 right-0 flex justify-between px-4 text-xs text-gray-500 dark:text-gray-400\">\n                <span>{new Date(chartData[0]?.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>\n                {chartData.length > 1 && (\n                  <span>{new Date(chartData[Math.floor(chartData.length / 2)]?.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>\n                )}\n                {chartData.length > 2 && (\n                  <span>{new Date(chartData[chartData.length - 1]?.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>\n                )}\n              </div>\n            </div>\n              <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-2 text-right\">\n              Data as of {dateRange.end.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })} (UTC)\n            </div>\n          </Card>\n        )}\n\n        {/* P&L Ranking by Symbol */}\n        {metrics?.symbolRanking && metrics.symbolRanking.length > 0 && (\n          <Card className=\"p-6\">\n            <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">P&L Ranking</h3>\n            <div className=\"space-y-3\">\n              {metrics.symbolRanking.map((symbol, index) => {\n                const maxLoss = Math.min(...metrics.symbolRanking.map(s => s.pnl));\n                const barWidth = Math.abs(symbol.pnl / maxLoss) * 100;\n                const isPositive = symbol.pnl >= 0;\n                \n                return (\n                  <div key={symbol.symbol} className=\"space-y-1\">\n                    <div className=\"flex items-center justify-between text-sm\">\n                      <span className=\"font-medium text-gray-900 dark:text-white\">{symbol.symbol}</span>\n                      <span className={`font-medium ${\n                        isPositive \n                          ? 'text-green-600 dark:text-green-400' \n                          : 'text-red-600 dark:text-red-400'\n                      }`}>\n                        {formatCurrency(symbol.pnl)}\n                      </span>\n                    </div>\n                    <div className=\"relative h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden\">\n                      <div\n                        className={`absolute left-0 top-0 h-full ${\n                          isPositive \n                            ? 'bg-green-500 dark:bg-green-400' \n                            : 'bg-red-500 dark:bg-red-400'\n                        }`}\n                        style={{ width: `${Math.min(barWidth, 100)}%` }}\n                      />\n                    </div>\n                    <div className=\"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400\">\n                      <span>Volume: {formatCurrency(symbol.volume)}</span>\n                      <span>Trades: {symbol.trades} | WR: {symbol.winRate.toFixed(1)}%</span>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </Card>\n        )}\n\n        {/* Additional Stats */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          <Card className=\"p-4\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-gray-900 dark:text-white mb-1\">\n                {metrics?.overview.totalTrades || 0}\n              </div>\n              <div className=\"text-xs text-gray-500 dark:text-gray-400\">Total Trades</div>\n            </div>\n          </Card>\n\n          <Card className=\"p-4\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-gray-900 dark:text-white mb-1\">\n                {metrics?.overview.winRate.toFixed(1) || '0.0'}%\n              </div>\n              <div className=\"text-xs text-gray-500 dark:text-gray-400\">Win Rate</div>\n            </div>\n          </Card>\n\n          <Card className=\"p-4\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-green-600 dark:text-green-400 mb-1\">\n                {formatCurrency(metrics?.overview.avgWin || 0)}\n              </div>\n              <div className=\"text-xs text-gray-500 dark:text-gray-400\">Avg Win</div>\n            </div>\n          </Card>\n\n          <Card className=\"p-4\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-red-600 dark:text-red-400 mb-1\">\n                {formatCurrency(metrics?.overview.avgLoss || 0)}\n              </div>\n              <div className=\"text-xs text-gray-500 dark:text-gray-400\">Avg Loss</div>\n            </div>\n          </Card>\n        </div>\n\n        {/* Empty State */}\n        {(!metrics || metrics.overview.totalTrades === 0) && (\n          <Card className=\"p-8 text-center\">\n            <i className=\"ri-line-chart-line text-4xl text-gray-300 dark:text-gray-600 mb-4\"></i>\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">No Performance Data</h3>\n            <p className=\"text-gray-500 dark:text-gray-400\">\n              Start trading to see your performance metrics here.\n            </p>\n          </Card>\n        )}\n      </div>\n\n      <Navigation />\n    </div>\n  );\n}\n\n"],"names":["usePerformance","startDate","endDate","assetType","loading","setLoading","useState","error","setError","metrics","setMetrics","abortController","setAbortController","fetchPerformance","controller","end","start","query","supabase","trades","tradesError","filteredTrades","tradingType","t","_a","firstTrade","statuses","sides","hasExitPrices","closedTrades","symbolGroups","symbol","processedTradesMap","a","b","dateA","dateB","buys","sells","side","buyIndex","sell","buy","buyPrice","sellPrice","buySize","sellSize","matchedSize","pnl","existing","processedTrades","entryPrice","exitPrice","size","fee","reason","calculatedPnL","tradesWithPnL","winningTrades","losingTrades","totalPnL","sum","tradingVolume","amount","price","winRate","avgWin","avgLoss","dailyPnLMap","trade","tradeDate","date","daily","volume","dailyPnL","day","profitableDays","symbolMap","symbolData","symbolTradesWithPnL","wins","symbolRanking","s","daysDiff","err","useEffect","Performance","setAssetType","selectedPeriod","setSelectedPeriod","selectedPair","setSelectedPair","availablePairs","setAvailablePairs","fetchPairs","useCallback","user","positions","uniquePairs","p","prev","dateRange","useMemo","formatCurrency","value","formatVolume","chartData","maxPnL","d","_b","jsxs","jsx","Header","Navigation","Card","e","pair","Fragment","PaperTradingPerformance","key","label","i","x","y","height","_c","_d","_e","index","maxLoss","barWidth","isPositive"],"mappings":"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"}