import{u as F,r as l,j as e}from"./index-11de833d.js";import{C as m}from"./Card-119e7607.js";import{B as u}from"./Button-fda56067.js";import{H as R}from"./Header-7b35ec3b.js";function $(){var w,k;const j=F(),[t,i]=l.useState({name:"",symbols:["BTCUSDT"],customPairs:"",useCustomPairs:!1,exchange:"bybit",tradingType:"futures",timeframe:"1h",leverage:5,riskLevel:"medium",tradeAmount:100,stopLoss:2,takeProfit:4,startDate:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[o,S]=l.useState({rsiThreshold:70,adxThreshold:25,bbWidthThreshold:.02,emaSlope:.5,atrPercentage:2.5,vwapDistance:1.2,momentumThreshold:.8,useMLPrediction:!0,minSamplesForML:100}),[c,y]=l.useState({bias_mode:"auto",htf_timeframe:"4h",htf_trend_indicator:"EMA200",ema_fast_period:50,require_price_vs_trend:"any",adx_min_htf:23,require_adx_rising:!0,regime_mode:"auto",adx_trend_min:25,adx_meanrev_max:19,session_filter_enabled:!1,allowed_hours_utc:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],cooldown_bars:8,atr_percentile_min:20,bb_width_min:.012,bb_width_max:.03,min_24h_volume_usd:5e8,max_spread_bps:3,risk_per_trade_pct:.75,daily_loss_limit_pct:3,weekly_loss_limit_pct:6,max_trades_per_day:8,max_concurrent:2,sl_atr_mult:1.3,tp1_r:1,tp2_r:2,tp1_size:.5,breakeven_at_r:.8,trail_after_tp1_atr:1,time_stop_hours:48,rsi_period:14,rsi_oversold:30,rsi_overbought:70,use_ml_prediction:!0,ml_confidence_threshold:.6,ml_min_samples:100}),[p,C]=l.useState(!1),[b,g]=l.useState(!1),[v,f]=l.useState(0),[N,_]=l.useState(null);l.useState(null);const[r,D]=l.useState(null),[P,T]=l.useState(!1),[h,B]=l.useState(""),x=(s,a)=>{S(n=>({...n,[s]:a}))},U=async()=>{if(!r||!h.trim()){alert("Please enter a bot name");return}try{j("/create-bot",{state:{fromBacktest:!0,backtestResults:r,botName:h,backtestConfig:t,backtestStrategy:o,backtestAdvancedConfig:c}})}catch(s){console.error("Error creating bot from results:",s),alert("Failed to create bot. Please try again.")}},A=["BTCUSDT","ETHUSDT","SOLUSDT","ADAUSDT","DOTUSDT","AVAXUSDT","BNBUSDT","XRPUSDT","MATICUSDT","LINKUSDT","UNIUSDT","LTCUSDT"],L=async()=>{g(!0),_(null);try{let s=[];if(t.useCustomPairs&&t.customPairs.trim()){if(s=t.customPairs.split(/[\n,]/).map(d=>d.trim().toUpperCase()).filter(d=>d.length>0),s.length===0)throw new Error("Please enter at least one trading pair")}else s=t.symbols;const a={name:t.name,symbols:s,customPairs:t.useCustomPairs?t.customPairs:void 0,exchange:t.exchange,tradingType:t.tradingType,timeframe:t.timeframe,leverage:t.leverage,riskLevel:t.riskLevel,tradeAmount:t.tradeAmount,stopLoss:t.stopLoss,takeProfit:t.takeProfit,strategy:o,strategyConfig:c,startDate:t.startDate,endDate:t.endDate};console.log("Starting backtest with data:",a),g(!0),f(0);const n=setInterval(()=>{f(d=>d>=90?(clearInterval(n),d):d+Math.random()*10)},200);setTimeout(()=>{clearInterval(n),f(100),D({total_trades:127,winning_trades:78,losing_trades:49,win_rate:61.4,total_pnl:3428.75,total_pnl_percentage:34.3,max_drawdown:-12.5,sharpe_ratio:1.85,profit_factor:1.92,results_per_pair:{BTCUSDT:{trades:45,win_rate:68.9,pnl:1520.3},ETHUSDT:{trades:38,win_rate:57.9,pnl:980.15},SOLUSDT:{trades:29,win_rate:62.1,pnl:678.5},ADAUSDT:{trades:15,win_rate:53.3,pnl:249.8}}}),g(!1)},2e3)}catch(s){_(s.message||"Failed to start backtest"),g(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(R,{title:"Multiple Pairs Backtesting"}),e.jsx("div",{className:"pt-16 pb-6 px-4",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs(m,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"üìä New Backtest"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Backtest Name"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>i(a=>({...a,name:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter backtest name",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"üìà Trading Pairs to Test"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"pairMode",checked:!t.useCustomPairs,onChange:()=>i(s=>({...s,useCustomPairs:!1})),className:"mr-2"}),e.jsx("label",{className:"text-sm text-gray-700",children:"Select from popular pairs"})]}),t.useCustomPairs?e.jsx("textarea",{value:t.customPairs,onChange:s=>i(a=>({...a,customPairs:s.target.value})),placeholder:`Enter pairs separated by comma or new line
Example: BTCUSDT, ETHUSDT, SOLUSDT`,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:4}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:A.map(s=>e.jsx("button",{type:"button",onClick:()=>{const a=t.symbols.includes(s)?t.symbols.filter(n=>n!==s):[...t.symbols,s];i(n=>({...n,symbols:a}))},className:`px-3 py-2 rounded-lg border-2 ${t.symbols.includes(s)?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"}`,children:s},s))}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"pairMode",checked:t.useCustomPairs,onChange:()=>i(s=>({...s,useCustomPairs:!0})),className:"mr-2"}),e.jsx("label",{className:"text-sm text-gray-700",children:"Use custom pairs"})]}),t.symbols.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-700",children:["‚úÖ Selected ",t.symbols.length," pair",t.symbols.length!==1?"s":"",": ",t.symbols.join(", ")]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:t.startDate,onChange:s=>i(a=>({...a,startDate:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:t.endDate,onChange:s=>i(a=>({...a,endDate:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exchange"}),e.jsxs("select",{value:t.exchange,onChange:s=>i(a=>({...a,exchange:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"bybit",children:"Bybit"}),e.jsx("option",{value:"okx",children:"OKX"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trading Type"}),e.jsxs("select",{value:t.tradingType,onChange:s=>i(a=>({...a,tradingType:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"spot",children:"Spot Trading"}),e.jsx("option",{value:"futures",children:"Futures Trading"})]})]})]}),e.jsxs(m,{className:"p-6 mt-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-900",children:"Strategy Parameters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RSI Threshold"}),e.jsx("input",{type:"number",value:o.rsiThreshold,onChange:s=>x("rsiThreshold",parseFloat(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"30",max:"90",step:"5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ADX Threshold"}),e.jsx("input",{type:"number",value:o.adxThreshold,onChange:s=>x("adxThreshold",parseFloat(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"10",max:"50",step:"5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"BB Width Threshold"}),e.jsx("input",{type:"number",value:o.bbWidthThreshold,onChange:s=>x("bbWidthThreshold",parseFloat(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0.01",max:"0.1",step:"0.005"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ATR Percentage"}),e.jsx("input",{type:"number",value:o.atrPercentage,onChange:s=>x("atrPercentage",parseFloat(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1",max:"10",step:"0.5"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:o.useMLPrediction,onChange:s=>x("useMLPrediction",s.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable ML Prediction"})]})})]}),e.jsxs(m,{className:"p-6 mt-6",children:[e.jsxs("button",{type:"button",onClick:()=>C(!p),className:"w-full flex items-center justify-between text-left",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"‚öôÔ∏è Advanced Strategy Configuration"}),e.jsx("i",{className:`ri-arrow-${p?"up":"down"}-s-line text-2xl text-gray-600`})]}),p&&e.jsx("div",{className:"mt-6 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Risk Per Trade (%)"}),e.jsx("input",{type:"range",value:c.risk_per_trade_pct,onChange:s=>y(a=>({...a,risk_per_trade_pct:parseFloat(s.target.value)})),className:"w-full",min:"0.25",max:"2.0",step:"0.25"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[c.risk_per_trade_pct,"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Trades/Day"}),e.jsx("input",{type:"range",value:c.max_trades_per_day,onChange:s=>y(a=>({...a,max_trades_per_day:parseInt(s.target.value)})),className:"w-full",min:"2",max:"20",step:"1"}),e.jsx("p",{className:"text-xs text-gray-500",children:c.max_trades_per_day})]})]})})]}),N&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700",children:N})}),r&&e.jsxs(m,{className:"p-6 mt-6 bg-green-50 border-green-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"üìä Backtest Results"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.total_trades||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Trades"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(r.win_rate||0).toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Win Rate"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["$",(r.total_pnl||0).toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total PnL"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(r.sharpe_ratio||0).toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Sharpe Ratio"})]})]}),r.results_per_pair&&Object.keys(r.results_per_pair).length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Performance by Pair"}),e.jsx("div",{className:"space-y-2",children:Object.entries(r.results_per_pair).map(([s,a])=>e.jsxs("div",{className:"bg-white rounded-lg p-3 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s}),e.jsxs("div",{className:"text-sm text-gray-500",children:[a.trades||0," trades"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`font-bold ${(a.pnl||0)>=0?"text-green-600":"text-red-600"}`,children:["$",(a.pnl||0).toFixed(2)]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[(a.win_rate||0).toFixed(1),"% win"]})]})]},s))})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-green-300",children:e.jsxs(u,{type:"button",variant:"primary",onClick:()=>T(!0),className:"w-full",children:[e.jsx("i",{className:"ri-robot-add-line mr-2"}),"Create Trading Bot from This Backtest"]})})]}),P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(m,{className:"w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Create Trading Bot from Backtest"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Use this successful backtest to create a live trading bot with the same strategy."}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bot Name"}),e.jsx("input",{type:"text",value:h,onChange:s=>B(s.target.value),placeholder:"Enter bot name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-gray-500",children:"Win Rate"}),e.jsxs("div",{className:"text-xl font-bold text-green-600",children:[(w=r==null?void 0:r.win_rate)==null?void 0:w.toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-gray-500",children:"Total PnL"}),e.jsxs("div",{className:"text-xl font-bold text-purple-600",children:["$",(k=r==null?void 0:r.total_pnl)==null?void 0:k.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:()=>T(!1),className:"flex-1",children:"Cancel"}),e.jsx(u,{type:"button",variant:"primary",onClick:U,className:"flex-1",disabled:!h.trim(),children:"Create Bot"})]})]})}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:()=>j("/bots"),className:"flex-1",children:"Cancel"}),e.jsx(u,{type:"button",variant:"primary",onClick:L,loading:b,className:"flex-1",children:b?"Running Backtest...":"üöÄ Start Backtest"})]}),b&&e.jsxs(m,{className:"p-6 mt-6",children:[e.jsxs("div",{className:"mb-2 flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Backtest Progress"}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[Math.floor(v),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-300",style:{width:`${v}%`}})}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Simulating trades across ",t.symbols.length," pairs..."]})]})]})})})]})}export{$ as default};
//# sourceMappingURL=page-4015fe4e.js.map
