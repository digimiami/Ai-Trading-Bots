{"version":3,"file":"PaperTradingPerformance-4126e13f.js","sources":["../../src/components/paper/PaperTradingPerformance.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { supabase, API_ENDPOINTS, apiCall } from '../../lib/supabase';\nimport Card from '../base/Card';\nimport Button from '../base/Button';\n\ninterface PaperPosition {\n  id: string;\n  symbol: string;\n  side: 'long' | 'short';\n  entry_price: number;\n  current_price: number;\n  quantity: number;\n  leverage: number;\n  unrealized_pnl: number;\n  margin_used: number;\n  status: string;\n  opened_at: string;\n}\n\ninterface PairPerformance {\n  symbol: string;\n  totalTrades: number;\n  winningTrades: number;\n  losingTrades: number;\n  winRate: number;\n  totalPnL: number;\n  totalFees: number;\n  totalVolume: number;\n  averageWin: number;\n  averageLoss: number;\n  profitFactor: number;\n  openPositions: number;\n  unrealizedPnL: number;\n  runningHours: number;\n  botNames: string[];\n}\n\ninterface PaperPerformance {\n  totalTrades: number;\n  winningTrades: number;\n  losingTrades: number;\n  winRate: number;\n  totalPnL: number;\n  totalPnLBeforeFees: number;\n  totalFees: number;\n  totalPnLPercentage: number;\n  averageWin: number;\n  averageLoss: number;\n  profitFactor: number;\n  maxDrawdown: number;\n  currentBalance: number;\n  initialBalance: number;\n  openPositions: number;\n  totalVolume: number;\n  pairsPerformance: PairPerformance[];\n}\n\ninterface PaperTradingPerformanceProps {\n  selectedPair?: string;\n  onReset?: () => Promise<void> | void;\n}\n\nexport default function PaperTradingPerformance({ selectedPair = '', onReset }: PaperTradingPerformanceProps) {\n  const [performance, setPerformance] = useState<PaperPerformance | null>(null);\n  const [positions, setPositions] = useState<PaperPosition[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [resetting, setResetting] = useState(false);\n\n  const ensureAccountExists = async () => {\n    const { data: { session } } = await supabase.auth.getSession();\n    if (!session) return null;\n\n    const response = await fetch(`${import.meta.env.VITE_PUBLIC_SUPABASE_URL}/functions/v1/paper-trading`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${session.access_token}`,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({ action: 'get_balance' })\n    });\n\n    if (!response.ok) {\n      const err = await response.json().catch(() => ({}));\n      console.error('Failed to ensure paper account exists:', err?.error || response.statusText);\n      return null;\n    }\n\n    const result = await response.json().catch(() => null);\n    return result?.account ?? null;\n  };\n\n  const fetchPerformance = async () => {\n    try {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) return;\n\n      // Get account balance\n      const { data: account } = await supabase\n        .from('paper_trading_accounts')\n        .select('*')\n        .eq('user_id', user.id)\n        .single();\n\n      // Get all closed trades - filter by selected pair if provided\n      let tradesQuery = supabase\n        .from('paper_trading_trades')\n        .select('*')\n        .eq('user_id', user.id)\n        .eq('status', 'closed')\n        .order('closed_at', { ascending: false });\n      \n      if (selectedPair) {\n        tradesQuery = tradesQuery.eq('symbol', selectedPair);\n      }\n      \n      const { data: trades } = await tradesQuery;\n\n      // Get open positions - filter by selected pair if provided\n      let openPositionsQuery = supabase\n        .from('paper_trading_positions')\n        .select('*')\n        .eq('user_id', user.id)\n        .eq('status', 'open')\n        .order('opened_at', { ascending: false });\n      \n      if (selectedPair) {\n        openPositionsQuery = openPositionsQuery.eq('symbol', selectedPair);\n      }\n      \n      const { data: openPositions } = await openPositionsQuery;\n\n      // Fetch bot names for all bot_ids found in trades and positions\n      const botIds = new Set<string>();\n      if (trades) {\n        trades.forEach((trade: any) => {\n          if (trade.bot_id) botIds.add(trade.bot_id);\n        });\n      }\n      if (openPositions) {\n        openPositions.forEach((position: any) => {\n          if (position.bot_id) botIds.add(position.bot_id);\n        });\n      }\n\n      // Fetch bot names\n      const botNamesMap = new Map<string, string>();\n      if (botIds.size > 0) {\n        const { data: bots } = await supabase\n          .from('trading_bots')\n          .select('id, name')\n          .in('id', Array.from(botIds));\n        \n        if (bots) {\n          bots.forEach((bot: any) => {\n            botNamesMap.set(bot.id, bot.name || 'Unknown Bot');\n          });\n        }\n      }\n\n      const accountData = account || (await ensureAccountExists());\n\n      // Helper to normalize numeric fields (Supabase returns numerics as strings)\n      const normalizePosition = (raw: any, overrides: Partial<PaperPosition> = {}): PaperPosition => {\n        const toNumber = (value: any, fallback = 0) => {\n          const parsed = typeof value === 'number' ? value : parseFloat(value ?? '');\n          return Number.isFinite(parsed) ? parsed : fallback;\n        };\n\n        const entryPrice = toNumber(raw.entry_price);\n        const quantity = toNumber(raw.quantity);\n        const leverage = toNumber(raw.leverage, 1);\n        const marginUsed = toNumber(raw.margin_used);\n        const currentPrice = overrides.current_price !== undefined\n          ? overrides.current_price\n          : toNumber(raw.current_price, entryPrice);\n        const unrealizedPnL = overrides.unrealized_pnl !== undefined\n          ? overrides.unrealized_pnl\n          : toNumber(raw.unrealized_pnl);\n        const side = (raw.side || 'long').toString().toLowerCase() === 'short' ? 'short' : 'long';\n        const normalized: PaperPosition = {\n          id: raw.id,\n          symbol: raw.symbol || 'UNKNOWN',\n          side,\n          entry_price: entryPrice,\n          current_price: currentPrice,\n          quantity,\n          leverage,\n          unrealized_pnl: unrealizedPnL,\n          margin_used: marginUsed,\n          status: raw.status || 'open',\n          opened_at: raw.opened_at || raw.created_at || new Date().toISOString()\n        };\n        return normalized;\n      };\n\n      // Fetch current prices for open positions\n      let positionsWithPrices: PaperPosition[] = [];\n      if (openPositions && openPositions.length > 0) {\n        positionsWithPrices = await Promise.all(\n          openPositions.map(async (position: any) => {\n            try {\n              // Fetch current price from market data via Supabase Edge Function\n              const symbol = position.symbol;\n\n              // Use bot-executor edge function to get current price (avoids CORS)\n              try {\n                const marketData = await apiCall(\n                  `${API_ENDPOINTS.BOT_EXECUTOR}?action=market-data&symbol=${symbol}&exchange=bybit`\n                );\n                \n                const currentPrice = marketData?.price || 0;\n                \n                if (currentPrice > 0) {\n                  // Calculate unrealized PnL\n                  const entryPrice = parseFloat(position.entry_price ?? '') || 0;\n                  const leverage = parseFloat(position.leverage ?? '1') || 1;\n                  const marginUsed = parseFloat(position.margin_used ?? '') || 0;\n                  \n                  let unrealizedPnL = 0;\n                  if (entryPrice > 0 && marginUsed !== 0) {\n                    if ((position.side || '').toLowerCase() === 'long') {\n                    unrealizedPnL = ((currentPrice - entryPrice) / entryPrice) * marginUsed * leverage;\n                  } else {\n                    unrealizedPnL = ((entryPrice - currentPrice) / entryPrice) * marginUsed * leverage;\n                    }\n                  }\n                  \n                  return normalizePosition(position, {\n                    current_price: currentPrice,\n                    unrealized_pnl: unrealizedPnL\n                  });\n                }\n              } catch (apiError) {\n                console.error(`Error fetching price for ${position.symbol} via API:`, apiError);\n                // Fallback handled below\n              }\n            } catch (error) {\n              console.error(`Error fetching price for ${position.symbol}:`, error);\n            }\n            \n            return normalizePosition(position);\n          })\n        );\n        \n        setPositions(positionsWithPrices);\n      } else {\n        setPositions([]);\n      }\n\n      // Calculate performance metrics\n      if (trades && trades.length > 0) {\n        const winningTrades = trades.filter(t => (t.pnl || 0) > 0);\n        const losingTrades = trades.filter(t => (t.pnl || 0) < 0);\n        \n        // Calculate fees (fees are already deducted from PnL in paper trading)\n        const totalFees = trades.reduce((sum, t) => sum + (t.fees || 0), 0);\n        const totalPnL = trades.reduce((sum, t) => sum + (t.pnl || 0), 0);\n        // PnL before fees (PnL already includes fees deduction, so we add fees back)\n        const totalPnLBeforeFees = totalPnL + totalFees;\n        \n        // Calculate total volume\n        const totalVolume = trades.reduce((sum, t) => {\n          const orderValue = parseFloat(t.quantity || 0) * parseFloat(t.price || 0);\n          return sum + orderValue;\n        }, 0);\n        \n        const totalWins = winningTrades.reduce((sum, t) => sum + (t.pnl || 0), 0);\n        const totalLosses = Math.abs(losingTrades.reduce((sum, t) => sum + (t.pnl || 0), 0));\n        \n        const initialBalance = accountData?.initial_balance || account?.initial_balance || 10000;\n        const winRate = trades.length > 0 ? (winningTrades.length / trades.length) * 100 : 0;\n        const averageWin = winningTrades.length > 0 ? totalWins / winningTrades.length : 0;\n        const averageLoss = losingTrades.length > 0 ? totalLosses / losingTrades.length : 0;\n        const profitFactor = totalLosses > 0 ? totalWins / totalLosses : totalWins > 0 ? 999 : 0;\n\n        // Calculate max drawdown (simplified)\n        let runningBalance = initialBalance;\n        let maxBalance = initialBalance;\n        let maxDrawdown = 0;\n        \n        for (const trade of trades.sort((a, b) => \n          new Date(a.closed_at || a.executed_at).getTime() - \n          new Date(b.closed_at || b.executed_at).getTime()\n        )) {\n          runningBalance += trade.pnl || 0;\n          if (runningBalance > maxBalance) {\n            maxBalance = runningBalance;\n          }\n          const drawdown = ((maxBalance - runningBalance) / maxBalance) * 100;\n          if (drawdown > maxDrawdown) {\n            maxDrawdown = drawdown;\n          }\n        }\n\n        // Calculate total unrealized PnL from open positions\n        let totalUnrealizedPnL = 0;\n        let totalMarginUsed = 0;\n        if (positionsWithPrices && positionsWithPrices.length > 0) {\n          positionsWithPrices.forEach((position) => {\n            totalUnrealizedPnL += position.unrealized_pnl || 0;\n            totalMarginUsed += position.margin_used || 0;\n          });\n        }\n        \n        // Calculate current balance correctly:\n        // Initial Balance + Total Deposited + Total Realized PnL + Total Unrealized PnL\n        // Note: Margin is already deducted from balance when position opens, so we only add unrealized PnL\n        const realizedPnL = totalPnL; // Total PnL from closed trades\n        const calculatedCurrentBalance = initialBalance + \n          parseFloat((accountData?.total_deposited ?? account?.total_deposited) || 0) + \n          realizedPnL + \n          totalUnrealizedPnL;\n        \n        // Calculate performance by pair\n        const pairsMap = new Map<string, PairPerformance>();\n        \n        // Process closed trades by symbol\n        trades.forEach((trade: any) => {\n          const symbol = trade.symbol || 'UNKNOWN';\n          if (!pairsMap.has(symbol)) {\n            pairsMap.set(symbol, {\n              symbol: symbol,\n              totalTrades: 0,\n              winningTrades: 0,\n              losingTrades: 0,\n              winRate: 0,\n              totalPnL: 0,\n              totalFees: 0,\n              totalVolume: 0,\n              averageWin: 0,\n              averageLoss: 0,\n              profitFactor: 0,\n              openPositions: 0,\n              unrealizedPnL: 0,\n              runningHours: 0,\n              botNames: []\n            });\n          }\n          \n          const pairPerf = pairsMap.get(symbol)!;\n          pairPerf.totalTrades++;\n          pairPerf.totalPnL += trade.pnl || 0;\n          pairPerf.totalFees += trade.fees || 0;\n          pairPerf.totalVolume += parseFloat(trade.quantity || 0) * parseFloat(trade.price || 0);\n          \n          // Add bot name if available\n          if (trade.bot_id && botNamesMap.has(trade.bot_id)) {\n            const botName = botNamesMap.get(trade.bot_id)!;\n            if (!pairPerf.botNames.includes(botName)) {\n              pairPerf.botNames.push(botName);\n            }\n          }\n          \n          if ((trade.pnl || 0) > 0) {\n            pairPerf.winningTrades++;\n          } else if ((trade.pnl || 0) < 0) {\n            pairPerf.losingTrades++;\n          }\n        });\n        \n        // Process open positions by symbol\n        if (openPositions && positionsWithPrices) {\n          openPositions.forEach((position: any) => {\n            const symbol = position.symbol || 'UNKNOWN';\n            if (!pairsMap.has(symbol)) {\n            pairsMap.set(symbol, {\n              symbol: symbol,\n              totalTrades: 0,\n              winningTrades: 0,\n              losingTrades: 0,\n              winRate: 0,\n              totalPnL: 0,\n              totalFees: 0,\n              totalVolume: 0,\n              averageWin: 0,\n              averageLoss: 0,\n              profitFactor: 0,\n              openPositions: 0,\n              unrealizedPnL: 0,\n              runningHours: 0,\n              botNames: []\n            });\n            }\n            \n            const pairPerf = pairsMap.get(symbol)!;\n            pairPerf.openPositions++;\n            \n            // Add bot name if available\n            if (position.bot_id && botNamesMap.has(position.bot_id)) {\n              const botName = botNamesMap.get(position.bot_id)!;\n              if (!pairPerf.botNames.includes(botName)) {\n                pairPerf.botNames.push(botName);\n              }\n            }\n            \n            // Get unrealized PnL from positionsWithPrices\n            const positionWithPrice = positionsWithPrices.find((p) => p.id === position.id);\n            if (positionWithPrice) {\n              pairPerf.unrealizedPnL += positionWithPrice.unrealized_pnl || 0;\n            } else {\n              // Fallback to stored unrealized_pnl\n              pairPerf.unrealizedPnL += parseFloat(position.unrealized_pnl || 0);\n            }\n          });\n        }\n        \n        // Calculate final metrics for each pair\n        const pairsPerformance: PairPerformance[] = Array.from(pairsMap.values()).map((pair) => {\n          const pairTrades = trades.filter((t: any) => (t.symbol || 'UNKNOWN') === pair.symbol);\n          const pairWinningTrades = pairTrades.filter((t: any) => (t.pnl || 0) > 0);\n          const pairLosingTrades = pairTrades.filter((t: any) => (t.pnl || 0) < 0);\n          \n          const pairTotalWins = pairWinningTrades.reduce((sum, t) => sum + (t.pnl || 0), 0);\n          const pairTotalLosses = Math.abs(pairLosingTrades.reduce((sum, t) => sum + (t.pnl || 0), 0));\n          \n          // Calculate running hours for this pair\n          // Find earliest trade or position date\n          const pairOpenPositions = openPositions?.filter((p: any) => (p.symbol || 'UNKNOWN') === pair.symbol) || [];\n          \n          let earliestTimestamp: number | null = null;\n          let latestTimestamp: number | null = null;\n          \n          // Check trades\n          if (pairTrades.length > 0) {\n            const tradeDates = pairTrades.map((t: any) => new Date(t.executed_at || t.closed_at || t.created_at)).filter(d => !isNaN(d.getTime()));\n            if (tradeDates.length > 0) {\n              const earliestTradeTime = Math.min(...tradeDates.map(d => d.getTime()));\n              const latestTradeTime = Math.max(...tradeDates.map(d => d.getTime()));\n              const earliestCurrent = earliestTimestamp ?? Number.POSITIVE_INFINITY;\n              const latestCurrent = latestTimestamp ?? Number.NEGATIVE_INFINITY;\n              if (earliestTradeTime < earliestCurrent) earliestTimestamp = earliestTradeTime;\n              if (latestTradeTime > latestCurrent) latestTimestamp = latestTradeTime;\n            }\n          }\n          \n          // Check open positions\n          if (pairOpenPositions.length > 0) {\n            const positionDates = pairOpenPositions.map((p: any) => new Date(p.opened_at || p.created_at)).filter(d => !isNaN(d.getTime()));\n            if (positionDates.length > 0) {\n              const earliestPositionTime = Math.min(...positionDates.map(d => d.getTime()));\n              const earliestPositionCurrent = earliestTimestamp ?? Number.POSITIVE_INFINITY;\n              if (earliestPositionTime < earliestPositionCurrent) earliestTimestamp = earliestPositionTime;\n              // For open positions, use current time as latest\n              latestTimestamp = Date.now();\n            }\n          }\n          \n          // Calculate running hours\n          let runningHours = 0;\n          if (earliestTimestamp !== null && latestTimestamp !== null) {\n            const diffMs = latestTimestamp - earliestTimestamp;\n            runningHours = diffMs / (1000 * 60 * 60); // Convert to hours\n          }\n          \n          return {\n            ...pair,\n            winRate: pair.totalTrades > 0 ? (pair.winningTrades / pair.totalTrades) * 100 : 0,\n            averageWin: pair.winningTrades > 0 ? pairTotalWins / pair.winningTrades : 0,\n            averageLoss: pair.losingTrades > 0 ? pairTotalLosses / pair.losingTrades : 0,\n            profitFactor: pairTotalLosses > 0 ? pairTotalWins / pairTotalLosses : pairTotalWins > 0 ? 999 : 0,\n            runningHours: runningHours\n          };\n        }).sort((a, b) => {\n          // Sort by total PnL (realized + unrealized) descending\n          const aTotal = a.totalPnL + a.unrealizedPnL;\n          const bTotal = b.totalPnL + b.unrealizedPnL;\n          return bTotal - aTotal;\n        });\n\n        setPerformance({\n          totalTrades: trades.length,\n          winningTrades: winningTrades.length,\n          losingTrades: losingTrades.length,\n          winRate: winRate,\n          totalPnL: totalPnL,\n          totalPnLBeforeFees: totalPnLBeforeFees,\n          totalFees: totalFees,\n          totalPnLPercentage: (totalPnL / initialBalance) * 100,\n          averageWin: averageWin,\n          averageLoss: averageLoss,\n          profitFactor: profitFactor,\n          maxDrawdown: maxDrawdown,\n          currentBalance: calculatedCurrentBalance, // Use calculated balance that includes unrealized PnL\n          initialBalance: initialBalance,\n          openPositions: openPositions?.length || 0,\n          totalVolume: totalVolume,\n          pairsPerformance: pairsPerformance\n        });\n      } else {\n        // No trades yet - calculate balance including unrealized PnL from open positions\n        const initialBalance = accountData?.initial_balance || account?.initial_balance || 10000;\n        let totalUnrealizedPnL = 0;\n        if (positionsWithPrices && positionsWithPrices.length > 0) {\n          positionsWithPrices.forEach((position) => {\n            totalUnrealizedPnL += position.unrealized_pnl || 0;\n          });\n        }\n        const calculatedCurrentBalance = initialBalance + \n          parseFloat((accountData?.total_deposited ?? account?.total_deposited) || 0) + \n          totalUnrealizedPnL;\n        \n        // Calculate pairsPerformance even when there are no closed trades (only open positions)\n        const pairsMap = new Map<string, PairPerformance>();\n        \n        // Process open positions by symbol\n        if (openPositions && positionsWithPrices) {\n          openPositions.forEach((position: any) => {\n            const symbol = position.symbol || 'UNKNOWN';\n            if (!pairsMap.has(symbol)) {\n              pairsMap.set(symbol, {\n                symbol: symbol,\n                totalTrades: 0,\n                winningTrades: 0,\n                losingTrades: 0,\n                winRate: 0,\n                totalPnL: 0,\n                totalFees: 0,\n                totalVolume: 0,\n                averageWin: 0,\n                averageLoss: 0,\n                profitFactor: 0,\n                openPositions: 0,\n                unrealizedPnL: 0,\n                runningHours: 0,\n                botNames: []\n              });\n            }\n            \n            const pairPerf = pairsMap.get(symbol)!;\n            pairPerf.openPositions++;\n            \n            // Add bot name if available\n            if (position.bot_id && botNamesMap.has(position.bot_id)) {\n              const botName = botNamesMap.get(position.bot_id)!;\n              if (!pairPerf.botNames.includes(botName)) {\n                pairPerf.botNames.push(botName);\n              }\n            }\n            \n            const positionWithPrice = positionsWithPrices.find((p) => p.id === position.id);\n            if (positionWithPrice) {\n              pairPerf.unrealizedPnL += positionWithPrice.unrealized_pnl || 0;\n            } else {\n              pairPerf.unrealizedPnL += parseFloat(position.unrealized_pnl || 0);\n            }\n            \n            // Calculate running hours\n            const openedAt = new Date(position.opened_at || position.created_at);\n            if (!isNaN(openedAt.getTime())) {\n              const diffMs = new Date().getTime() - openedAt.getTime();\n              const hours = diffMs / (1000 * 60 * 60);\n              if (pairPerf.runningHours === 0 || hours > pairPerf.runningHours) {\n                pairPerf.runningHours = hours;\n              }\n            }\n          });\n        }\n        \n        const pairsPerformance: PairPerformance[] = Array.from(pairsMap.values()).sort((a, b) => {\n          const aTotal = a.totalPnL + a.unrealizedPnL;\n          const bTotal = b.totalPnL + b.unrealizedPnL;\n          return bTotal - aTotal;\n        });\n        \n        setPerformance({\n          totalTrades: 0,\n          winningTrades: 0,\n          losingTrades: 0,\n          winRate: 0,\n          totalPnL: 0,\n          totalPnLBeforeFees: 0,\n          totalFees: 0,\n          totalPnLPercentage: 0,\n          averageWin: 0,\n          averageLoss: 0,\n          profitFactor: 0,\n          maxDrawdown: 0,\n          currentBalance: calculatedCurrentBalance,\n          initialBalance: initialBalance,\n          openPositions: openPositions?.length || 0,\n          totalVolume: 0,\n          pairsPerformance: pairsPerformance\n        });\n      }\n    } catch (error) {\n      console.error('Error fetching performance:', error);\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchPerformance();\n    \n    // Refresh every 30 seconds\n    const interval = setInterval(() => {\n      fetchPerformance();\n    }, 30000);\n\n    return () => clearInterval(interval);\n  }, [selectedPair]);\n\n  const handleRefresh = async () => {\n    setRefreshing(true);\n    await fetchPerformance();\n  };\n\n  const handleResetPerformance = async () => {\n    const confirmed = window.confirm('Resetting will clear all paper trades, performance stats, and open positions. Continue?');\n    if (!confirmed) {\n      return;\n    }\n\n    setResetting(true);\n    setLoading(true);\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) {\n        throw new Error('Not authenticated');\n      }\n\n      const response = await fetch(`${import.meta.env.VITE_PUBLIC_SUPABASE_URL}/functions/v1/paper-trading`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${session.access_token}`,\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          action: 'reset_performance',\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json().catch(() => null);\n        throw new Error(error?.error || 'Failed to reset paper performance');\n      }\n\n      await fetchPerformance();\n      if (onReset) {\n        await onReset();\n      }\n      alert('âœ… Paper trading performance reset successfully');\n    } catch (error: any) {\n      console.error('Error resetting paper performance:', error);\n      alert('Error resetting paper performance: ' + (error?.message || 'Unknown error'));\n    } finally {\n      setResetting(false);\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"p-6\">\n        <div className=\"text-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading performance data...</p>\n        </div>\n      </Card>\n    );\n  }\n\n  if (!performance) {\n    return null;\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Performance Overview */}\n      <Card className=\"p-6\">\n        <div className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">ðŸ“Š Paper Trading Performance</h3>\n          <div className=\"flex items-center gap-2\">\n            <Button\n              onClick={handleRefresh}\n              variant=\"secondary\"\n              size=\"sm\"\n              loading={refreshing}\n            >\n              <i className=\"ri-refresh-line mr-2\"></i>\n              Refresh\n            </Button>\n            <Button\n              onClick={handleResetPerformance}\n              variant=\"danger\"\n              size=\"sm\"\n              loading={resetting}\n            >\n              <i className=\"ri-history-line mr-2\"></i>\n              Reset\n            </Button>\n          </div>\n        </div>\n\n        {/* Key Metrics Grid */}\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\n          <div className=\"p-4 bg-blue-50 rounded-lg\">\n            <div className=\"text-sm text-gray-600 mb-1\">Total PnL</div>\n            <div className={`text-2xl font-bold ${performance.totalPnL >= 0 ? 'text-green-600' : 'text-red-600'}`}>\n              ${performance.totalPnL.toFixed(2)}\n            </div>\n            <div className=\"text-xs text-gray-500 mt-1\">\n              {performance.totalPnLPercentage >= 0 ? '+' : ''}{performance.totalPnLPercentage.toFixed(2)}%\n            </div>\n            {performance.totalFees > 0 && (\n              <div className=\"text-xs text-gray-400 mt-1\">\n                Fees: ${performance.totalFees.toFixed(2)}\n              </div>\n            )}\n          </div>\n\n          <div className=\"p-4 bg-green-50 rounded-lg\">\n            <div className=\"text-sm text-gray-600 mb-1\">Win Rate</div>\n            <div className=\"text-2xl font-bold text-green-600\">\n              {performance.winRate.toFixed(1)}%\n            </div>\n            <div className=\"text-xs text-gray-500 mt-1\">\n              {performance.winningTrades}W / {performance.losingTrades}L\n            </div>\n          </div>\n\n          <div className=\"p-4 bg-purple-50 rounded-lg\">\n            <div className=\"text-sm text-gray-600 mb-1\">Total Trades</div>\n            <div className=\"text-2xl font-bold text-purple-600\">\n              {performance.totalTrades}\n            </div>\n            <div className=\"text-xs text-gray-500 mt-1\">\n              {performance.openPositions} open positions\n            </div>\n          </div>\n\n          <div className=\"p-4 bg-yellow-50 rounded-lg\">\n            <div className=\"text-sm text-gray-600 mb-1\">Current Balance</div>\n            <div className={`text-2xl font-bold ${performance.currentBalance >= performance.initialBalance ? 'text-green-600' : 'text-red-600'}`}>\n              ${performance.currentBalance.toFixed(2)}\n            </div>\n            <div className=\"text-xs text-gray-500 mt-1\">\n              Initial: ${performance.initialBalance.toFixed(2)}\n            </div>\n          </div>\n        </div>\n\n        {/* Advanced Metrics */}\n        <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 pt-4 border-t\">\n          <div>\n            <div className=\"text-sm text-gray-600 mb-1\">Average Win</div>\n            <div className=\"text-lg font-semibold text-green-600\">\n              ${performance.averageWin.toFixed(2)}\n            </div>\n          </div>\n          <div>\n            <div className=\"text-sm text-gray-600 mb-1\">Average Loss</div>\n            <div className=\"text-lg font-semibold text-red-600\">\n              ${performance.averageLoss.toFixed(2)}\n            </div>\n          </div>\n          <div>\n            <div className=\"text-sm text-gray-600 mb-1\">Profit Factor</div>\n            <div className={`text-lg font-semibold ${performance.profitFactor >= 1 ? 'text-green-600' : 'text-red-600'}`}>\n              {performance.profitFactor.toFixed(2)}x\n            </div>\n          </div>\n          <div>\n            <div className=\"text-sm text-gray-600 mb-1\">Max Drawdown</div>\n            <div className=\"text-lg font-semibold text-orange-600\">\n              {performance.maxDrawdown.toFixed(2)}%\n            </div>\n          </div>\n          <div>\n            <div className=\"text-sm text-gray-600 mb-1\">Total Fees</div>\n            <div className=\"text-lg font-semibold text-red-600\">\n              ${performance.totalFees.toFixed(2)}\n            </div>\n            <div className=\"text-xs text-gray-500 mt-1\">\n              {performance.totalVolume > 0 ? ((performance.totalFees / performance.totalVolume) * 100).toFixed(3) + '%' : '0%'} of volume\n            </div>\n          </div>\n          <div>\n            <div className=\"text-sm text-gray-600 mb-1\">Total Volume</div>\n            <div className=\"text-lg font-semibold text-blue-600\">\n              ${performance.totalVolume.toFixed(2)}\n            </div>\n            <div className=\"text-xs text-gray-500 mt-1\">\n              {performance.totalTrades} trades\n            </div>\n          </div>\n        </div>\n      </Card>\n\n      {/* Open Positions */}\n      <Card className=\"p-6\">\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n          ðŸ“ˆ Open Positions \n          <span className=\"ml-2 text-sm font-normal text-gray-500\">\n            ({positions.length} {positions.length === 1 ? 'position' : 'positions'})\n          </span>\n        </h3>\n        {positions.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500\">\n            <i className=\"ri-inbox-line text-4xl mb-3 block\"></i>\n            <p>No open positions</p>\n            <p className=\"text-sm mt-1\">Positions will appear here when bots open trades</p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {positions.map((position) => {\n              const marginUsed = Number(position.margin_used ?? 0);\n              const pnlPercentage = position.entry_price > 0 && marginUsed !== 0\n                ? (position.unrealized_pnl / marginUsed) * 100\n                : 0;\n\n              return (\n                <div\n                  key={position.id}\n                  className=\"p-4 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors\"\n                >\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <div className=\"flex items-center space-x-3\">\n                      <div className={`px-3 py-1 rounded-full text-xs font-bold ${\n                        position.side === 'long' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\n                      }`}>\n                        {position.side.toUpperCase()}\n                      </div>\n                      <span className=\"font-semibold text-gray-900 dark:text-white\">{position.symbol}</span>\n                      <span className=\"text-sm text-gray-500 bg-gray-200 px-2 py-0.5 rounded\">{position.leverage}x</span>\n                    </div>\n                    <div className=\"text-right\">\n                      <div className={`text-xl font-bold ${\n                        position.unrealized_pnl >= 0 ? 'text-green-600' : 'text-red-600'\n                      }`}>\n                        {position.unrealized_pnl >= 0 ? '+' : ''}${position.unrealized_pnl.toFixed(2)}\n                      </div>\n                      <div className={`text-xs mt-1 ${\n                        pnlPercentage >= 0 ? 'text-green-600' : 'text-red-600'\n                      }`}>\n                        {pnlPercentage >= 0 ? '+' : ''}{pnlPercentage.toFixed(2)}%\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm mb-2\">\n                    <div>\n                      <span className=\"text-gray-500 block text-xs mb-1\">Entry Price</span>\n                      <span className=\"font-medium text-gray-900 dark:text-white\">${position.entry_price.toFixed(2)}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-500 dark:text-gray-400 block text-xs mb-1\">Current Price</span>\n                      <span className=\"font-medium text-gray-900 dark:text-white\">\n                        ${position.current_price?.toFixed(2) || 'Loading...'}\n                      </span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-500 dark:text-gray-400 block text-xs mb-1\">Quantity</span>\n                      <span className=\"font-medium text-gray-900 dark:text-white\">{position.quantity.toFixed(6)}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-500 dark:text-gray-400 block text-xs mb-1\">Margin Used</span>\n                      <span className=\"font-medium text-gray-900 dark:text-white\">${marginUsed.toFixed(2)}</span>\n                    </div>\n                  </div>\n                  <div className=\"mt-2 pt-2 border-t border-gray-200 flex items-center justify-between text-xs text-gray-400\">\n                    <span>Opened: {new Date(position.opened_at).toLocaleString()}</span>\n                    <span className=\"capitalize\">{position.status}</span>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </Card>\n\n      {/* Performance by Pair - Always show if there are pairs or open positions */}\n      {performance.pairsPerformance && performance.pairsPerformance.length > 0 && (\n        <Card className=\"p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n            ðŸ“Š Performance by Trading Pair\n            <span className=\"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400\">\n              ({performance.pairsPerformance.length} {performance.pairsPerformance.length === 1 ? 'pair' : 'pairs'})\n            </span>\n          </h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {performance.pairsPerformance.map((pair) => {\n              const totalPnLWithUnrealized = pair.totalPnL + pair.unrealizedPnL;\n              \n              return (\n                <div\n                  key={pair.symbol}\n                  className=\"p-4 bg-gray-50 rounded-lg border border-gray-200 hover:shadow-md transition-shadow\"\n                >\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <div>\n                      <h4 className=\"font-semibold text-gray-900 dark:text-white text-lg\">{pair.symbol}</h4>\n                      {pair.botNames && pair.botNames.length > 0 && (\n                        <div className=\"mt-1 flex flex-wrap gap-1\">\n                          {pair.botNames.map((botName, idx) => (\n                            <span\n                              key={idx}\n                              className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200\"\n                            >\n                              <i className=\"ri-robot-line mr-1\"></i>\n                              {botName}\n                            </span>\n                          ))}\n                        </div>\n                      )}\n                    </div>\n                    <div className={`text-right ${totalPnLWithUnrealized >= 0 ? 'text-green-600' : 'text-red-600'}`}>\n                      <div className=\"text-xl font-bold\">\n                        {totalPnLWithUnrealized >= 0 ? '+' : ''}${totalPnLWithUnrealized.toFixed(2)}\n                      </div>\n                      <div className=\"text-xs text-gray-500\">\n                        {pair.unrealizedPnL !== 0 && (\n                          <span>\n                            ${pair.totalPnL.toFixed(2)} realized\n                            {pair.unrealizedPnL > 0 ? ' +' : ' '}\n                            ${pair.unrealizedPnL.toFixed(2)} unrealized\n                          </span>\n                        )}\n                        {pair.unrealizedPnL === 0 && pair.totalPnL !== 0 && (\n                          <span>Realized PnL</span>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"grid grid-cols-2 gap-3 text-sm mb-3\">\n                    <div>\n                      <span className=\"text-gray-500 block text-xs mb-1\">Win Rate</span>\n                      <span className={`font-semibold ${pair.winRate >= 50 ? 'text-green-600' : 'text-red-600'}`}>\n                        {pair.winRate.toFixed(1)}%\n                      </span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-500 block text-xs mb-1\">Trades</span>\n                      <span className=\"font-semibold text-gray-900 dark:text-white\">\n                        {pair.totalTrades} ({pair.winningTrades}W / {pair.losingTrades}L)\n                      </span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-500 dark:text-gray-400 block text-xs mb-1\">Profit Factor</span>\n                      <span className={`font-semibold ${pair.profitFactor >= 1 ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'}`}>\n                        {pair.profitFactor.toFixed(2)}x\n                      </span>\n                    </div>\n                    <div>\n                      <span className=\"text-gray-500 dark:text-gray-400 block text-xs mb-1\">Open Positions</span>\n                      <span className=\"font-semibold text-gray-900 dark:text-white\">\n                        {pair.openPositions}\n                      </span>\n                    </div>\n                  </div>\n                  \n                  <div className=\"pt-3 border-t border-gray-200\">\n                    <div className=\"grid grid-cols-2 gap-2 text-xs\">\n                      <div>\n                        <span className=\"text-gray-500\">Avg Win:</span>\n                        <span className=\"ml-1 font-medium text-green-600\">\n                          ${pair.averageWin.toFixed(2)}\n                        </span>\n                      </div>\n                      <div>\n                        <span className=\"text-gray-500\">Avg Loss:</span>\n                        <span className=\"ml-1 font-medium text-red-600\">\n                          ${pair.averageLoss.toFixed(2)}\n                        </span>\n                      </div>\n                      <div>\n                        <span className=\"text-gray-500\">Volume:</span>\n                        <span className=\"ml-1 font-medium text-gray-900 dark:text-white\">\n                          ${pair.totalVolume.toFixed(2)}\n                        </span>\n                      </div>\n                      <div>\n                        <span className=\"text-gray-500\">Fees:</span>\n                        <span className=\"ml-1 font-medium text-red-600\">\n                          ${pair.totalFees.toFixed(2)}\n                        </span>\n                      </div>\n                      <div className=\"col-span-2\">\n                        <span className=\"text-gray-500\">Running Hours:</span>\n                        <span className=\"ml-1 font-medium text-blue-600\">\n                          {pair.runningHours >= 24 \n                            ? `${Math.floor(pair.runningHours / 24)}d ${Math.floor(pair.runningHours % 24)}h`\n                            : `${pair.runningHours.toFixed(1)}h`\n                          }\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </Card>\n      )}\n    </div>\n  );\n}\n\n"],"names":["PaperTradingPerformance","selectedPair","onReset","performance","setPerformance","useState","positions","setPositions","loading","setLoading","refreshing","setRefreshing","resetting","setResetting","ensureAccountExists","session","supabase","response","err","result","fetchPerformance","user","account","tradesQuery","trades","openPositionsQuery","openPositions","botIds","trade","position","botNamesMap","bots","bot","accountData","normalizePosition","raw","overrides","toNumber","value","fallback","parsed","entryPrice","quantity","leverage","marginUsed","currentPrice","unrealizedPnL","side","positionsWithPrices","symbol","marketData","apiCall","API_ENDPOINTS","apiError","error","winningTrades","t","losingTrades","totalFees","sum","totalPnL","totalPnLBeforeFees","totalVolume","orderValue","totalWins","totalLosses","initialBalance","winRate","averageWin","averageLoss","profitFactor","runningBalance","maxBalance","maxDrawdown","a","b","drawdown","totalUnrealizedPnL","totalMarginUsed","realizedPnL","calculatedCurrentBalance","pairsMap","pairPerf","botName","positionWithPrice","p","pairsPerformance","pair","pairTrades","pairWinningTrades","pairLosingTrades","pairTotalWins","pairTotalLosses","pairOpenPositions","earliestTimestamp","latestTimestamp","tradeDates","d","earliestTradeTime","latestTradeTime","earliestCurrent","latestCurrent","positionDates","earliestPositionTime","earliestPositionCurrent","runningHours","aTotal","openedAt","hours","useEffect","interval","handleRefresh","handleResetPerformance","Card","jsxs","jsx","Button","pnlPercentage","_a","totalPnLWithUnrealized","idx"],"mappings":"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"}