import{r as c,A as f,a as p,j as e}from"./index-321436f1.js";import{H as T}from"./Header-2658f9f8.js";import{N as S}from"./Navigation-9a3bda9a.js";import{C as n}from"./Card-7573631f.js";import{B as w}from"./Button-a3072fe0.js";import{u as E}from"./useBots-dbe04381.js";function I(a){const[g,d]=c.useState([]),[u,m]=c.useState(!0),[j,h]=c.useState(null),i=async()=>{try{m(!0);const t=a?`${f.TRADING_ENGINE}/trades?botId=${a}`:`${f.TRADING_ENGINE}/trades`,o=await p(t);d(o.trades||[]),h(null)}catch(t){h(t instanceof Error?t.message:"Failed to fetch trades")}finally{m(!1)}},l=async(t,o)=>{try{const r=await p(`${f.TRADING_ENGINE}/close-trade`,{method:"POST",body:JSON.stringify({tradeId:t,exitPrice:o})});return await i(),r.trade}catch(r){throw new Error(r instanceof Error?r.message:"Failed to close trade")}};return c.useEffect(()=>{i();const t=setInterval(i,3e4);return()=>clearInterval(t)},[a]),{trades:g,loading:u,error:j,fetchTrades:i,closeTrade:l}}function L(){const[a,g]=c.useState("all"),[d,u]=c.useState("all"),{trades:m,loading:j,fetchTrades:h}=I(),{bots:i}=E(),l=m.filter(s=>!(a!=="all"&&s.status!==a||d!=="all"&&s.botId!==d)),t=s=>{switch(s){case"open":return"text-blue-600 bg-blue-50";case"closed":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},o=s=>s==="long"?"text-green-600":"text-red-600",r=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:4}).format(s),y=s=>{if(!s)return"-";const x=s>=0?"text-green-600":"text-red-600",N=s>=0?"+":"";return e.jsxs("span",{className:x,children:[N,r(s)]})},v=()=>{confirm("Are you sure you want to reset all trade data? This will clear all trade history.")&&(localStorage.removeItem("trades"),h())},b=s=>{const x=i.find(N=>N.id===s);return(x==null?void 0:x.name)||"Unknown Bot"};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(T,{title:"Trades",subtitle:"Monitor your trading activity",rightAction:e.jsxs(w,{variant:"danger",size:"sm",onClick:v,children:[e.jsx("i",{className:"ri-refresh-line mr-1"}),"Reset"]})}),e.jsxs("div",{className:"pt-20 pb-20 px-4 space-y-4",children:[e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsx("div",{className:"flex space-x-2",children:["all","open","closed"].map(s=>e.jsx("button",{onClick:()=>g(s),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${a===s?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bot"}),e.jsxs("select",{value:d,onChange:s=>u(s.target.value),className:"w-full bg-gray-100 border-none rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"All Bots"}),i.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:l.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Trades"})]})}),e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.filter(s=>s.status==="open").length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Active Trades"})]})})]}),e.jsx("div",{className:"space-y-3",children:j?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading trades..."})]}):l.length===0?e.jsxs(n,{className:"p-8 text-center",children:[e.jsx("i",{className:"ri-file-list-line text-4xl text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Trades Found"}),e.jsx("p",{className:"text-gray-500",children:"No trades match your current filters."})]}):l.map(s=>e.jsxs(n,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${t(s.status)}`,children:s.status.toUpperCase()}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date(s.timestamp).toLocaleDateString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.symbol}),e.jsx("div",{className:"text-xs text-gray-500 capitalize",children:s.exchange})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Bot"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:b(s.botId)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Side"}),e.jsx("div",{className:`text-sm font-medium ${o(s.side)}`,children:s.side.toUpperCase()})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Size"}),e.jsx("div",{className:"font-medium",children:s.size})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Entry Price"}),e.jsx("div",{className:"font-medium",children:r(s.entryPrice)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:s.status==="open"?"Current P&L":"P&L"}),e.jsx("div",{className:"font-medium",children:y(s.pnl)})]})]}),s.exitPrice&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Exit Price:"}),e.jsx("span",{className:"font-medium",children:r(s.exitPrice)})]})})]},s.id))}),e.jsxs(n,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:"bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg transition-colors flex items-center justify-center",children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Export Trades"]}),e.jsxs("button",{className:"bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 px-4 rounded-lg transition-colors flex items-center justify-center",children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Refresh Data"]})]})]})]}),e.jsx(S,{})]})}export{L as default};
//# sourceMappingURL=page-128f2b6b.js.map
