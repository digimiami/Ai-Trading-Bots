import{r as c,s as A}from"./index-saG1DHHi.js";function L(a){const[v,l]=c.useState([]),[p,g]=c.useState(!0),[y,u]=c.useState(null),m=async(e,t)=>{try{const{data:{user:s}}=await A.auth.getUser();if(!s)throw new Error("No active session");const r={...t,botId:e,timestamp:new Date().toISOString()},n=[...JSON.parse(localStorage.getItem(`bot_logs_${e}`)||"[]"),{...r,id:Date.now().toString()}];return localStorage.setItem(`bot_logs_${e}`,JSON.stringify(n)),l(S=>S.map(o=>o.botId===e?{...o,logs:[...o.logs,{...r,id:Date.now().toString()}],lastActivity:r.timestamp,errorCount:t.level==="error"?o.errorCount+1:o.errorCount,successCount:t.level==="success"?o.successCount+1:o.successCount}:o)),r}catch(s){throw console.error("Error adding bot log:",s),s}},f=async e=>{try{return JSON.parse(localStorage.getItem(`bot_logs_${e}`)||"[]").sort((s,r)=>new Date(r.timestamp).getTime()-new Date(s.timestamp).getTime())}catch(t){return console.error("Error fetching bot logs:",t),[]}},i=async()=>{try{if(g(!0),u(null),!a||a.length===0){l([]);return}const e=await Promise.all(a.map(async t=>{const s=await f(t.id),r=s.filter(n=>n.level==="error").length,d=s.filter(n=>n.level==="success").length;return{botId:t.id,botName:t.name,status:t.status,lastActivity:s.length>0?s[0].timestamp:t.createdAt,logs:s.slice(0,50),isActive:t.status==="running",currentAction:s.length>0?s[0].message:"Initializing...",waitingFor:t.status==="running"?"Market conditions":void 0,errorCount:r,successCount:d}}));l(e)}catch(e){console.error("Error fetching bot activities:",e),u(e instanceof Error?e.message:"Failed to fetch activities")}finally{g(!1)}},h=async e=>{try{localStorage.removeItem(`bot_logs_${e}`),await i()}catch(t){console.error("Error clearing bot logs:",t)}},w=async e=>{const t=[{level:"info",category:"system",message:"Bot initialized successfully"},{level:"info",category:"market",message:"Analyzing market conditions..."},{level:"info",category:"strategy",message:"RSI: 45, ADX: 28 - Market trending"},{level:"success",category:"trade",message:"Long position opened at $45,250"},{level:"info",category:"market",message:"Monitoring position..."},{level:"warning",category:"market",message:"Price approaching stop loss"},{level:"success",category:"trade",message:"Position closed with +2.5% profit"}];for(const s of t)await m(e,s),await new Promise(r=>setTimeout(r,1e3))};return c.useEffect(()=>{i();const e=setInterval(i,3e4);return()=>clearInterval(e)},[a]),{activities:v,loading:p,error:y,addLog:m,fetchBotLogs:f,clearBotLogs:h,simulateBotActivity:w,refetch:i}}export{L as u};
//# sourceMappingURL=useBotActivity-DCkdrEef.js.map
