{"version":3,"file":"page-34852f76.js","sources":["../../src/pages/transaction-log/page.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react';\r\nimport Header from '../../components/feature/Header';\r\nimport Navigation from '../../components/feature/Navigation';\r\nimport Card from '../../components/base/Card';\r\nimport Button from '../../components/base/Button';\r\nimport { supabase } from '../../lib/supabase';\r\nimport { useAuth } from '../../hooks/useAuth';\r\n\r\ntype TransactionSummary = {\r\n  totalTrades: number;\r\n  longTrades: number;\r\n  shortTrades: number;\r\n  wins: number;\r\n  losses: number;\r\n  winRate: number;\r\n  grossPnl: number;\r\n  fees: number;\r\n  netPnl: number;\r\n};\r\n\r\ntype BreakdownRow = {\r\n  symbol: string;\r\n  mode: string;\r\n  trades: number;\r\n  pnl: number;\r\n  fees: number;\r\n};\r\n\r\ntype TransactionEntry = {\r\n  id: string;\r\n  botId: string;\r\n  botName: string;\r\n  symbol: string;\r\n  side: string;\r\n  status: string;\r\n  pnl: number;\r\n  fees: number;\r\n  mode: string;\r\n  amount?: number;\r\n  price?: number;\r\n  exchange?: string;\r\n  executedAt?: string;\r\n  updatedAt?: string;\r\n  createdAt: string;\r\n  closedAt: string | null;\r\n};\r\n\r\ntype ReportResponse = {\r\n  summary: TransactionSummary;\r\n  breakdown: {\r\n    bySymbol: BreakdownRow[];\r\n  };\r\n  entries: TransactionEntry[];\r\n};\r\n\r\ntype DateRangeOption = '24h' | '7d' | '30d' | 'custom';\r\n\r\nconst DEFAULT_SUMMARY: TransactionSummary = {\r\n  totalTrades: 0,\r\n  longTrades: 0,\r\n  shortTrades: 0,\r\n  wins: 0,\r\n  losses: 0,\r\n  winRate: 0,\r\n  grossPnl: 0,\r\n  fees: 0,\r\n  netPnl: 0\r\n};\r\n\r\nexport default function TransactionLogPage() {\r\n  const { user } = useAuth();\r\n  const [range, setRange] = useState<DateRangeOption>('7d');\r\n  const [mode, setMode] = useState<'all' | 'real' | 'paper'>('all');\r\n  const [customStart, setCustomStart] = useState<string>('');\r\n  const [customEnd, setCustomEnd] = useState<string>('');\r\n  const [symbols, setSymbols] = useState<string[]>([]);\r\n  const [selectedSymbol, setSelectedSymbol] = useState<string>('all');\r\n  const [report, setReport] = useState<ReportResponse>({\r\n    summary: DEFAULT_SUMMARY,\r\n    breakdown: { bySymbol: [] },\r\n    entries: []\r\n  });\r\n  const [loading, setLoading] = useState<boolean>(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [lastUpdated, setLastUpdated] = useState<Date | null>(null);\r\n\r\n  const formattedSummary = useMemo(() => report.summary || DEFAULT_SUMMARY, [report.summary]);\r\n\r\n  const computeRange = () => {\r\n    const now = new Date();\r\n    const endIso = now.toISOString();\r\n    if (range === '24h') {\r\n      return { start: new Date(now.getTime() - 24 * 60 * 60 * 1000).toISOString(), end: endIso };\r\n    }\r\n    if (range === '7d') {\r\n      return { start: new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000).toISOString(), end: endIso };\r\n    }\r\n    if (range === '30d') {\r\n      return { start: new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000).toISOString(), end: endIso };\r\n    }\r\n    // custom\r\n    return {\r\n      start: customStart ? new Date(customStart).toISOString() : null,\r\n      end: customEnd ? new Date(customEnd).toISOString() : null\r\n    };\r\n  };\r\n\r\n  const fetchSymbols = async () => {\r\n    if (!user) return;\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('transaction_log_entries')\r\n        .select('symbol', { distinct: true })\r\n        .eq('user_id', user.id);\r\n      if (error) throw error;\r\n      const unique = Array.from(\r\n        new Set(\r\n          (data || [])\r\n            .map((row) => row.symbol)\r\n            .filter((value): value is string => Boolean(value))\r\n        )\r\n      ).sort();\r\n      setSymbols(unique);\r\n    } catch (err) {\r\n      console.error('Failed to load available symbols', err);\r\n    }\r\n  };\r\n\r\n  const fetchReport = async () => {\r\n    if (!user) return;\r\n    const { start, end } = computeRange();\r\n    if (range === 'custom' && (!start || !end)) {\r\n      setError('Please select both start and end date for custom range.');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const { data, error } = await supabase.rpc('transaction_log_report', {\r\n        p_user_id: user.id,\r\n        p_symbols: selectedSymbol !== 'all' ? [selectedSymbol] : null,\r\n        p_mode: mode,\r\n        p_start: start,\r\n        p_end: end,\r\n        p_limit: 200,\r\n        p_offset: 0\r\n      });\r\n\r\n      if (error) throw error;\r\n\r\n      const nextReport: ReportResponse = {\r\n        summary: data?.summary || DEFAULT_SUMMARY,\r\n        breakdown: {\r\n          bySymbol: data?.breakdown?.bySymbol || []\r\n        },\r\n        entries: data?.entries || []\r\n      };\r\n\r\n      setReport(nextReport);\r\n      setLastUpdated(new Date());\r\n    } catch (err: any) {\r\n      console.error('Failed to load transaction log report:', err);\r\n      setError(err?.message || 'Failed to load transaction log report');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchSymbols();\r\n  }, [user?.id]);\r\n\r\n  useEffect(() => {\r\n    if (!user) return;\r\n    fetchReport();\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [user?.id, range, mode, selectedSymbol]);\r\n\r\n  const handleSymbolChange = (event: React.ChangeEvent<HTMLSelectElement>) => {\r\n    setSelectedSymbol(event.target.value);\r\n  };\r\n\r\n  const formatCurrency = (value: number) => {\r\n    return new Intl.NumberFormat('en-US', {\r\n      style: 'currency',\r\n      currency: 'USD',\r\n      minimumFractionDigits: 2,\r\n      maximumFractionDigits: 2\r\n    }).format(value || 0);\r\n  };\r\n\r\n  const formatAmount = (value?: number, digits: number = 4) =>\r\n    new Intl.NumberFormat('en-US', {\r\n      minimumFractionDigits: digits,\r\n      maximumFractionDigits: digits\r\n    }).format(value ?? 0);\r\n\r\n  const formatPercentage = (value: number) => `${(value * 100 || 0).toFixed(1)}%`;\r\n\r\n  const renderSummaryCard = (\r\n    label: string,\r\n    value: string | number,\r\n    icon: string,\r\n    tintClass: string = 'text-gray-900'\r\n  ) => (\r\n    <Card key={label} className=\"p-4\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <p className=\"text-sm text-gray-500 mb-1\">{label}</p>\r\n          <p className={`text-2xl font-semibold ${tintClass}`}>{value}</p>\r\n        </div>\r\n        <i className={`${icon} text-2xl text-gray-300`}></i>\r\n      </div>\r\n    </Card>\r\n  );\r\n\r\n  const summaryCards = [\r\n    renderSummaryCard('Total Trades', formattedSummary.totalTrades, 'ri-bar-chart-line'),\r\n    renderSummaryCard(\r\n      'Net PnL',\r\n      formatCurrency(formattedSummary.netPnl),\r\n      'ri-funds-line',\r\n      formattedSummary.netPnl >= 0 ? 'text-green-600' : 'text-red-600'\r\n    ),\r\n    renderSummaryCard('Fees', formatCurrency(formattedSummary.fees), 'ri-hand-coin-fill', 'text-amber-600'),\r\n    renderSummaryCard('Win Rate', `${(formattedSummary.winRate * 100 || 0).toFixed(1)}%`, 'ri-trophy-line', 'text-blue-600'),\r\n    renderSummaryCard('Long Trades', formattedSummary.longTrades, 'ri-arrow-up-line', 'text-emerald-600'),\r\n    renderSummaryCard('Short Trades', formattedSummary.shortTrades, 'ri-arrow-down-line', 'text-rose-600'),\r\n    renderSummaryCard('Wins', formattedSummary.wins, 'ri-checkbox-circle-line', 'text-green-600'),\r\n    renderSummaryCard('Losses', formattedSummary.losses, 'ri-close-circle-line', 'text-red-600')\r\n  ];\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\r\n      <Header\r\n        title=\"Transaction Log\"\r\n        subtitle=\"Analyze executed trades, fees, and performance across your bots\"\r\n      />\r\n\r\n      <div className=\"pt-20 pb-20 px-4 space-y-4 max-w-6xl mx-auto w-full\">\r\n        <Card className=\"space-y-4\">\r\n          <div className=\"flex flex-wrap items-center gap-2\">\r\n            {[\r\n              { key: '24h', label: 'Last 24h' },\r\n              { key: '7d', label: 'Last 7d' },\r\n              { key: '30d', label: 'Last 30d' },\r\n              { key: 'custom', label: 'Custom' }\r\n            ].map((option) => (\r\n              <button\r\n                key={option.key}\r\n                onClick={() => setRange(option.key as DateRangeOption)}\r\n                className={`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${\r\n                  range === option.key\r\n                    ? 'bg-blue-600 text-white'\r\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300'\r\n                }`}\r\n              >\r\n                {option.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n\r\n          {range === 'custom' && (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n              <div className=\"flex flex-col\">\r\n                <label className=\"text-sm text-gray-600 mb-1\">Start date</label>\r\n                <input\r\n                  type=\"datetime-local\"\r\n                  value={customStart}\r\n                  onChange={(event) => setCustomStart(event.target.value)}\r\n                  className=\"bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-sm\"\r\n                />\r\n              </div>\r\n              <div className=\"flex flex-col\">\r\n                <label className=\"text-sm text-gray-600 mb-1\">End date</label>\r\n                <input\r\n                  type=\"datetime-local\"\r\n                  value={customEnd}\r\n                  onChange={(event) => setCustomEnd(event.target.value)}\r\n                  className=\"bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-sm\"\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n            <div className=\"flex flex-col\">\r\n              <label className=\"text-sm text-gray-600 mb-1\">Mode</label>\r\n              <div className=\"flex items-center gap-2\">\r\n                {['all', 'real', 'paper'].map((value) => (\r\n                  <button\r\n                    key={value}\r\n                    onClick={() => setMode(value as 'all' | 'real' | 'paper')}\r\n                    className={`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors capitalize ${\r\n                      mode === value\r\n                        ? 'bg-blue-600 text-white'\r\n                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300'\r\n                    }`}\r\n                  >\r\n                    {value}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col md:col-span-2\">\r\n              <label className=\"text-sm text-gray-600 mb-1\">Symbol</label>\r\n              <select\r\n                value={selectedSymbol}\r\n                onChange={handleSymbolChange}\r\n                className=\"bg-gray-100 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg px-3 py-2 text-sm\"\r\n              >\r\n                <option value=\"all\">All Pairs</option>\r\n                {symbols.length === 0 && <option value=\"\" disabled>No symbols available yet</option>}\r\n                {symbols.map((symbol) => (\r\n                  <option key={symbol} value={symbol}>\r\n                    {symbol}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"text-xs text-gray-500\">\r\n              {lastUpdated ? `Last updated: ${lastUpdated.toLocaleString()}` : 'Results update automatically when filters change.'}\r\n            </div>\r\n            <Button variant=\"secondary\" size=\"sm\" onClick={fetchReport} loading={loading}>\r\n              <i className=\"ri-refresh-line mr-1\"></i>\r\n              Refresh\r\n            </Button>\r\n          </div>\r\n\r\n          {error && (\r\n            <div className=\"bg-red-50 border border-red-200 text-red-700 text-sm px-4 py-2 rounded-lg flex items-center gap-2\">\r\n              <i className=\"ri-error-warning-line\"></i>\r\n              {error}\r\n            </div>\r\n          )}\r\n        </Card>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n          {summaryCards}\r\n        </div>\r\n\r\n        <Card className=\"space-y-3\">\r\n          <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white\">Symbol breakdown</h2>\r\n          {report.breakdown.bySymbol.length === 0 ? (\r\n            <div className=\"text-sm text-gray-500\">No trades recorded for the selected filters.</div>\r\n          ) : (\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700 text-sm\">\r\n                <thead>\r\n                  <tr className=\"text-left text-gray-500 uppercase tracking-wider\">\r\n                    <th className=\"px-3 py-2\">Symbol</th>\r\n                    <th className=\"px-3 py-2\">Mode</th>\r\n                    <th className=\"px-3 py-2 text-right\">Trades</th>\r\n                    <th className=\"px-3 py-2 text-right\">PnL</th>\r\n                    <th className=\"px-3 py-2 text-right\">Fees</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"divide-y divide-gray-100 dark:divide-gray-800\">\r\n                  {report.breakdown.bySymbol.map((row) => (\r\n                    <tr key={`${row.symbol}-${row.mode}`}>\r\n                      <td className=\"px-3 py-2 font-medium text-gray-900 dark:text-white\">{row.symbol}</td>\r\n                      <td className=\"px-3 py-2 capitalize\">{row.mode}</td>\r\n                      <td className=\"px-3 py-2 text-right\">{row.trades}</td>\r\n                      <td className={`px-3 py-2 text-right ${row.pnl >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                        {formatCurrency(row.pnl)}\r\n                      </td>\r\n                      <td className=\"px-3 py-2 text-right text-amber-600\">\r\n                        {formatCurrency(row.fees)}\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </Card>\r\n\r\n        <Card className=\"space-y-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white\">Recent trades</h2>\r\n            <div className=\"text-xs text-gray-500\">Showing up to 200 records</div>\r\n          </div>\r\n          {loading ? (\r\n            <div className=\"text-center py-8 text-gray-500 flex items-center justify-center gap-2\">\r\n              <i className=\"ri-loader-4-line animate-spin\"></i>\r\n              Loading transaction log...\r\n            </div>\r\n          ) : report.entries.length === 0 ? (\r\n            <div className=\"text-center py-8\">\r\n              <i className=\"ri-file-chart-line text-4xl text-gray-300 mb-2\"></i>\r\n              <p className=\"text-sm text-gray-500\">No trades found for the selected filters.</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700 text-sm\">\r\n                <thead>\r\n                  <tr className=\"text-left text-gray-500 uppercase tracking-wider\">\r\n                    <th className=\"px-3 py-2\">Time</th>\r\n                    <th className=\"px-3 py-2\">Bot</th>\r\n                    <th className=\"px-3 py-2\">Symbol</th>\r\n                    <th className=\"px-3 py-2\">Side</th>\r\n                    <th className=\"px-3 py-2 text-right\">Amount</th>\r\n                    <th className=\"px-3 py-2 text-right\">Price</th>\r\n                    <th className=\"px-3 py-2\">Status</th>\r\n                    <th className=\"px-3 py-2 text-right\">PnL</th>\r\n                    <th className=\"px-3 py-2 text-right\">Fees</th>\r\n                    <th className=\"px-3 py-2\">Exchange</th>\r\n                    <th className=\"px-3 py-2 text-right\">Mode</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"divide-y divide-gray-100 dark:divide-gray-800\">\r\n                  {report.entries.map((entry) => (\r\n                    <tr key={entry.id} className=\"hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors\">\r\n                      <td className=\"px-3 py-2 text-gray-600 dark:text-gray-300\">\r\n                        {new Date(entry.executedAt ?? entry.createdAt).toLocaleString()}\r\n                      </td>\r\n                      <td className=\"px-3 py-2\">\r\n                        <div className=\"font-medium text-gray-900 dark:text-white\">{entry.botName || '—'}</div>\r\n                        <div className=\"text-xs text-gray-500\">#{entry.botId.slice(0, 6)}</div>\r\n                      </td>\r\n                      <td className=\"px-3 py-2 font-medium text-gray-900 dark:text-white\">{entry.symbol}</td>\r\n                      <td className={`px-3 py-2 font-medium ${entry.side?.toLowerCase() === 'buy' || entry.side?.toLowerCase() === 'long' ? 'text-green-600' : 'text-red-600'}`}>\r\n                        {entry.side?.toUpperCase()}\r\n                      </td>\r\n                      <td className=\"px-3 py-2 text-right\">{formatAmount(entry.amount)}</td>\r\n                      <td className=\"px-3 py-2 text-right\">{formatCurrency(entry.price ?? 0)}</td>\r\n                      <td className=\"px-3 py-2 capitalize\">{entry.status || '—'}</td>\r\n                      <td className={`px-3 py-2 text-right ${entry.pnl >= 0 ? 'text-green-600' : 'text-red-600'}`}>\r\n                        {formatCurrency(entry.pnl)}\r\n                      </td>\r\n                      <td className=\"px-3 py-2 text-right text-amber-600\">\r\n                        {formatCurrency(entry.fees)}\r\n                      </td>\r\n                      <td className=\"px-3 py-2 uppercase\">{entry.exchange || '—'}</td>\r\n                      <td className=\"px-3 py-2 text-right capitalize\">{entry.mode}</td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          )}\r\n        </Card>\r\n      </div>\r\n\r\n      <Navigation />\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":["DEFAULT_SUMMARY","TransactionLogPage","user","useAuth","range","setRange","useState","mode","setMode","customStart","setCustomStart","customEnd","setCustomEnd","symbols","setSymbols","selectedSymbol","setSelectedSymbol","report","setReport","loading","setLoading","error","setError","lastUpdated","setLastUpdated","formattedSummary","useMemo","computeRange","now","endIso","fetchSymbols","data","supabase","unique","row","value","err","fetchReport","start","end","nextReport","_a","useEffect","handleSymbolChange","event","formatCurrency","formatAmount","digits","renderSummaryCard","label","icon","tintClass","jsx","Card","jsxs","summaryCards","Header","option","symbol","Button","entry","_b","_c","Navigation"],"mappings":"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"}