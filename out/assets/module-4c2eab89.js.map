{"version":3,"file":"module-4c2eab89.js","sources":["../../src/utils/academy.ts","../../src/pages/academy/module.tsx"],"sourcesContent":["import type { AcademyLesson, AcademyModule, ModuleProgress, QuizPayload } from '../types/academy';\r\n\r\nexport const sortModules = (modules: AcademyModule[]): AcademyModule[] =>\r\n  [...modules].sort((a, b) => a.order_index - b.order_index);\r\n\r\nexport const sortLessons = (lessons: AcademyLesson[]): AcademyLesson[] =>\r\n  [...lessons].sort((a, b) => a.order_index - b.order_index);\r\n\r\nexport const computeModuleStatus = (progress?: ModuleProgress): ModuleProgress => {\r\n  if (!progress) {\r\n    return {\r\n      completedLessons: 0,\r\n      totalLessons: 0,\r\n      status: 'not_started',\r\n    };\r\n  }\r\n\r\n  if (progress.totalLessons === 0) {\r\n    return { ...progress, status: 'not_started' };\r\n  }\r\n\r\n  if (progress.completedLessons >= progress.totalLessons) {\r\n    return { ...progress, status: 'completed' };\r\n  }\r\n\r\n  if (progress.completedLessons > 0) {\r\n    return { ...progress, status: 'in_progress' };\r\n  }\r\n\r\n  return { ...progress, status: 'not_started' };\r\n};\r\n\r\nexport const parseQuizPayload = (content?: string | null): QuizPayload | null => {\r\n  if (!content) return null;\r\n  try {\r\n    const parsed = JSON.parse(content) as QuizPayload;\r\n    if (!Array.isArray(parsed.questions)) return null;\r\n    return parsed;\r\n  } catch {\r\n    return null;\r\n  }\r\n};\r\n\r\nexport const calculateProgressPercentage = (progress: ModuleProgress): number => {\r\n  if (!progress.totalLessons || progress.totalLessons === 0) return 0;\r\n  return Math.min(100, Math.round((progress.completedLessons / progress.totalLessons) * 100));\r\n};\r\n\r\nexport const hasCompletedFoundation = (completedModules: number): boolean => completedModules >= 3;\r\n\r\n","import { useEffect, useMemo, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport Card from '../../components/base/Card';\nimport Button from '../../components/base/Button';\nimport Navigation from '../../components/feature/Navigation';\nimport Header from '../../components/feature/Header';\nimport { useAcademy, getLessonStatus, LessonProgress } from '../../hooks/useAcademy';\nimport { parseQuizPayload } from '../../utils/academy';\nimport type { QuizPayload } from '../../types/academy';\n\ninterface QuizQuestion {\n  id: string;\n  prompt: string;\n  options: { label: string; value: string }[];\n  correct: string;\n}\n\n// Convert database quiz format to component format\nfunction convertQuizToQuestions(quizPayload: QuizPayload | null): QuizQuestion[] {\n  if (!quizPayload || !Array.isArray(quizPayload.questions)) {\n    return [];\n  }\n\n  return quizPayload.questions.map((q, index) => {\n    const optionValues = ['a', 'b', 'c', 'd', 'e', 'f'];\n    return {\n      id: `q${index + 1}`,\n      prompt: q.question,\n      options: q.options.map((opt, optIndex) => ({\n        label: opt,\n        value: optionValues[optIndex] || String(optIndex),\n      })),\n      correct: optionValues[q.correctIndex] || String(q.correctIndex),\n    };\n  });\n}\n\nconst lessonTypeIcon: Record<string, string> = {\n  video: 'ri-play-circle-fill',\n  guide: 'ri-file-text-line',\n  quiz: 'ri-question-answer-fill',\n};\n\nconst answerKey = (lessonId: string, questionId: string) => `${lessonId}:${questionId}`;\n\nexport default function AcademyModulePage() {\n  const { moduleSlug } = useParams<{ moduleSlug: string }>();\n  const navigate = useNavigate();\n  const { modules, lessonProgress, loading, error, recordProgress, refresh } = useAcademy();\n\n  const module = useMemo(() => modules.find((item) => item.slug === moduleSlug) ?? null, [modules, moduleSlug]);\n\n  const [activeLessonId, setActiveLessonId] = useState<string | null>(() => module?.lessons?.[0]?.id ?? null);\n  const [quizAnswers, setQuizAnswers] = useState<Record<string, string>>({});\n  const [quizMeta, setQuizMeta] = useState<Record<string, { score: number; submitted: boolean }>>({});\n\n  useEffect(() => {\n    if (!module) return;\n    if (!activeLessonId || !module.lessons.some((lesson) => lesson.id === activeLessonId)) {\n      setActiveLessonId(module.lessons[0]?.id ?? null);\n    }\n  }, [module, activeLessonId]);\n\n  const activeLesson = useMemo(\n    () => module?.lessons.find((lesson) => lesson.id === activeLessonId) ?? null,\n    [module, activeLessonId]\n  );\n\n  useEffect(() => {\n    if (!module || !activeLesson) return;\n    const status = getLessonStatus(lessonProgress, module.id, activeLesson.id);\n    if (status === 'not_started') {\n      void recordProgress(module.slug, activeLesson.slug, 'in_progress');\n    }\n  }, [module, activeLesson, lessonProgress, recordProgress]);\n\n  const completedLessons = useMemo(() => {\n    if (!module) return 0;\n    return module.lessons.filter((lesson) =>\n      lessonProgress.some(\n        (entry) => entry.module_id === module.id && entry.lesson_id === lesson.id && entry.status === 'completed'\n      )\n    ).length;\n  }, [module, lessonProgress]);\n\n  const totalLessons = module?.lessons.length ?? 0;\n  const completionPercent = totalLessons > 0 ? Math.round((completedLessons / totalLessons) * 100) : 0;\n  const lessonStatus = activeLesson && module ? getLessonStatus(lessonProgress, module.id, activeLesson.id) : 'not_started';\n  const activeQuizMeta = activeLesson ? quizMeta[activeLesson.id] : undefined;\n\n  const handleLessonAction = async (status: LessonProgress['status']) => {\n    if (!module || !activeLesson) return;\n    await recordProgress(module.slug, activeLesson.slug, status);\n  };\n\n  const handleModuleComplete = async () => {\n    if (!module) return;\n    try {\n      await recordProgress(module.slug, null, 'completed');\n      // Refresh progress to update UI\n      await refresh();\n    } catch (error) {\n      console.error('Failed to mark module as complete:', error);\n    }\n  };\n\n  const handleQuizAnswerChange = (questionId: string, value: string) => {\n    if (!activeLesson || activeQuizMeta?.submitted) return;\n    setQuizAnswers((prev) => ({\n      ...prev,\n      [answerKey(activeLesson.id, questionId)]: value,\n    }));\n  };\n\n  const handleQuizSubmit = async () => {\n    if (!module || !activeLesson || activeQuizMeta?.submitted) return;\n    const quizPayload = parseQuizPayload(activeLesson.content_md);\n    const quizQuestions = convertQuizToQuestions(quizPayload);\n    \n    if (quizQuestions.length === 0) return;\n    \n    const correctCount = quizQuestions.reduce(\n      (acc, question) =>\n        quizAnswers[answerKey(activeLesson.id, question.id)] === question.correct ? acc + 1 : acc,\n      0\n    );\n    const score = Math.round((correctCount / quizQuestions.length) * 100);\n    setQuizMeta((prev) => ({\n      ...prev,\n      [activeLesson.id]: { score, submitted: true },\n    }));\n    await recordProgress(module.slug, activeLesson.slug, 'completed', score);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gray-50 text-gray-600 dark:bg-gray-900 dark:text-gray-300\">\n        <span className=\"text-sm\">Loading module...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gray-50 dark:bg-gray-900\">\n        <Card className=\"max-w-md border border-red-200 bg-red-50 p-6 text-center text-red-700 dark:border-red-900/40 dark:bg-red-900/20 dark:text-red-200\">\n          <h2 className=\"text-lg font-semibold\">Academy module unavailable</h2>\n          <p className=\"mt-2 text-sm\">{error}</p>\n          <Button className=\"mt-4\" onClick={() => navigate('/academy')}>\n            Back to Academy\n          </Button>\n        </Card>\n      </div>\n    );\n  }\n\n  if (!module) {\n    return (\n      <div className=\"flex min-h-screen items-center justify-center bg-gray-50 dark:bg-gray-900\">\n        <Card className=\"max-w-md border border-gray-200 bg-white p-6 text-center text-gray-700 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300\">\n          <h2 className=\"text-lg font-semibold\">Module not found</h2>\n          <p className=\"mt-2 text-sm\">The module you&apos;re looking for is unavailable.</p>\n          <Button className=\"mt-4\" onClick={() => navigate('/academy')}>\n            Back to Academy\n          </Button>\n        </Card>\n      </div>\n    );\n  }\n\n  const renderLessonContent = () => {\n    if (!activeLesson) return null;\n\n    if (activeLesson.type === 'quiz') {\n      const submitted = activeQuizMeta?.submitted ?? false;\n      const score = activeQuizMeta?.score ?? null;\n      const quizPayload = parseQuizPayload(activeLesson.content_md);\n      const quizQuestions = convertQuizToQuestions(quizPayload);\n\n      if (quizQuestions.length === 0) {\n        return (\n          <div className=\"space-y-4\">\n            <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n              Quiz content is not available. Please check back later.\n            </p>\n          </div>\n        );\n      }\n\n  return (\n    <div className=\"space-y-4\">\n          <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n            Quick knowledge check. Select the best answer for each prompt to lock in your score.\n          </p>\n          {quizQuestions.map((question) => {\n            const selected = quizAnswers[answerKey(activeLesson.id, question.id)] ?? '';\n            return (\n              <div\n                key={question.id}\n                className=\"space-y-2 rounded-2xl border border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-900/40\"\n              >\n                <p className=\"font-medium text-gray-800 dark:text-gray-100\">{question.prompt}</p>\n                <div className=\"space-y-2 text-sm\">\n                  {question.options.map((option) => {\n                    const isChecked = selected === option.value;\n                    const isCorrect = submitted && option.value === question.correct;\n                    const isIncorrect = submitted && isChecked && option.value !== question.correct;\n              return (\n                <label\n                        key={option.value}\n                        className={`flex cursor-pointer items-center gap-2 rounded-xl border px-3 py-2 transition ${\n                          isCorrect\n                            ? 'border-emerald-500/60 bg-emerald-500/10 text-emerald-700 dark:text-emerald-200'\n                            : isIncorrect\n                            ? 'border-red-500/60 bg-red-500/10 text-red-700 dark:text-red-200'\n                            : isChecked\n                            ? 'border-blue-500/60 bg-blue-500/10 text-blue-700 dark:text-blue-200'\n                            : 'border-gray-200 bg-white text-gray-600 hover:border-blue-300 hover:bg-blue-50/70 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 dark:hover:border-blue-400 dark:hover:bg-blue-900/20'\n                  }`}\n                >\n                  <input\n                    type=\"radio\"\n                          name={answerKey(activeLesson.id, question.id)}\n                          value={option.value}\n                          checked={isChecked}\n                          disabled={submitted}\n                          onChange={() => handleQuizAnswerChange(question.id, option.value)}\n                          className=\"h-4 w-4\"\n                        />\n                        <span>{option.label}</span>\n                </label>\n              );\n            })}\n          </div>\n        </div>\n            );\n          })}\n          <div className=\"flex flex-wrap items-center gap-3\">\n            <Button size=\"sm\" onClick={handleQuizSubmit} disabled={submitted}>\n              {submitted ? 'Quiz Submitted' : 'Submit Quiz'}\n        </Button>\n            {submitted && score !== null && (\n              <span className=\"text-sm font-semibold text-emerald-500\">\n                Score saved: {score}%\n          </span>\n        )}\n      </div>\n    </div>\n  );\n    }\n\n    if (activeLesson.type === 'guide' && activeLesson.content_md) {\n      const sections = activeLesson.content_md.split(/\\n{2,}/);\n    return (\n        <div className=\"space-y-3 text-sm leading-relaxed text-gray-700 dark:text-gray-200\">\n          {sections.map((paragraph, idx) => (\n            <p key={idx} className=\"whitespace-pre-wrap\">\n              {paragraph.trim()}\n            </p>\n          ))}\n      </div>\n    );\n  }\n\n    if (activeLesson.type === 'video' && activeLesson.media_url) {\n    return (\n        <div className=\"overflow-hidden rounded-2xl border border-gray-200 dark:border-gray-700\">\n          <video src={activeLesson.media_url} controls className=\"w-full bg-black\" />\n      </div>\n    );\n  }\n\n    return (\n      <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n        Lesson content coming soon. Check back shortly or mark the lesson once you&apos;ve reviewed external material.\n      </p>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 pb-24 text-gray-900 dark:bg-gray-900 dark:text-gray-100\">\n      <Header\n        title={module.title}\n        subtitle=\"Deepen your mastery with immersive lessons, walkthroughs, and quick knowledge checks.\"\n        rightAction={\n          <Button variant=\"secondary\" size=\"sm\" onClick={() => navigate('/academy')}>\n            Back to Academy\n          </Button>\n        }\n      />\n\n      <main className=\"px-4 pt-24 pb-16\">\n        <div className=\"mx-auto flex max-w-6xl flex-col gap-6 lg:flex-row\">\n          <aside className=\"w-full max-w-sm space-y-4 lg:w-72\">\n            <Card className=\"space-y-3 border border-blue-100 bg-gradient-to-br from-white to-blue-50 p-6 dark:border-blue-900/40 dark:from-gray-900 dark:to-blue-950/40\">\n              <div className=\"text-xs uppercase tracking-[0.3em] text-blue-400\">Module Progress</div>\n              <div className=\"text-3xl font-semibold text-blue-600 dark:text-blue-300\">{completionPercent}%</div>\n              <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                {completedLessons} of {totalLessons} lessons completed.\n              </p>\n              <div className=\"mt-2 h-2 w-full overflow-hidden rounded-full bg-blue-100 dark:bg-blue-950/40\">\n                <div\n                  className=\"h-full rounded-full bg-gradient-to-r from-sky-400 via-indigo-500 to-purple-500 transition-all\"\n                  style={{ width: `${completionPercent}%` }}\n                />\n              </div>\n              <Button variant=\"secondary\" size=\"sm\" onClick={handleModuleComplete}>\n                Mark Module Complete\n                  </Button>\n            </Card>\n\n            <Card className=\"space-y-3 border border-gray-200 bg-white p-5 text-sm text-gray-600 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300\">\n              <p>\n                Lessons automatically mark as in progress when opened. Use the controls below each lesson to record completion or retake the quiz at any time.\n              </p>\n          </Card>\n\n            <div className=\"space-y-3\">\n              {module.lessons.map((lesson) => {\n                const status = getLessonStatus(lessonProgress, module.id, lesson.id);\n                const isActive = lesson.id === activeLesson?.id;\n  return (\n                <button\n                  key={lesson.id}\n                    onClick={() => setActiveLessonId(lesson.id)}\n                  className={`w-full rounded-2xl border px-4 py-4 text-left transition ${\n                      isActive\n                        ? 'border-blue-500 bg-blue-50 text-blue-700 dark:border-blue-500 dark:bg-blue-900/30 dark:text-blue-100'\n                        : 'border-gray-200 bg-white text-gray-700 hover:border-blue-300 hover:bg-blue-50/60 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 dark:hover:border-blue-400 dark:hover:bg-blue-900/20'\n                    }`}\n                  >\n                    <div className=\"flex items-center justify-between text-xs font-semibold uppercase tracking-[0.3em]\">\n                      <span className=\"flex items-center gap-2\">\n                        <i className={`${lessonTypeIcon[lesson.type]} text-lg`} />\n                        {lesson.title}\n                      </span>\n                      <span\n                        className={`flex items-center gap-1 ${\n                          status === 'completed'\n                            ? 'text-emerald-500'\n                            : status === 'in_progress'\n                            ? 'text-blue-400'\n                            : 'text-gray-400'\n                        }`}\n                      >\n                        {status === 'completed' && <i className=\"ri-checkbox-circle-fill\" />}\n                        {status === 'in_progress' && <i className=\"ri-time-line\" />}\n                        {status === 'not_started' && <i className=\"ri-circle-line\" />}\n                      </span>\n                    </div>\n                    <p className=\"mt-2 text-xs text-gray-500 dark:text-gray-400 capitalize\">{lesson.type}</p>\n                  </button>\n                );\n              })}\n                  </div>\n          </aside>\n\n          <section className=\"flex-1 space-y-6\">\n            {activeLesson ? (\n              <Card className=\"space-y-6 border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-gray-900\">\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center gap-3 text-xs font-semibold uppercase tracking-[0.3em] text-blue-400\">\n                    <i className={`${lessonTypeIcon[activeLesson.type]} text-lg`} />\n                    {activeLesson.type}\n                  </div>\n                  <h1 className=\"text-2xl font-semibold text-gray-900 dark:text-white\">{activeLesson.title}</h1>\n                </div>\n\n                {renderLessonContent()}\n\n                {activeLesson.type !== 'quiz' && (\n                  <div className=\"flex flex-wrap gap-3\">\n                    <Button size=\"sm\" variant=\"secondary\" onClick={() => handleLessonAction('in_progress')}>\n                      Mark In Progress\n                    </Button>\n                    <Button size=\"sm\" onClick={() => handleLessonAction('completed')}>\n                      Mark Completed\n                    </Button>\n                  </div>\n                )}\n\n                <div className=\"flex justify-between text-xs text-gray-500 dark:text-gray-400\">\n                  <span>Status: {lessonStatus.replace('_', ' ')}</span>\n                  <Button variant=\"ghost\" size=\"sm\" onClick={handleModuleComplete}>\n                    Complete Module\n                      </Button>\n                </div>\n              </Card>\n            ) : (\n              <Card className=\"border border-gray-200 bg-white p-10 text-center text-gray-500 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300\">\n                <p>Select a lesson to get started.</p>\n              </Card>\n            )}\n          </section>\n        </div>\n      </main>\n\n      <Navigation />\n    </div>\n  );\n}\n\n\n"],"names":["parseQuizPayload","content","parsed","convertQuizToQuestions","quizPayload","q","index","optionValues","opt","optIndex","lessonTypeIcon","answerKey","lessonId","questionId","AcademyModulePage","moduleSlug","useParams","navigate","useNavigate","modules","lessonProgress","loading","error","recordProgress","refresh","useAcademy","module","useMemo","item","activeLessonId","setActiveLessonId","useState","_b","_a","quizAnswers","setQuizAnswers","quizMeta","setQuizMeta","useEffect","lesson","activeLesson","getLessonStatus","completedLessons","entry","totalLessons","completionPercent","lessonStatus","activeQuizMeta","handleLessonAction","status","handleModuleComplete","handleQuizAnswerChange","value","prev","handleQuizSubmit","quizQuestions","correctCount","acc","question","score","jsx","jsxs","Card","Button","renderLessonContent","submitted","selected","option","isChecked","isCorrect","isIncorrect","sections","paragraph","idx","Header","isActive","Navigation"],"mappings":"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"}