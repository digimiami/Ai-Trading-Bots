import{u as J,c as X,r as h,j as e}from"./index-11de833d.js";import{H as q}from"./Header-7b35ec3b.js";import{N as G}from"./Navigation-ffc91fd0.js";import{B as r}from"./Button-fda56067.js";import{C as $}from"./Card-119e7607.js";import{u as K}from"./useBots-c1be9635.js";import{u as Q}from"./useBotActivity-4bd4a5ab.js";function le(){const o=J(),{bots:v,loading:S,startBot:b,stopBot:w,updateBot:d,deleteBot:A}=K(),{activities:E,addLog:c}=Q(v),{isExecuting:x,lastExecution:k,timeSync:f,executeBot:L,executeAllBots:z}=X(),[y,M]=h.useState("all"),[m,n]=h.useState(!1),[j,F]=h.useState(null),[u,g]=h.useState(null),i=v.filter(s=>y==="all"||s.status===y),T=s=>E.find(t=>t.botId===s),p=s=>{switch(s){case"info":return"text-blue-600 bg-blue-50";case"warning":return"text-yellow-600 bg-yellow-50";case"error":return"text-red-600 bg-red-50";case"success":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},B=s=>{switch(s){case"market":return"ri-line-chart-line";case"trade":return"ri-exchange-line";case"strategy":return"ri-brain-line";case"system":return"ri-settings-line";case"error":return"ri-error-warning-line";default:return"ri-information-line"}},C=s=>new Date(s).toLocaleTimeString(),P=s=>{switch(s){case"running":return"bg-green-100 text-green-800";case"paused":return"bg-yellow-100 text-yellow-800";case"stopped":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},R=s=>{switch(s){case"low":return"text-green-600";case"medium":return"text-yellow-600";case"high":return"text-red-600";default:return"text-gray-600"}},N=async(s,t)=>{try{t==="start"?(await b(s),await c(s,{level:"success",category:"system",message:"Bot started successfully",details:{action:"start",timestamp:new Date().toISOString()}})):t==="stop"?(await w(s),await c(s,{level:"info",category:"system",message:"Bot stopped by user",details:{action:"stop",timestamp:new Date().toISOString()}})):t==="pause"&&(await d(s,{status:"paused"}),await c(s,{level:"warning",category:"system",message:"Bot paused by user",details:{action:"pause",timestamp:new Date().toISOString()}}))}catch(l){console.error("Failed to update bot:",l),await c(s,{level:"error",category:"error",message:`Failed to ${t} bot: ${l}`,details:{action:t,error:l instanceof Error?l.message:String(l)}})}},D=async()=>{n(!0);try{const s=i.filter(t=>t.status==="stopped"||t.status==="paused");await Promise.all(s.map(t=>b(t.id)))}catch(s){console.error("Failed to start all bots:",s)}finally{n(!1)}},I=async()=>{n(!0);try{const s=i.filter(t=>t.status==="running"||t.status==="paused");await Promise.all(s.map(t=>w(t.id)))}catch(s){console.error("Failed to stop all bots:",s)}finally{n(!1)}},_=async()=>{if(confirm("Are you sure you want to reset all bot statistics? This will set PnL, trades count, and win rate to zero.")){n(!0);try{await Promise.all(i.map(s=>d(s.id,{total_trades:0,win_rate:0,pnl:0,pnl_percentage:0,last_trade_at:null}))),console.log("All bot statistics reset successfully")}catch(s){console.error("Failed to reset all bots:",s)}finally{n(!1)}}},O=async()=>{if(confirm("Are you sure you want to delete all bots? This action cannot be undone.")){n(!0);try{await Promise.all(i.map(s=>A(s.id))),console.log("All bots deleted successfully")}catch(s){console.error("Failed to delete all bots:",s)}finally{n(!1)}}},H=async(s,t)=>{if(confirm(`Are you sure you want to reset "${t}" statistics? This will set PnL, trades count, and win rate to zero.`))try{await d(s,{total_trades:0,win_rate:0,pnl:0,pnl_percentage:0,last_trade_at:null}),console.log(`Bot "${t}" statistics reset successfully`)}catch(l){console.error(`Failed to reset bot "${t}":`,l)}},U=async(s,t)=>{if(confirm(`Are you sure you want to delete "${t}"? This action cannot be undone.`))try{await A(s),console.log(`Bot "${t}" deleted successfully`)}catch(l){console.error(`Failed to delete bot "${t}":`,l)}},V=s=>{o(`/edit-bot/${s}`)},W=async(s,t)=>{if(u===s){console.log("Already toggling AI/ML for this bot, please wait...");return}try{g(s),await d(s,{aiMlEnabled:!t}),c(s,{level:"info",category:"system",message:`AI/ML ${t?"disabled":"enabled"} for bot`})}catch(l){console.error("Failed to toggle AI/ML:",l),c(s,{level:"error",category:"system",message:"Failed to toggle AI/ML"})}finally{g(null)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(q,{title:"Trading Bots",action:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(r,{variant:"warning",size:"sm",onClick:z,disabled:x||i.filter(s=>s.status==="running").length===0,children:[e.jsx("i",{className:"ri-play-circle-line mr-1"}),"Execute All"]}),e.jsxs(r,{variant:"success",size:"sm",onClick:D,disabled:m||i.filter(s=>s.status==="stopped"||s.status==="paused").length===0,children:[e.jsx("i",{className:"ri-play-line mr-1"}),"Start All"]}),e.jsxs(r,{variant:"secondary",size:"sm",onClick:I,disabled:m||i.filter(s=>s.status==="running"||s.status==="paused").length===0,children:[e.jsx("i",{className:"ri-stop-line mr-1"}),"Stop All"]}),e.jsxs(r,{variant:"secondary",size:"sm",onClick:_,disabled:m||i.length===0,children:[e.jsx("i",{className:"ri-refresh-line mr-1"}),"Reset All"]}),e.jsxs(r,{variant:"danger",size:"sm",onClick:O,disabled:m||i.length===0,children:[e.jsx("i",{className:"ri-delete-bin-line mr-1"}),"Delete All"]}),e.jsxs(r,{variant:"primary",size:"sm",onClick:()=>o("/create-bot"),children:[e.jsx("i",{className:"ri-add-line mr-1"}),"New Bot"]})]})}),e.jsx("div",{className:"pt-20 pb-20 px-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-4",children:[e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${x?"bg-yellow-500 animate-pulse":"bg-green-500"}`}),e.jsx("span",{className:"text-sm text-gray-600",children:x?"Executing...":"Ready"})]}),k&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Last execution: ",new Date(k).toLocaleTimeString()]}),f&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Time sync: ",f.offset>0?"+":"",f.offset,"ms"]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Auto-execution every 5 minutes"})]})}),e.jsx("div",{className:"flex space-x-2 overflow-x-auto",children:["all","running","paused","stopped"].map(s=>e.jsx("button",{onClick:()=>M(s),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap ${y===s?"bg-blue-600 text-white":"bg-white text-gray-600 border border-gray-200"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),e.jsx("div",{className:"space-y-4",children:S?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading bots..."})]}):i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-robot-line text-4xl text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No bots found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first trading bot to get started"}),e.jsxs(r,{onClick:()=>o("/create-bot"),children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Create Bot"]})]}):i.map(s=>e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:`${s.exchange==="bybit"?"ri-currency-line":"ri-exchange-line"} text-blue-600 text-xl`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.symbol," • ",s.exchange.toUpperCase()]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${P(s.status)}`,children:s.status}),e.jsxs("span",{className:`text-xs font-medium ${R(s.riskLevel)}`,children:[s.riskLevel," risk"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-lg font-bold ${s.pnl>=0?"text-green-600":"text-red-600"}`,children:[s.pnl>=0?"+":"","$",s.pnl.toFixed(2)]}),e.jsxs("p",{className:`text-sm ${s.pnlPercentage>=0?"text-green-600":"text-red-600"}`,children:[s.pnlPercentage>=0?"+":"",s.pnlPercentage.toFixed(2),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Trades"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.totalTrades})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Win Rate"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[s.winRate,"%"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Leverage"}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[s.leverage,"x"]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-brain-line text-2xl text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"AI Self-Learning"}),e.jsx("p",{className:"text-xs text-gray-600",children:s.aiMlEnabled?"Bot learns from trades and optimizes automatically":"Enable to let AI optimize your bot strategy"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.aiMlEnabled||!1,onChange:async()=>{g(s.id);try{await d(s.id,{aiMlEnabled:!s.aiMlEnabled})}catch(t){console.error("Error toggling AI/ML:",t)}finally{g(null)}},className:"sr-only peer",disabled:u===s.id}),e.jsx("div",{className:"w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-blue-600"})]})]}),s.aiMlEnabled&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-300",children:e.jsxs("button",{onClick:()=>alert(`🎯 AI Learning Analysis

Bot: ${s.name}

AI will analyze:
• Win rate patterns
• Best/worst performing pairs
• RSI/ADX effectiveness
• Stop loss/take profit optimization
• Risk assessment

Coming soon: Full AI recommendations!`),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:[e.jsx("i",{className:"ri-microscope-line mr-2"}),"Analyze Bot Performance Now"]})})]}),s.aiMlEnabled&&e.jsx("div",{className:"mb-4 p-3 bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:"ri-brain-line text-2xl text-purple-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"AI Self-Learning Enabled"}),e.jsx("p",{className:"text-xs text-gray-600",children:"This bot learns and improves automatically"})]})]}),e.jsxs("button",{onClick:t=>{t.stopPropagation(),alert(`AI Learning Analysis coming soon!

View AI recommendations and auto-optimization for bot: ${s.name}`)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm font-medium",children:[e.jsx("i",{className:"ri-microscope-line mr-2"}),"View AI Analysis"]})]})}),(()=>{const t=T(s.id),l=(t==null?void 0:t.logs.slice(0,3))||[];return e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Recent Activity"}),e.jsx("button",{onClick:()=>F(j===s.id?null:s.id),className:"text-xs text-blue-600 hover:text-blue-800",children:j===s.id?"Hide":"Show All"})]}),t&&e.jsxs("div",{className:"flex space-x-4 mb-3 text-xs",children:[e.jsxs("span",{className:"text-green-600",children:["✓ ",t.successCount]}),e.jsxs("span",{className:"text-yellow-600",children:["⚠ ",t.logs.filter(a=>a.level==="warning").length]}),e.jsxs("span",{className:"text-red-600",children:["✗ ",t.errorCount]}),e.jsxs("span",{className:"text-gray-500",children:["📊 ",t.logs.length," total"]})]}),e.jsx("div",{className:"space-y-2",children:l.length===0?e.jsxs("div",{className:"text-center py-4 text-gray-500 text-sm",children:[e.jsx("i",{className:"ri-file-list-line text-lg mb-1"}),e.jsx("p",{children:"No activity logs yet"})]}):l.map(a=>e.jsxs("div",{className:"flex items-start space-x-2 p-2 bg-gray-50 rounded text-xs",children:[e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${p(a.level)}`,children:e.jsx("i",{className:`${B(a.category)} text-xs`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`px-1 py-0.5 rounded text-xs font-medium ${p(a.level)}`,children:a.level}),e.jsx("span",{className:"text-gray-500",children:C(a.timestamp)})]}),e.jsx("p",{className:"text-gray-700 mt-1 truncate",children:a.message})]})]},a.id))}),j===s.id&&t&&t.logs.length>3&&e.jsx("div",{className:"mt-3 space-y-2 max-h-48 overflow-y-auto",children:t.logs.slice(3).map(a=>e.jsxs("div",{className:"flex items-start space-x-2 p-2 bg-gray-50 rounded text-xs",children:[e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center ${p(a.level)}`,children:e.jsx("i",{className:`${B(a.category)} text-xs`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`px-1 py-0.5 rounded text-xs font-medium ${p(a.level)}`,children:a.level}),e.jsx("span",{className:"text-gray-500",children:C(a.timestamp)})]}),e.jsx("p",{className:"text-gray-700 mt-1",children:a.message}),a.details&&e.jsxs("details",{className:"mt-1",children:[e.jsx("summary",{className:"cursor-pointer text-gray-500 hover:text-gray-700",children:"Details"}),e.jsx("pre",{className:"mt-1 p-1 bg-white rounded border text-xs overflow-x-auto",children:JSON.stringify(a.details,null,2)})]})]})]},a.id))})]})})(),e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex space-x-2 mb-2",children:[s.status==="running"?e.jsxs(e.Fragment,{children:[e.jsxs(r,{variant:"warning",size:"sm",className:"flex-1",onClick:()=>L(s.id),disabled:x,children:[e.jsx("i",{className:"ri-play-circle-line mr-1"}),"Execute"]}),e.jsxs(r,{variant:"secondary",size:"sm",onClick:()=>N(s.id,"pause"),children:[e.jsx("i",{className:"ri-pause-line mr-1"}),"Pause"]})]}):e.jsxs(r,{variant:"success",size:"sm",className:"flex-1",onClick:()=>N(s.id,"start"),children:[e.jsx("i",{className:"ri-play-line mr-1"}),"Start"]}),e.jsx(r,{variant:"danger",size:"sm",onClick:()=>N(s.id,"stop"),children:e.jsx("i",{className:"ri-stop-line"})}),e.jsx(r,{variant:"secondary",size:"sm",onClick:()=>o("/bot-activity"),children:e.jsx("i",{className:"ri-file-list-line"})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:"ri-brain-line text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"AI/ML System"})]}),e.jsx("button",{onClick:()=>W(s.id,s.aiMlEnabled||!1),disabled:u===s.id,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${u===s.id?"opacity-50 cursor-not-allowed":""} ${s.aiMlEnabled?"bg-purple-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s.aiMlEnabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(r,{variant:"primary",size:"sm",className:"flex-1",onClick:()=>V(s.id),children:[e.jsx("i",{className:"ri-edit-line mr-1"}),"Edit"]}),e.jsxs(r,{variant:"warning",size:"sm",className:"flex-1",onClick:()=>H(s.id,s.name),children:[e.jsx("i",{className:"ri-refresh-line mr-1"}),"Reset"]}),e.jsxs(r,{variant:"danger",size:"sm",className:"flex-1",onClick:()=>U(s.id,s.name),children:[e.jsx("i",{className:"ri-delete-bin-line mr-1"}),"Delete"]})]})]})]},s.id))})]})}),e.jsx(G,{})]})}export{le as default};
//# sourceMappingURL=page-34bcda88.js.map
