import{r as $,j as e,g as O,s as C}from"./index-7db8efba.js";import{H as U}from"./Header-51f5643b.js";import{N as W}from"./Navigation-03d82daa.js";import{B as _}from"./Button-9007c314.js";import{C as w}from"./Card-5e232337.js";import{u as z}from"./useBotActivity-74e11b20.js";import{u as G}from"./useBots-7cb4b4d9.js";function V({activity:t,onClearLogs:i,onSimulateActivity:u}){const[f,N]=$.useState(!1),[x,y]=$.useState("all"),[o,p]=$.useState("");$.useEffect(()=>{const n=()=>{if(t.lastActivity){const A=Date.now()-new Date(t.lastActivity).getTime(),l=Math.floor(A/1e3),h=Math.floor(l/60),R=Math.floor(h/60);R>0?p(`${R}h ${h%60}m ago`):h>0?p(`${h}m ${l%60}s ago`):p(`${l}s ago`)}};n();const L=setInterval(n,1e3);return()=>clearInterval(L)},[t.lastActivity]);const a=n=>{switch(n){case"info":return"text-blue-600 bg-blue-50";case"warning":return"text-yellow-600 bg-yellow-50";case"error":return"text-red-600 bg-red-50";case"success":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},S=n=>{switch(n){case"market":return"ri-line-chart-line";case"trade":return"ri-exchange-line";case"strategy":return"ri-brain-line";case"system":return"ri-settings-line";case"error":return"ri-error-warning-line";default:return"ri-information-line"}},s=n=>{switch(n){case"running":return"ri-play-circle-fill text-green-500";case"paused":return"ri-pause-circle-fill text-yellow-500";case"stopped":return"ri-stop-circle-fill text-red-500";default:return"ri-question-mark-circle-fill text-gray-500"}},d=n=>{switch(n){case"executing":return{icon:"ri-loader-4-line animate-spin",color:"bg-purple-100 text-purple-800 border-purple-200",label:"Executing",badge:"Executing Trade"};case"analyzing":return{icon:"ri-bar-chart-line",color:"bg-blue-100 text-blue-800 border-blue-200",label:"Analyzing",badge:"Analyzing Market"};case"waiting":return{icon:"ri-time-line",color:"bg-yellow-100 text-yellow-800 border-yellow-200",label:"Waiting",badge:"Waiting for Signal"};case"error":return{icon:"ri-error-warning-line",color:"bg-red-100 text-red-800 border-red-200",label:"Error",badge:"Error Detected"};case"idle":return{icon:"ri-pause-line",color:"bg-gray-100 text-gray-800 border-gray-200",label:"Idle",badge:"Not Running"};default:return{icon:"ri-question-line",color:"bg-gray-100 text-gray-800 border-gray-200",label:"Unknown",badge:"Unknown State"}}},m=t.logs.filter(n=>x==="all"||n.level===x),c=t.logs.find(n=>{var L,A;return((L=n.message)==null?void 0:L.includes("Performance Update"))||((A=n.details)==null?void 0:A.winTrades)!==void 0}),r=(c==null?void 0:c.details)||null,g=(r==null?void 0:r.winTrades)||0,v=(r==null?void 0:r.lossTrades)||0,b=(r==null?void 0:r.drawdown)||0,j=(r==null?void 0:r.drawdownPercentage)||0,P=(r==null?void 0:r.winRate)||0,T=(r==null?void 0:r.totalTrades)||0,E=n=>new Date(n).toLocaleTimeString();return e.jsxs(w,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("i",{className:`${s(t.status)} text-xl`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.botName}),t.executionState&&e.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium border ${d(t.executionState).color}`,children:[e.jsx("i",{className:`${d(t.executionState).icon} mr-1`}),d(t.executionState).badge]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:t.currentAction||"No recent activity"}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[o&&e.jsxs("span",{children:[e.jsx("i",{className:"ri-time-line mr-1"}),o]}),t.lastExecutionTime&&e.jsxs("span",{children:[e.jsx("i",{className:"ri-exchange-line mr-1"}),"Last trade: ",new Date(t.lastExecutionTime).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.status}),e.jsx(_,{variant:"secondary",size:"sm",onClick:()=>N(!f),children:e.jsx("i",{className:`ri-${f?"arrow-up":"arrow-down"}-line`})})]})]}),r&&e.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-line-chart-line mr-2 text-blue-600"}),"Performance Metrics"]}),c&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Updated: ",E(c.timestamp)]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Win Trades"}),e.jsx("i",{className:"ri-arrow-up-line text-green-600"})]}),e.jsx("div",{className:"text-xl font-bold text-green-600",children:g}),e.jsxs("div",{className:"text-xs text-gray-500",children:[T>0?`${(g/T*100).toFixed(1)}%`:"0%"," of total"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-red-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Loss Trades"}),e.jsx("i",{className:"ri-arrow-down-line text-red-600"})]}),e.jsx("div",{className:"text-xl font-bold text-red-600",children:v}),e.jsxs("div",{className:"text-xs text-gray-500",children:[T>0?`${(v/T*100).toFixed(1)}%`:"0%"," of total"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Win Rate"}),e.jsx("i",{className:"ri-percent-line text-blue-600"})]}),e.jsxs("div",{className:"text-xl font-bold text-blue-600",children:[P.toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[T," total trades"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-orange-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Drawdown"}),e.jsx("i",{className:"ri-line-chart-line text-orange-600"})]}),e.jsxs("div",{className:"text-xl font-bold text-orange-600",children:["$",b.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[j.toFixed(1),"% of peak"]})]})]}),r.peakPnL!==void 0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200 grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Peak P&L:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["$",(r.peakPnL||0).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Current P&L:"}),e.jsxs("span",{className:`font-medium ${(r.currentPnL||0)>=0?"text-green-600":"text-red-600"}`,children:["$",(r.currentPnL||0).toFixed(2)]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:t.logs.length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Logs"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:t.successCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Success"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-yellow-600",children:t.logs.filter(n=>n.level==="warning").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Warnings"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:t.errorCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Errors"})]})]}),e.jsx("div",{className:"mb-4 p-3 rounded-lg border-2",style:{backgroundColor:t.executionState==="executing"?"#f3e8ff":t.executionState==="analyzing"?"#eff6ff":t.executionState==="waiting"?"#fefce8":t.executionState==="error"?"#fef2f2":"#f9fafb",borderColor:t.executionState==="executing"?"#c084fc":t.executionState==="analyzing"?"#60a5fa":t.executionState==="waiting"?"#eab308":t.executionState==="error"?"#f87171":"#e5e7eb"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[t.executionState&&e.jsx("i",{className:`${d(t.executionState).icon} text-lg ${t.executionState==="executing"?"text-purple-600":t.executionState==="analyzing"?"text-blue-600":t.executionState==="waiting"?"text-yellow-600":t.executionState==="error"?"text-red-600":"text-gray-600"}`}),e.jsxs("div",{children:[e.jsxs("span",{className:`text-sm font-medium ${t.executionState==="executing"?"text-purple-800":t.executionState==="analyzing"?"text-blue-800":t.executionState==="waiting"?"text-yellow-800":t.executionState==="error"?"text-red-800":"text-gray-800"}`,children:[t.executionState?d(t.executionState).label:"Status",":"]}),e.jsx("span",{className:`ml-2 text-sm ${t.executionState==="executing"?"text-purple-700":t.executionState==="analyzing"?"text-blue-700":t.executionState==="waiting"?"text-yellow-700":t.executionState==="error"?"text-red-700":"text-gray-700"}`,children:t.currentAction||"No activity"})]})]}),t.waitingFor&&e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("i",{className:"ri-hourglass-line mr-1"}),t.waitingFor]})]})}),f&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex space-x-2",children:["all","info","warning","error","success"].map(n=>e.jsx("button",{onClick:()=>y(n),className:`px-3 py-1 rounded-full text-xs font-medium ${x===n?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:n.charAt(0).toUpperCase()+n.slice(1)},n))}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:m.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-file-list-line text-2xl mb-2"}),e.jsx("p",{children:"No logs found"})]}):m.map(n=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${a(n.level)}`,children:e.jsx("i",{className:`${S(n.category)} text-sm`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a(n.level)}`,children:n.level}),e.jsx("span",{className:"text-xs text-gray-500",children:E(n.timestamp)})]}),e.jsx("p",{className:"text-sm text-gray-900 mb-1",children:n.message}),n.details&&e.jsxs("details",{className:"text-xs text-gray-600",children:[e.jsx("summary",{className:"cursor-pointer hover:text-gray-800",children:"Details"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded border text-xs overflow-x-auto",children:JSON.stringify(n.details,null,2)})]})]})]},n.id))}),e.jsxs("div",{className:"flex space-x-2 pt-4 border-t border-gray-200",children:[e.jsxs(_,{variant:"secondary",size:"sm",onClick:()=>u(t.botId),children:[e.jsx("i",{className:"ri-play-line mr-1"}),"Simulate Activity"]}),e.jsxs(_,{variant:"danger",size:"sm",onClick:()=>i(t.botId),children:[e.jsx("i",{className:"ri-delete-bin-line mr-1"}),"Clear Logs"]})]})]})]})}const k={}.VITE_PUBLIC_SUPABASE_URL||{}.VITE_SUPABASE_URL,M={}.VITE_PUBLIC_SUPABASE_ANON_KEY||{}.VITE_SUPABASE_ANON_KEY;async function Y(){const t=O(k,M),{data:{session:i}}=await t.auth.getSession();if(!i)throw new Error("Not authenticated");const u=await fetch(`${k}/functions/v1/bot-report`,{method:"GET",headers:{Authorization:`Bearer ${i.access_token}`,"Content-Type":"application/json"}});if(!u.ok){const N=await u.json();throw new Error(N.error||"Failed to generate report")}return(await u.json()).report}function J(){const[t,i]=$.useState(null),[u,f]=$.useState(!1),[N,x]=$.useState(null),y=async()=>{f(!0),x(null);try{const a=await Y();i(a)}catch(a){x(a.message||"Failed to generate report")}finally{f(!1)}},o=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(a),p=(a,S)=>{if(a)if(S==="json"){const s=JSON.stringify(a,null,2),d=new Blob([s],{type:"application/json"}),m=URL.createObjectURL(d),c=document.createElement("a");c.href=m,c.download=`bot-performance-report-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(m)}else{let s=`Bot Performance Report
`;s+=`Generated: ${new Date(a.generated_at).toLocaleString()}

`,s+=`OVERVIEW SUMMARY
`,s+=`Total Bots,${a.overview.total_bots}
`,s+=`Active Bots,${a.overview.active_bots}
`,s+=`Total P&L,${a.overview.total_pnl.toFixed(2)}
`,s+=`Total Fees Paid,${a.overview.total_fees.toFixed(2)}
`,s+=`Net Profit/Loss,${a.overview.net_profit_loss.toFixed(2)}
`,s+=`Total Trades,${a.overview.total_trades}

`,a.contract_summary&&a.contract_summary.length>0&&(s+=`CONTRACT PERFORMANCE
`,s+=`Contract,Exchange,Trades,Total P&L,Total Fees Paid,Net Profit/Loss
`,a.contract_summary.forEach(r=>{s+=`${r.contract},${r.exchange},${r.total_trades},${r.total_net_pnl.toFixed(2)},${r.total_fees_paid.toFixed(2)},${r.net_profit_loss.toFixed(2)}
`}),s+=`
`),a.active_bots&&a.active_bots.length>0&&(s+=`ACTIVE BOTS
`,s+=`Bot Name,Symbol,Exchange,P&L,Total Fees,Net Profit/Loss,Total Trades,Win Rate
`,a.active_bots.forEach(r=>{s+=`${r.name},${r.symbol},${r.exchange},${r.pnl.toFixed(2)},${(r.total_fees||0).toFixed(2)},${(r.net_profit_loss||0).toFixed(2)},${r.total_trades},${r.win_rate.toFixed(2)}%
`}));const d=new Blob([s],{type:"text/csv;charset=utf-8;"}),m=URL.createObjectURL(d),c=document.createElement("a");c.href=m,c.download=`bot-performance-report-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(m)}};return e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bot Performance Report"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Generate comprehensive report with P&L and fees"})]}),e.jsxs("div",{className:"flex space-x-2",children:[t&&e.jsxs(_,{variant:"secondary",onClick:()=>p(t,"csv"),children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Download CSV"]}),t&&e.jsxs(_,{variant:"secondary",onClick:()=>p(t,"json"),children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Download JSON"]}),e.jsx(_,{variant:"primary",onClick:y,disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-file-chart-line mr-2"}),"Generate Report"]})})]})]}),N&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600 text-sm",children:N})}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Overview Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.overview.total_bots}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Bots"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.overview.active_bots}),e.jsx("div",{className:"text-sm text-gray-500",children:"Active Bots"})]}),e.jsxs("div",{children:[e.jsx("div",{className:`text-2xl font-bold ${t.overview.total_pnl>=0?"text-green-600":"text-red-600"}`,children:o(t.overview.total_pnl)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total P&L"})]}),e.jsxs("div",{children:[e.jsx("div",{className:`text-2xl font-bold ${t.overview.net_profit_loss>=0?"text-green-600":"text-red-600"}`,children:o(t.overview.net_profit_loss)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Net Profit/Loss"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-700",children:o(t.overview.total_fees)}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Fees Paid"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-700",children:t.overview.total_trades}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Trades"})]}),e.jsx("div",{children:e.jsxs("div",{className:"text-xs text-gray-500",children:["Generated: ",new Date(t.generated_at).toLocaleString()]})})]})]}),t.contract_summary&&t.contract_summary.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Contract Performance"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Contract"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Exchange"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Trades"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Win/Loss"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Win Rate"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Total P&L"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Fees"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Net Profit/Loss"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Drawdown"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Peak/Current P&L"})]})}),e.jsx("tbody",{children:t.contract_summary.map((a,S)=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:a.contract}),e.jsx("td",{className:"py-2 px-3 text-gray-600",children:a.exchange}),e.jsx("td",{className:"py-2 px-3 text-right",children:a.total_trades}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("span",{className:"text-green-600 font-medium",children:a.win_trades||0}),e.jsx("span",{className:"text-gray-400 mx-1",children:"/"}),e.jsx("span",{className:"text-red-600 font-medium",children:a.loss_trades||0})]}),e.jsx("td",{className:"py-2 px-3 text-right",children:e.jsxs("span",{className:`font-medium ${(a.win_rate||0)>=50?"text-green-600":"text-red-600"}`,children:[(a.win_rate||0).toFixed(1),"%"]})}),e.jsx("td",{className:`py-2 px-3 text-right font-medium ${a.total_net_pnl>=0?"text-green-600":"text-red-600"}`,children:o(a.total_net_pnl)}),e.jsx("td",{className:"py-2 px-3 text-right text-gray-600",children:o(a.total_fees_paid)}),e.jsx("td",{className:`py-2 px-3 text-right font-semibold ${a.net_profit_loss>=0?"text-green-600":"text-red-600"}`,children:o(a.net_profit_loss)}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("div",{className:"text-red-600 font-medium",children:o(a.drawdown||0)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(a.drawdown_percentage||0).toFixed(1),"%"]})]}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("div",{className:"text-green-600 font-medium",children:o(a.peak_pnl||0)}),e.jsx("div",{className:`text-xs font-medium ${(a.current_pnl||0)>=0?"text-green-600":"text-red-600"}`,children:o(a.current_pnl||0)})]})]},S))})]})})]}),t.active_bots&&t.active_bots.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Active Bots"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Bot Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Symbol"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Exchange"}),e.jsx("th",{className:"text-right py-2 px-3",children:"P&L"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Fees"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Net Profit/Loss"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Trades"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Win/Loss"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Win Rate"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Drawdown"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Peak/Current P&L"})]})}),e.jsx("tbody",{children:t.active_bots.map(a=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:a.name}),e.jsx("td",{className:"py-2 px-3 text-gray-600",children:a.symbol}),e.jsx("td",{className:"py-2 px-3 text-gray-600",children:a.exchange}),e.jsx("td",{className:`py-2 px-3 text-right font-medium ${a.pnl>=0?"text-green-600":"text-red-600"}`,children:o(a.pnl)}),e.jsx("td",{className:"py-2 px-3 text-right text-gray-600",children:o(a.total_fees||0)}),e.jsx("td",{className:`py-2 px-3 text-right font-semibold ${(a.net_profit_loss||0)>=0?"text-green-600":"text-red-600"}`,children:o(a.net_profit_loss||0)}),e.jsx("td",{className:"py-2 px-3 text-right",children:a.total_trades}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("span",{className:"text-green-600 font-medium",children:a.win_trades||0}),e.jsx("span",{className:"text-gray-400 mx-1",children:"/"}),e.jsx("span",{className:"text-red-600 font-medium",children:a.loss_trades||0})]}),e.jsx("td",{className:"py-2 px-3 text-right",children:e.jsxs("span",{className:`font-medium ${a.win_rate>=50?"text-green-600":"text-red-600"}`,children:[a.win_rate.toFixed(1),"%"]})}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("div",{className:"text-red-600 font-medium",children:o(a.drawdown||0)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(a.drawdown_percentage||0).toFixed(1),"%"]})]}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("div",{className:"text-green-600 font-medium",children:o(a.peak_pnl||0)}),e.jsx("div",{className:`text-xs font-medium ${(a.current_pnl||0)>=0?"text-green-600":"text-red-600"}`,children:o(a.current_pnl||0)})]})]},a.id))})]})})]})]})]})}async function q(t,i){const{data:{user:u}}=await C.auth.getUser();if(!u)throw new Error("Not authenticated");const f=i||new Date,N=t||new Date(Date.now()-7*24*60*60*1e3),{data:x,error:y}=await C.from("trading_bots").select("id, name, status").eq("user_id",u.id);if(y)throw y;const o=(x==null?void 0:x.map(l=>l.id))||[];let p=[];if(o.length>0){const{data:l,error:h}=await C.from("bot_activity_logs").select("*").in("bot_id",o).gte("timestamp",N.toISOString()).lte("timestamp",f.toISOString()).order("timestamp",{ascending:!1}).limit(1e4);if(h)throw h;p=l||[]}const{data:a,error:S}=await C.from("trades").select("pnl, status, created_at").eq("user_id",u.id).gte("created_at",N.toISOString()).lte("created_at",f.toISOString());if(S)throw S;const s=(x==null?void 0:x.length)||0,d=(x==null?void 0:x.filter(l=>l.status==="running").length)||0,m=p.length,c=p.filter(l=>l.level==="error").length,r=p.filter(l=>l.level==="warning").length,g=p.filter(l=>l.level==="success").length,v=p.filter(l=>l.level==="info").length,b=(a==null?void 0:a.filter(l=>l.status==="filled"||l.status==="closed"))||[],j=b.length;b.reduce((l,h)=>l+(parseFloat(h.pnl||"0")||0),0);const P=b.filter(l=>(parseFloat(l.pnl||"0")||0)>0).length,T=j>0?P/j*100:0,E=new Map;x==null||x.forEach(l=>{E.set(l.id,{bot_id:l.id,bot_name:l.name,status:l.status,total_logs:0,errors:0,warnings:0,successes:0,last_activity:"",recent_logs:[]})}),p.forEach(l=>{const h=E.get(l.bot_id);h&&(h.total_logs++,l.level==="error"&&h.errors++,l.level==="warning"&&h.warnings++,l.level==="success"&&h.successes++,(!h.last_activity||l.timestamp>h.last_activity)&&(h.last_activity=l.timestamp),h.recent_logs.length<10&&h.recent_logs.push({timestamp:l.timestamp,level:l.level,category:l.category,message:l.message,details:l.details}))});const n=[];E.forEach((l,h)=>{var R;if(l.errors>0){const D=p.filter(F=>F.bot_id===h&&F.level==="error"),B=D.map(F=>F.message),I=Array.from(new Set(B.slice(0,5)));n.push({bot_name:l.bot_name,error_count:l.errors,last_error:((R=D[0])==null?void 0:R.timestamp)||"",common_errors:I})}});const{data:L}=await C.from("trading_bots").select("id, pnl").eq("user_id",u.id).in("id",o),A=(L==null?void 0:L.filter(l=>(parseFloat(l.pnl||"0")||0)>0).length)||0;return{generated_at:new Date().toISOString(),period:{start:N.toISOString(),end:f.toISOString()},overview:{total_bots:s,active_bots:d,total_logs:m,errors:c,warnings:r,successes:g,info_logs:v},bot_activity:Array.from(E.values()),performance_summary:{total_trades:j,total_pnl,win_rate:T,profitable_bots:A},errors_summary:n}}function K(){var d,m,c;const[t,i]=$.useState(null),[u,f]=$.useState(!1),[N,x]=$.useState(null),[y,o]=$.useState("7d"),p=async()=>{f(!0),x(null);try{let r;const g=new Date;switch(y){case"7d":r=new Date(Date.now()-7*24*60*60*1e3);break;case"30d":r=new Date(Date.now()-30*24*60*60*1e3);break;case"60d":r=new Date(Date.now()-60*24*60*60*1e3);break;case"90d":r=new Date(Date.now()-90*24*60*60*1e3);break;default:r=new Date(Date.now()-7*24*60*60*1e3)}const v=await q(r,g);i(v)}catch(r){x(r.message||"Failed to generate report"),console.error("Report generation error:",r)}finally{f(!1)}},a=()=>{if(!t)return;const r=H(t),g=window.open("","_blank");g&&(g.document.write(r),g.document.close(),g.focus(),setTimeout(()=>{g.print()},250))},S=()=>{if(!t)return;let r=`Activity Report
`;r+=`Generated: ${new Date(t.generated_at).toLocaleString()}
`,r+=`Period: ${new Date(t.period.start).toLocaleDateString()} - ${new Date(t.period.end).toLocaleDateString()}

`,r+=`OVERVIEW
`,r+=`Total Bots,${t.overview.total_bots}
`,r+=`Active Bots,${t.overview.active_bots}
`,r+=`Total Logs,${t.overview.total_logs}
`,r+=`Errors,${t.overview.errors}
`,r+=`Warnings,${t.overview.warnings}
`,r+=`Successes,${t.overview.successes}
`,r+=`Info Logs,${t.overview.info_logs}

`,r+=`PERFORMANCE SUMMARY
`,r+=`Total Trades,${t.performance_summary.total_trades}
`,r+=`Total P&L,${t.performance_summary.total_pnl.toFixed(2)}
`,r+=`Win Rate,${t.performance_summary.win_rate.toFixed(2)}%
`,r+=`Profitable Bots,${t.performance_summary.profitable_bots}

`,r+=`BOT ACTIVITY
`,r+=`Bot Name,Status,Total Logs,Errors,Warnings,Successes,Last Activity
`,t.bot_activity.forEach(j=>{r+=`${j.bot_name},${j.status},${j.total_logs},${j.errors},${j.warnings},${j.successes},${new Date(j.last_activity).toLocaleString()}
`}),r+=`
`,t.errors_summary.length>0&&(r+=`ERRORS SUMMARY
`,r+=`Bot Name,Error Count,Last Error,Common Errors
`,t.errors_summary.forEach(j=>{r+=`${j.bot_name},${j.error_count},${new Date(j.last_error).toLocaleString()},"${j.common_errors.join("; ")}"
`}));const g=new Blob([r],{type:"text/csv;charset=utf-8;"}),v=URL.createObjectURL(g),b=document.createElement("a");b.href=v,b.download=`activity-report-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(v)},s=()=>{if(!t)return;const r=JSON.stringify(t,null,2),g=new Blob([r],{type:"application/json"}),v=URL.createObjectURL(g),b=document.createElement("a");b.href=v,b.download=`activity-report-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(v)};return e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-file-chart-2-line mr-2 text-blue-600"}),"Activity Report Generator"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Generate comprehensive reports from bot activity logs"})]}),e.jsxs("div",{className:"flex space-x-2",children:[t&&e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"secondary",size:"sm",onClick:a,children:[e.jsx("i",{className:"ri-file-pdf-line mr-2"}),"Export PDF"]}),e.jsxs(_,{variant:"secondary",size:"sm",onClick:S,children:[e.jsx("i",{className:"ri-file-excel-line mr-2"}),"Export CSV"]}),e.jsxs(_,{variant:"secondary",size:"sm",onClick:s,children:[e.jsx("i",{className:"ri-file-code-line mr-2"}),"Export JSON"]})]}),e.jsx(_,{variant:"primary",size:"sm",onClick:p,disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-file-chart-line mr-2"}),"Generate Report"]})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Report Period"}),e.jsx("div",{className:"flex space-x-2",children:["7d","30d","60d","90d"].map(r=>e.jsxs("button",{onClick:()=>o(r),className:`px-3 py-2 rounded text-sm font-medium ${y===r?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Last ",r]},r))})]}),N&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600 text-sm",children:N})}),t&&e.jsxs("div",{className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Overview Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.overview.total_bots}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Bots"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.overview.active_bots}),e.jsx("div",{className:"text-sm text-gray-500",children:"Active Bots"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.overview.errors}),e.jsx("div",{className:"text-sm text-gray-500",children:"Errors"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.overview.warnings}),e.jsx("div",{className:"text-sm text-gray-500",children:"Warnings"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-700",children:t.overview.total_logs}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Logs"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-green-600",children:t.overview.successes}),e.jsx("div",{className:"text-xs text-gray-500",children:"Successes"})]}),e.jsx("div",{children:e.jsxs("div",{className:"text-xs text-gray-500",children:["Period: ",new Date(t.period.start).toLocaleDateString()," - ",new Date(t.period.end).toLocaleDateString()]})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Performance Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-700",children:t.performance_summary.total_trades}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Trades"})]}),e.jsxs("div",{className:`p-3 rounded-lg ${(((d=t.performance_summary)==null?void 0:d.total_pnl)||0)>=0?"bg-green-50":"bg-red-50"}`,children:[e.jsxs("div",{className:`text-lg font-semibold ${(((m=t.performance_summary)==null?void 0:m.total_pnl)||0)>=0?"text-green-600":"text-red-600"}`,children:["$",(((c=t.performance_summary)==null?void 0:c.total_pnl)||0).toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total P&L"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-700",children:[t.performance_summary.win_rate.toFixed(2),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Win Rate"})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-lg font-semibold text-green-600",children:t.performance_summary.profitable_bots}),e.jsx("div",{className:"text-xs text-gray-500",children:"Profitable Bots"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Bot Activity Details"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Bot Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Status"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Total Logs"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Errors"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Warnings"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Successes"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Last Activity"})]})}),e.jsx("tbody",{children:t.bot_activity.map((r,g)=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:r.bot_name}),e.jsx("td",{className:"py-2 px-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${r.status==="running"?"bg-green-100 text-green-800":r.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:r.status})}),e.jsx("td",{className:"py-2 px-3 text-right",children:r.total_logs}),e.jsx("td",{className:"py-2 px-3 text-right text-red-600",children:r.errors}),e.jsx("td",{className:"py-2 px-3 text-right text-yellow-600",children:r.warnings}),e.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:r.successes}),e.jsx("td",{className:"py-2 px-3 text-gray-600 text-xs",children:r.last_activity?new Date(r.last_activity).toLocaleString():"N/A"})]},g))})]})})]}),t.errors_summary.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3 text-red-600",children:"Errors Summary"}),e.jsx("div",{className:"space-y-2",children:t.errors_summary.map((r,g)=>e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:r.bot_name}),e.jsxs("span",{className:"text-red-600 font-semibold",children:[r.error_count," error(s)"]})]}),e.jsxs("div",{className:"text-xs text-gray-600 mb-1",children:["Last Error: ",new Date(r.last_error).toLocaleString()]}),e.jsxs("div",{className:"text-xs text-gray-700",children:[e.jsx("strong",{children:"Common Errors:"})," ",r.common_errors.join(", ")]})]},g))})]})]})]})}function H(t){return`
<!DOCTYPE html>
<html>
<head>
  <title>Activity Report - ${new Date().toISOString().split("T")[0]}</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      color: #333;
    }
    h1 {
      color: #2563eb;
      border-bottom: 2px solid #2563eb;
      padding-bottom: 10px;
    }
    h2 {
      color: #1f2937;
      margin-top: 30px;
      margin-bottom: 15px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f3f4f6;
      font-weight: bold;
    }
    .stat-box {
      display: inline-block;
      padding: 15px;
      margin: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      min-width: 150px;
    }
    .stat-value {
      font-size: 24px;
      font-weight: bold;
      color: #2563eb;
    }
    .stat-label {
      font-size: 12px;
      color: #666;
      margin-top: 5px;
    }
    .error-box {
      background-color: #fef2f2;
      border-left: 4px solid #ef4444;
      padding: 10px;
      margin: 10px 0;
    }
    @media print {
      body { padding: 0; }
      .no-print { display: none; }
    }
  </style>
</head>
<body>
  <h1>Bot Activity Report</h1>
  <p><strong>Generated:</strong> ${new Date(t.generated_at).toLocaleString()}</p>
  <p><strong>Period:</strong> ${new Date(t.period.start).toLocaleDateString()} - ${new Date(t.period.end).toLocaleDateString()}</p>
  
  <h2>Overview Summary</h2>
  <div>
    <div class="stat-box">
      <div class="stat-value">${t.overview.total_bots}</div>
      <div class="stat-label">Total Bots</div>
    </div>
    <div class="stat-box">
      <div class="stat-value">${t.overview.active_bots}</div>
      <div class="stat-label">Active Bots</div>
    </div>
    <div class="stat-box">
      <div class="stat-value">${t.overview.total_logs}</div>
      <div class="stat-label">Total Logs</div>
    </div>
    <div class="stat-box">
      <div class="stat-value" style="color: #ef4444;">${t.overview.errors}</div>
      <div class="stat-label">Errors</div>
    </div>
    <div class="stat-box">
      <div class="stat-value" style="color: #f59e0b;">${t.overview.warnings}</div>
      <div class="stat-label">Warnings</div>
    </div>
  </div>
  
  <h2>Performance Summary</h2>
  <table>
    <tr>
      <th>Metric</th>
      <th>Value</th>
    </tr>
    <tr>
      <td>Total Trades</td>
      <td>${t.performance_summary.total_trades}</td>
    </tr>
    <tr>
      <td>Total P&L</td>
      <td>$${t.performance_summary.total_pnl.toFixed(2)}</td>
    </tr>
    <tr>
      <td>Win Rate</td>
      <td>${t.performance_summary.win_rate.toFixed(2)}%</td>
    </tr>
    <tr>
      <td>Profitable Bots</td>
      <td>${t.performance_summary.profitable_bots}</td>
    </tr>
  </table>
  
  <h2>Bot Activity Details</h2>
  <table>
    <tr>
      <th>Bot Name</th>
      <th>Status</th>
      <th>Total Logs</th>
      <th>Errors</th>
      <th>Warnings</th>
      <th>Successes</th>
      <th>Last Activity</th>
    </tr>
    ${t.bot_activity.map(i=>`
    <tr>
      <td>${i.bot_name}</td>
      <td>${i.status}</td>
      <td>${i.total_logs}</td>
      <td>${i.errors}</td>
      <td>${i.warnings}</td>
      <td>${i.successes}</td>
      <td>${i.last_activity?new Date(i.last_activity).toLocaleString():"N/A"}</td>
    </tr>
    `).join("")}
  </table>
  
  ${t.errors_summary.length>0?`
  <h2>Errors Summary</h2>
  ${t.errors_summary.map(i=>`
  <div class="error-box">
    <strong>${i.bot_name}</strong> - ${i.error_count} error(s)<br>
    Last Error: ${new Date(i.last_error).toLocaleString()}<br>
    Common Errors: ${i.common_errors.join(", ")}
  </div>
  `).join("")}
  `:""}
  
  <script>
    window.onload = function() {
      setTimeout(function() {
        window.print();
      }, 500);
    };
  <\/script>
</body>
</html>
  `}function ae(){const{bots:t}=G(),{activities:i,loading:u,addLog:f,clearBotLogs:N,simulateBotActivity:x}=z(t),[y,o]=$.useState("all"),p=i.filter(s=>y==="all"||s.status===y),a=async s=>{await f(s,{level:"info",category:"system",message:"Manual test log added",details:{timestamp:new Date().toISOString(),source:"manual"}})},S=async s=>{await f(s,{level:"error",category:"error",message:"Simulated error for testing",details:{error:"Connection timeout",retry:!0}})};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(U,{title:"Bot Activity Logs",subtitle:"Monitor bot operations and debug issues",rightAction:e.jsx("div",{className:"flex space-x-2",children:e.jsxs(_,{variant:"primary",size:"sm",onClick:()=>window.location.reload(),children:[e.jsx("i",{className:"ri-refresh-line mr-1"}),"Refresh"]})})}),e.jsxs("div",{className:"pt-20 pb-20 px-4 space-y-6",children:[e.jsxs(w,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-pulse-line mr-2 text-blue-600 animate-pulse"}),"Recent Activity"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Updates every 10s"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.filter(s=>s.executionState==="executing").length>0&&e.jsxs("div",{className:"p-4 bg-purple-50 border-2 border-purple-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Executing"}),e.jsx("i",{className:"ri-loader-4-line animate-spin text-purple-600"})]}),e.jsxs("div",{className:"space-y-2",children:[i.filter(s=>s.executionState==="executing").slice(0,3).map(s=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-purple-900",children:s.botName}),e.jsxs("span",{className:"text-purple-700 ml-2",children:["• ",s.currentAction]})]},s.botId)),i.filter(s=>s.executionState==="executing").length>3&&e.jsxs("div",{className:"text-xs text-purple-600",children:["+",i.filter(s=>s.executionState==="executing").length-3," more"]})]})]}),i.filter(s=>s.executionState==="analyzing").length>0&&e.jsxs("div",{className:"p-4 bg-blue-50 border-2 border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Analyzing Market"}),e.jsx("i",{className:"ri-bar-chart-line text-blue-600"})]}),e.jsxs("div",{className:"space-y-2",children:[i.filter(s=>s.executionState==="analyzing").slice(0,3).map(s=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-blue-900",children:s.botName}),e.jsxs("span",{className:"text-blue-700 ml-2",children:["• ",s.currentAction]})]},s.botId)),i.filter(s=>s.executionState==="analyzing").length>3&&e.jsxs("div",{className:"text-xs text-blue-600",children:["+",i.filter(s=>s.executionState==="analyzing").length-3," more"]})]})]}),i.filter(s=>s.executionState==="waiting").length>0&&e.jsxs("div",{className:"p-4 bg-yellow-50 border-2 border-yellow-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-yellow-800",children:"Waiting"}),e.jsx("i",{className:"ri-time-line text-yellow-600"})]}),e.jsxs("div",{className:"space-y-2",children:[i.filter(s=>s.executionState==="waiting").slice(0,3).map(s=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-yellow-900",children:s.botName}),e.jsx("span",{className:"text-yellow-700 ml-2",children:s.waitingFor?`• Waiting: ${s.waitingFor}`:`• ${s.currentAction}`})]},s.botId)),i.filter(s=>s.executionState==="waiting").length>3&&e.jsxs("div",{className:"text-xs text-yellow-600",children:["+",i.filter(s=>s.executionState==="waiting").length-3," more"]})]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.filter(s=>s.executionState==="executing").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Executing"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.filter(s=>s.executionState==="analyzing").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Analyzing"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:i.filter(s=>s.executionState==="waiting").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Waiting"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.filter(s=>s.executionState==="error").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Errors"})]})]})]}),e.jsx("div",{className:"flex space-x-2 overflow-x-auto",children:["all","running","paused","stopped"].map(s=>e.jsx("button",{onClick:()=>o(s),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap ${y===s?"bg-blue-600 text-white":"bg-white text-gray-600 border border-gray-200"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:[e.jsxs(w,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Bots"})]}),e.jsxs(w,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.filter(s=>s.status==="running").length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Active"})]}),e.jsxs(w,{className:"p-4 text-center",children:[e.jsxs("div",{className:`text-2xl font-bold ${t.reduce((s,d)=>s+(d.pnl||0),0)>=0?"text-green-600":"text-red-600"}`,children:["$",t.reduce((s,d)=>s+(d.pnl||0),0).toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total PnL"})]}),e.jsxs(w,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.reduce((s,d)=>s+(d.totalTrades||0),0)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Trades"})]}),e.jsxs(w,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(()=>{const s=t.filter(m=>(m.totalTrades||0)>0);return`${(s.length>0?s.reduce((m,c)=>m+(c.winRate||0),0)/s.length:0).toFixed(1)}%`})()}),e.jsx("div",{className:"text-sm text-gray-500",children:"Win Rate"})]}),e.jsxs(w,{className:"p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[t.reduce((s,d)=>s+(d.winTrades||0),0),"/",t.reduce((s,d)=>s+(d.lossTrades||0),0)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Win/Loss"})]}),e.jsxs(w,{className:"p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["$",Math.abs(t.reduce((s,d)=>{const m=d.totalFees||d.total_fees||d.fees||0;return s+m},0)).toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Fees"})]}),e.jsxs(w,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:(()=>{let s=0,d=0,m=0;return[...t].sort((r,g)=>new Date(r.createdAt).getTime()-new Date(g.createdAt).getTime()).forEach(r=>{const g=r.pnl||0;m+=g,m>d&&(d=m);const v=d-m;v>s&&(s=v)}),`$${s.toFixed(2)}`})()}),e.jsx("div",{className:"text-sm text-gray-500",children:"Max Drawdown"})]})]}),e.jsx("div",{className:"space-y-4",children:u?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading bot activities..."})]}):p.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-robot-line text-4xl text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No bots found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create some bots to see their activity logs"})]}):p.map(s=>e.jsx(V,{activity:s,onClearLogs:N,onSimulateActivity:x},s.botId))}),e.jsx(K,{}),e.jsx(J,{}),e.jsxs(w,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Debug Tools"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Test Logging"}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Add test logs to verify the logging system is working"}),e.jsx("div",{className:"space-x-2",children:i.slice(0,3).map(s=>e.jsxs(_,{variant:"secondary",size:"sm",onClick:()=>a(s.botId),children:["Test ",s.botName]},s.botId))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Error Simulation"}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Simulate errors to test error handling and logging"}),e.jsx("div",{className:"space-x-2",children:i.slice(0,3).map(s=>e.jsxs(_,{variant:"danger",size:"sm",onClick:()=>S(s.botId),children:["Error ",s.botName]},s.botId))})]})]})]})]}),e.jsx(W,{})]})}export{ae as default};
