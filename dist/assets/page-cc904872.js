import{r as n,s as d,j as e}from"./index-083772a1.js";import{C as h}from"./Card-13f990a5.js";import{H as b}from"./Header-784e78b4.js";import{N as x}from"./Navigation-eb5926f6.js";import{P as j}from"./PaperTradingPerformance-d642a7c4.js";import{P}from"./PaperTradingBalance-87355469.js";import"./Button-26f47c54.js";function v(){const[s,l]=n.useState(""),[i,c]=n.useState([]),m=n.useCallback(async()=>{try{const{data:{user:r}}=await d.auth.getUser();if(!r){c([]),l("");return}const[f,g,p]=await Promise.all([d.from("paper_trading_positions").select("symbol").eq("user_id",r.id).eq("status","open"),d.from("paper_trading_trades").select("symbol").eq("user_id",r.id).eq("status","closed"),d.from("trading_bots").select("symbol, symbols").eq("user_id",r.id).eq("paper_trading",!0)]),t=new Set;f.data&&f.data.length>0&&f.data.forEach(a=>{a.symbol&&t.add(a.symbol)}),g.data&&g.data.length>0&&g.data.forEach(a=>{a.symbol&&t.add(a.symbol)}),p.data&&p.data.length>0&&p.data.forEach(a=>{if(a.symbol&&t.add(a.symbol),a.symbols){let y=[];if(typeof a.symbols=="string")try{y=JSON.parse(a.symbols)}catch(o){console.warn("Failed to parse symbols JSON from bot:",o)}else Array.isArray(a.symbols)&&(y=a.symbols);y.forEach(o=>{o&&t.add(o)})}});const u=Array.from(t).sort();c(u),l(a=>u.length===0?"":!a||a===""||a==="all"?"all":a&&u.includes(a)?a:"all")}catch(r){console.error("Error fetching pairs:",r),c([]),l("")}},[]);return n.useEffect(()=>{m()},[m]),e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(b,{title:"ðŸ“ Paper Trading Dashboard"}),e.jsxs("div",{className:"pt-20 pb-20 px-4 space-y-6",children:[e.jsxs(h,{className:"p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Trading Pair"}),e.jsxs("select",{value:s,onChange:r=>l(r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"-- Select a Pair --"}),e.jsx("option",{value:"all",children:"Select All"}),i.map(r=>e.jsx("option",{value:r,children:r},r))]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:s==="all"||!s||s===""?i.length>0?`Showing report for all pairs (${i.length} ${i.length===1?"pair":"pairs"})`:"Showing report for all pairs (no pairs available yet)":e.jsxs(e.Fragment,{children:["Showing report for ",e.jsx("span",{className:"font-semibold",children:s})]})})]}),e.jsx(P,{}),e.jsx(j,{selectedPair:s==="all"||!s||s===""?"":s,onReset:m})]}),e.jsx(x,{})]})}export{v as default};
