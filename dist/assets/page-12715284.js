import{r as l,s as v,a as ws,u as ks,d as Ts,j as e}from"./index-f36c5022.js";import{H as Ss}from"./Header-c2d6f07f.js";import{N as Us}from"./Navigation-ee81f1aa.js";import{B as n}from"./Button-26b28a57.js";import{C as d}from"./Card-7c3642f0.js";function Cs(){const[I,h]=l.useState(!1),[C,L]=l.useState(null),g=async(r,o={})=>{try{h(!0),L(null);const{data:x,error:w}=await v.functions.invoke("admin-management-enhanced",{body:{action:r,...o}});if(w){console.error("Edge function invoke error:",w);const U=w.message||"Unknown error occurred";throw L(U),new Error(U)}if(x!=null&&x.error){console.error("Edge function returned error:",x);const U=x.details?`${x.error}: ${x.details}`:x.error||"Unknown error occurred";throw L(U),new Error(U)}return x}catch(x){console.error("Admin function error:",x);const w=x.message||x.error||x.details||"Unknown error occurred";throw L(w),new Error(w)}finally{h(!1)}};return{loading:I,error:C,getUsers:async()=>(await g("getUsers")).users||[],createUser:async(r,o,x="user")=>await g("createUser",{email:r,password:o,role:x}),deleteUser:async r=>await g("deleteUser",{userId:r}),updateUserRole:async(r,o)=>await g("updateUserRole",{userId:r,role:o}),updateUserStatus:async(r,o)=>await g("updateUserStatus",{userId:r,status:o}),sendPasswordResetLink:async r=>await g("sendPasswordResetLink",{email:r}),getInvitationCodes:async()=>(await g("getInvitationCodes")).codes||[],generateInvitationCode:async(r,o=7)=>await g("generateInvitationCode",{email:r,expiresInDays:o}),getAllBots:async()=>(await g("getAllBots")).bots||[],adminControlBot:async(r,o)=>await g("adminControlBot",{botId:r,action:o}),getBotAnalytics:async()=>(await g("getBotAnalytics")).analytics||[],getSystemStats:async()=>(await g("getSystemStats")).stats,getTradingAnalytics:async(r="7")=>(await g("getTradingAnalytics",{period:r})).analytics,getFinancialOverview:async()=>(await g("getFinancialOverview")).financial,getUserActivity:async()=>(await g("getUserActivity")).userActivity||[],getSystemLogs:async(r=100)=>(await g("getSystemLogs",{limit:r})).logs||[],getLatestTrades:async(r=100,o=null)=>(await g("getLatestTrades",{limit:r,user_id:o})).trades||[],getRiskMetrics:async()=>(await g("getRiskMetrics")).risk,exportData:async(r,o)=>(await g("exportData",{type:r,userId:o})).data}}function Bs(){var De,Ae,Ie,ze,Me,Oe,qe,Ve;const I=ws(),{user:h,loading:C}=ks(),{executeBot:L}=Ts(),{createUser:g,generateInvitationCode:le,getUsers:z,getInvitationCodes:ie,getAllBots:ne,adminControlBot:de,getBotAnalytics:Je,getSystemStats:ce,getTradingAnalytics:oe,getFinancialOverview:xe,getUserActivity:me,getSystemLogs:ge,getLatestTrades:he,getRiskMetrics:ye,exportData:pe,deleteUser:ue,updateUserRole:je,updateUserStatus:be,sendPasswordResetLink:Ne}=Cs(),[p,r]=l.useState("overview"),[o,x]=l.useState([]),[w,U]=l.useState([]),[M,Ke]=l.useState([]),[fe,Ye]=l.useState([]),[ve,we]=l.useState(!1),[Qe,Q]=l.useState(null),[X,O]=l.useState(""),[ke,Te]=l.useState(null),[q,Se]=l.useState({}),[Ls,Xe]=l.useState(null),[V,Ue]=l.useState(null),[u,Ze]=l.useState(null),[m,es]=l.useState(null),[y,ss]=l.useState(null),[Z,ts]=l.useState([]),[ee,as]=l.useState([]),[j,rs]=l.useState(null),[Ce,Le]=l.useState([]),[_e,$e]=l.useState(!1),[_,ls]=l.useState("all"),[D,is]=l.useState("all"),[f,Fe]=l.useState(!0),[ns,W]=l.useState(!1),[ds,G]=l.useState(!1),[H,$]=l.useState(null),[J,F]=l.useState(null),[cs,os]=l.useState({}),[k,K]=l.useState({email:"",password:"",role:"user"}),[E,se]=l.useState({email:"",expiresInDays:7});l.useEffect(()=>{if(console.log("ðŸ”§ Admin page loaded - User:",h==null?void 0:h.email,"Role:",h==null?void 0:h.role,"Auth Loading:",C),C){console.log("â³ Still loading auth data...");return}if(!h||(h==null?void 0:h.role)!=="admin"){console.log("âŒ User is not admin, redirecting to home"),I("/dashboard");return}console.log("âœ… User is admin, loading admin data..."),T()},[h,C,I]),l.useEffect(()=>{p==="latest-trades"&&o.length===0&&(console.log("ðŸ”„ Latest Trades tab active but no users, loading users..."),(async()=>{try{const t=await z();console.log("âœ… Users loaded in useEffect:",(t==null?void 0:t.length)||0,"users"),console.log("ðŸ“‹ Users data sample:",t==null?void 0:t[0]),t&&t.length>0?(x(t),console.log("âœ… Users state updated with",t.length,"users")):console.warn("âš ï¸ getUsers() returned empty array or null")}catch(t){console.error("âŒ Failed to load users in useEffect:",t)}})())},[p]);const P=async()=>{try{we(!0);const{data:s,error:t}=await v.from("pablo_ready_bots").select("*").order("order_index",{ascending:!0}).order("created_at",{ascending:!1});if(t)throw t;Ye(s||[])}catch(s){console.error("Error fetching Pablo Ready bots:",s),alert(`Failed to load Pablo Ready bots: ${(s==null?void 0:s.message)||s}`)}finally{we(!1)}},xs=async(s,t)=>{try{const{error:a}=await v.from("pablo_ready_bots").update({enabled:!t}).eq("id",s);if(a)throw a;await P(),alert(`âœ… Bot ${t?"disabled":"enabled"} successfully`)}catch(a){console.error("Error toggling Pablo Ready bot:",a),alert(`âŒ Failed to ${t?"disable":"enable"} bot: ${(a==null?void 0:a.message)||a}`)}},ms=s=>{Q(s.id),O(s.name)},Ee=()=>{Q(null),O("")},Pe=async s=>{if(!X.trim()){alert("âŒ Bot name cannot be empty");return}try{const{error:t}=await v.from("pablo_ready_bots").update({name:X.trim()}).eq("id",s);if(t)throw t;await P(),Q(null),O(""),alert("âœ… Bot name updated successfully")}catch(t){console.error("Error updating bot name:",t),alert(`âŒ Failed to update bot name: ${(t==null?void 0:t.message)||t}`)}},gs=async(s,t)=>{if(confirm(`âš ï¸ Are you sure you want to delete "${t}"?

This action cannot be undone.`))try{Te(s);const{error:a}=await v.from("pablo_ready_bots").delete().eq("id",s);if(a)throw a;await P(),alert(`âœ… Bot "${t}" deleted successfully`)}catch(a){console.error("Error deleting Pablo Ready bot:",a),alert(`âŒ Failed to delete bot: ${(a==null?void 0:a.message)||a}`)}finally{Te(null)}},hs=s=>{Xe(s)},Be=async(s,t="paper")=>{if(confirm(`ðŸ§ª Test "${s.name}" in ${t.toUpperCase()} mode?

This will create a temporary bot and execute it.`))try{Ue(s.id);const a={name:`[TEST] ${s.name}`,exchange:s.exchange,trading_type:s.trading_type,symbol:s.symbol,timeframe:s.timeframe,leverage:s.leverage||1,risk_level:s.risk_level||"medium",trade_amount:s.trade_amount||100,stop_loss:s.stop_loss||2,take_profit:s.take_profit||4,paper_trading:t==="paper",strategy:s.strategy||{},strategy_config:s.strategy_config||{},status:"running"},{data:i,error:b}=await v.from("trading_bots").insert(a).select().single();if(b)throw b;await L(i.id),setTimeout(async()=>{await v.from("trading_bots").delete().eq("id",i.id)},5e3),alert(`âœ… Test bot created and executed successfully!

Bot ID: ${i.id}
Mode: ${t.toUpperCase()}

The temporary bot will be deleted in 5 seconds.`)}catch(a){console.error("Error testing Pablo Ready bot:",a),alert(`âŒ Failed to test bot: ${(a==null?void 0:a.message)||a}`)}finally{Ue(null)}},te=async()=>{try{$e(!0);const t=await he(100,D==="all"?null:D);Le(t)}catch(s){console.error("Error fetching latest trades:",s),alert(`Failed to load latest trades: ${(s==null?void 0:s.message)||s}`),Le([])}finally{$e(!1)}},T=async()=>{var s;try{console.log("ðŸ”„ Loading admin data..."),Fe(!0);const[t,a,i,b,c,B,A,R,re]=await Promise.all([z(),ie(),ne(),ce(),oe(),xe(),me(),ge(),ye()]);console.log("âœ… Admin data loaded successfully"),console.log("ðŸ“Š Users data received:",t),console.log("ðŸ“Š First user sample:",t==null?void 0:t[0]),console.log("ðŸ“Š First user stats:",(s=t==null?void 0:t[0])==null?void 0:s.stats),x(t||[]),U(a||[]),Ke(i||[]),Ze(b),es(c),ss(B),ts(A||[]),as(R||[]),rs(re),p==="pablo-ready"&&await P()}catch(t){console.error("âŒ Error loading admin data:",t),console.error("âŒ Error details:",t.message)}finally{Fe(!1)}},ys=async s=>{s.preventDefault(),$(null),F(null);try{const t=await g(k.email,k.password,k.role);F((t==null?void 0:t.message)||"User created successfully"),K({email:"",password:"",role:"user"}),setTimeout(()=>{W(!1),T()},1e3)}catch(t){console.error("Error creating user:",t),$((t==null?void 0:t.message)||(t==null?void 0:t.error)||"Failed to create user. Please try again.")}},ps=async s=>{s.preventDefault(),$(null),F(null);try{const t=await le(E.email,E.expiresInDays);F((t==null?void 0:t.message)||"Invitation code created successfully"),se({email:"",expiresInDays:7}),setTimeout(()=>{G(!1),T()},1e3)}catch(t){console.error("Error creating invitation:",t),$((t==null?void 0:t.message)||(t==null?void 0:t.error)||"Failed to create invitation code. Please try again.")}},S=(s,t)=>{os(a=>({...a,[s]:t}))},us=async(s,t)=>{S(s,!0);try{await je(s,t),x(a=>a.map(i=>i.id===s?{...i,role:t}:i)),await T(),alert(`âœ… Updated user role to ${t}`)}catch(a){console.error("Error updating user role:",a),alert(`âŒ Failed to update user role: ${(a==null?void 0:a.message)||a}`)}finally{S(s,!1)}},js=async(s,t)=>{S(s,!0);try{await be(s,t),x(a=>a.map(i=>i.id===s?{...i,status:t}:i)),await T(),alert(`âœ… Updated user status to ${t}`)}catch(a){console.error("Error updating user status:",a),alert(`âŒ Failed to update user status: ${(a==null?void 0:a.message)||a}`)}finally{S(s,!1)}},bs=async(s,t)=>{if(window.confirm(`Delete user "${t}"? This cannot be undone.`)){S(s,!0);try{await ue(s),await T(),alert("âœ… User deleted successfully")}catch(i){console.error("Error deleting user:",i),alert(`âŒ Failed to delete user: ${(i==null?void 0:i.message)||i}`)}finally{S(s,!1)}}},Ns=async(s,t)=>{S(s,!0);try{const a=await Ne(t),i=a==null?void 0:a.resetLink;if(i)try{await navigator.clipboard.writeText(i),alert("âœ… Password reset link generated and copied to clipboard.")}catch{alert(`âœ… Password reset link generated:
${i}`)}else alert("âœ… Password reset link generated.")}catch(a){console.error("Error generating password reset link:",a),alert(`âŒ Failed to generate password reset link: ${(a==null?void 0:a.message)||a}`)}finally{S(s,!1)}},ae=async(s,t)=>{try{await de(s,t),T()}catch(a){console.error("Error controlling bot:",a)}},Re=async(s,t)=>{var i,b;if(!h){alert("âŒ You must be logged in to test trades");return}const a=t==="real"?`âš ï¸ WARNING: This will execute a REAL trade using live funds!

Bot: ${((i=M.find(c=>c.id===s))==null?void 0:i.name)||s}

Are you sure you want to proceed?`:`Test PAPER trade for bot: ${((b=M.find(c=>c.id===s))==null?void 0:b.name)||s}

This will execute a paper trade (no real funds).`;if(confirm(a))try{Se(N=>({...N,[s]:t}));const{data:c,error:B}=await v.from("trading_bots").select("id, user_id, name, symbol, exchange, trading_type, status").eq("id",s).single();if(B||!c)throw new Error(`Failed to fetch bot: ${(B==null?void 0:B.message)||"Bot not found"}`);if(c.status!=="running")throw new Error(`Bot is not running. Current status: ${c.status}`);const{data:A,error:R}=await v.from("manual_trade_signals").insert({bot_id:s,user_id:c.user_id,mode:t,side:"buy",size_multiplier:1,reason:`Admin test trade (${t.toUpperCase()})`,status:"pending"}).select().single();if(R||!A)throw new Error(`Failed to create test signal: ${(R==null?void 0:R.message)||"Unknown error"}`);console.log(`âœ… Test signal created: ${A.id}`);const re={}.VITE_PUBLIC_SUPABASE_URL,{data:{session:We}}=await v.auth.getSession();if(!We)throw new Error("No active session found");const Ge=`${re}/functions/v1/bot-executor`,vs={action:"execute_bot",bot_id:s};console.log("ðŸš€ Triggering bot executor:",{url:Ge,method:"POST",botId:s,action:"execute_bot",mode:t});try{const N=await fetch(Ge,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${We.access_token}`,"x-cron-secret":{}.VITE_CRON_SECRET||""},body:JSON.stringify(vs)}),He=await N.text();console.log("ðŸ“¥ Bot executor response:",{status:N.status,statusText:N.statusText,ok:N.ok,body:He.substring(0,200)}),N.ok?console.log("âœ… Bot executor triggered successfully"):console.error("âŒ Bot executor trigger failed:",{status:N.status,statusText:N.statusText,body:He})}catch(N){console.error("âŒ Failed to trigger bot executor:",{error:N.message,stack:N.stack,name:N.name})}alert(`âœ… Test ${t.toUpperCase()} trade signal created!

Signal ID: ${A.id}

The bot executor will process this trade shortly. Check the bot logs for execution details.`),setTimeout(()=>{T()},2e3)}catch(c){console.error("Error creating test trade:",c),alert(`âŒ Failed to create test trade: ${(c==null?void 0:c.message)||"Unknown error"}`)}finally{Se(c=>({...c,[s]:null}))}},Y=async(s,t)=>{try{const a=await pe(s,t),i=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),b=URL.createObjectURL(i),c=document.createElement("a");c.href=b,c.download=`${s}_export_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(b)}catch(a){console.error("Error exporting data:",a)}};if(C)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin text-4xl text-blue-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"**Loading admin panel...**"})]})});if(!h||(h==null?void 0:h.role)!=="admin")return null;const fs=[{id:"overview",label:"Overview",icon:"ri-dashboard-line"},{id:"users",label:"Users",icon:"ri-user-line"},{id:"bots",label:"Trading Bots",icon:"ri-robot-line"},{id:"pablo-ready",label:"Pablo Ready",icon:"ri-star-line"},{id:"latest-trades",label:"Latest Trades",icon:"ri-exchange-line"},{id:"analytics",label:"Analytics",icon:"ri-bar-chart-line"},{id:"financial",label:"Financial",icon:"ri-money-dollar-circle-line"},{id:"monitoring",label:"Monitoring",icon:"ri-eye-line"},{id:"security",label:"Security",icon:"ri-shield-check-line"},{id:"system",label:"System",icon:"ri-settings-line"}];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ss,{title:"Admin Panel",subtitle:"Complete System Management & Control"}),e.jsxs("div",{className:"pt-20 pb-20 px-4",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:fs.map(s=>e.jsxs(n,{variant:p===s.id?"primary":"secondary",onClick:async()=>{if(r(s.id),s.id==="pablo-ready")P();else if(s.id==="latest-trades"){if(console.log("ðŸ” Latest Trades tab clicked. Current users count:",o.length),o.length===0){console.log("âš ï¸ Users not loaded yet, loading users first...");try{const t=await z();console.log("âœ… Users loaded from getUsers():",(t==null?void 0:t.length)||0,"users"),console.log("ðŸ“‹ Users data:",t),t&&t.length>0?(x(t),console.log("âœ… Users state updated")):console.warn("âš ï¸ No users returned from getUsers()")}catch(t){console.error("âŒ Failed to load users:",t)}}else console.log("âœ… Users already loaded:",o.length,"users");te()}},className:"flex items-center gap-2",children:[e.jsx("i",{className:s.icon}),s.label]},s.id))})}),p==="overview"&&e.jsx("div",{className:"space-y-6",children:f?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin text-4xl text-gray-400"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"Loading overview data..."})]}):u?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(d,{className:"text-center p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(u==null?void 0:u.totalUsers)||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Users"})]}),e.jsxs(d,{className:"text-center p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(u==null?void 0:u.totalBots)||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Active Bots"})]}),e.jsxs(d,{className:"text-center p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(u==null?void 0:u.totalTrades)||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Trades"})]}),e.jsxs(d,{className:"text-center p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["$",((De=u==null?void 0:u.platformPnL)==null?void 0:De.toFixed(2))||"0.00"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Platform PnL"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(n,{variant:"primary",onClick:()=>W(!0),className:"h-16 flex flex-col items-center justify-center",children:[e.jsx("i",{className:"ri-user-add-line text-2xl mb-2"}),"Create User"]}),e.jsxs(n,{variant:"secondary",onClick:()=>G(!0),className:"h-16 flex flex-col items-center justify-center",children:[e.jsx("i",{className:"ri-mail-send-line text-2xl mb-2"}),"Send Invitation"]}),e.jsxs(n,{variant:"secondary",onClick:()=>Y("all_trades"),className:"h-16 flex flex-col items-center justify-center",children:[e.jsx("i",{className:"ri-download-line text-2xl mb-2"}),"Export Data"]}),e.jsxs(n,{variant:"secondary",onClick:()=>r("monitoring"),className:"h-16 flex flex-col items-center justify-center",children:[e.jsx("i",{className:"ri-eye-line text-2xl mb-2"}),"View Logs"]})]}),e.jsxs(d,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Trading Activity"}),f?e.jsx("div",{className:"text-center py-8",children:e.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-gray-400"})}):!m||!m.trades||m.trades.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-exchange-line text-4xl mb-2"}),e.jsx("p",{children:"No recent trading activity"})]}):e.jsx("div",{className:"space-y-3",children:m.trades.slice(0,10).map((s,t)=>{var a;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.symbol," - ",s.side]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.exchange," â€¢ ",new Date(s.created_at).toLocaleString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`font-medium ${s.pnl>=0?"text-green-600":"text-red-600"}`,children:["$",((a=s.pnl)==null?void 0:a.toFixed(2))||"0.00"]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="filled"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.status})]})]},t)})})]})]}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("i",{className:"ri-dashboard-line text-4xl mb-2"}),e.jsx("p",{children:"No system statistics available"})]})}),p==="users"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"User Management"}),e.jsxs(n,{onClick:()=>W(!0),children:[e.jsx("i",{className:"ri-user-add-line mr-2"}),"Create User"]})]}),f?e.jsx("div",{className:"text-center py-8",children:e.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-gray-400"})}):e.jsx("div",{className:"space-y-3",children:o.map(s=>{var a,i,b;const t=!!cs[s.id];return e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:s.email}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.role==="admin"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"}`,children:s.role}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${(s.status||"active")==="active"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":(s.status||"active")==="suspended"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:s.status||"active"}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs flex items-center gap-1 ${(a=s.stats)!=null&&a.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${(i=s.stats)!=null&&i.isActive?"bg-green-500":"bg-gray-400"}`}),(b=s.stats)!=null&&b.isActive?"Active":"Inactive"]})]}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Created: ",new Date(s.created_at).toLocaleDateString(),s.last_sign_in_at&&e.jsxs(e.Fragment,{children:[" â€¢ Last active: ",new Date(s.last_sign_in_at).toLocaleDateString()]})]})]})}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Role"}),e.jsxs("select",{value:s.role,onChange:c=>us(s.id,c.target.value),disabled:t,className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-900 dark:border-gray-700",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Status"}),e.jsxs("select",{value:s.status||"active",onChange:c=>js(s.id,c.target.value),disabled:t,className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-900 dark:border-gray-700",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"disabled",children:"Disabled"})]})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs(n,{variant:"secondary",size:"sm",onClick:()=>Ns(s.id,s.email),disabled:t,children:[e.jsx("i",{className:"ri-lock-password-line mr-1"}),"Reset Password"]}),e.jsxs(n,{variant:"danger",size:"sm",onClick:()=>bs(s.id,s.email),disabled:t,children:[e.jsx("i",{className:"ri-delete-bin-line mr-1"}),"Delete"]})]})]}),s.stats?e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Total PnL"}),e.jsxs("p",{className:`text-sm font-semibold ${s.stats.totalPnL+s.stats.paperPnL>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:["$",(s.stats.totalPnL+s.stats.paperPnL||0).toFixed(2)]}),e.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Real: $",s.stats.totalPnL.toFixed(2)," â€¢ Paper: $",s.stats.paperPnL.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Total Trades"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:s.stats.totalTrades+s.stats.paperTradesCount}),e.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Real: ",s.stats.totalTrades," â€¢ Paper: ",s.stats.paperTradesCount]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Active Bots"}),e.jsx("p",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400",children:s.stats.activeBots}),e.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Win Rate: ",s.stats.avgWinRate.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Trading Volume"}),e.jsxs("p",{className:"text-sm font-semibold text-purple-600 dark:text-purple-400",children:["$",(s.stats.totalVolume||0).toLocaleString(void 0,{maximumFractionDigits:2})]})]})]})}):e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Loading stats..."})})]},s.id)})})]}),e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Invitation Codes"}),e.jsxs(n,{onClick:()=>G(!0),children:[e.jsx("i",{className:"ri-mail-send-line mr-2"}),"Create Invitation"]})]}),f?e.jsx("div",{className:"text-center py-8",children:e.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-gray-400"})}):w.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-mail-line text-4xl mb-2"}),e.jsx("p",{children:"No invitation codes yet"})]}):e.jsx("div",{className:"space-y-3",children:w.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-mono text-sm mb-1",children:s.code}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",s.email||"No email specified"]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Created: ",new Date(s.created_at).toLocaleDateString()," â€¢ Expires: ",new Date(s.expires_at).toLocaleDateString()]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ml-4 ${s.used?"bg-gray-100 text-gray-800":"bg-green-100 text-green-800"}`,children:s.used?"Used":"Active"})]},s.id))})]})]}),p==="bots"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(d,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"All Trading Bots"}),f?e.jsx("div",{className:"text-center py-8",children:e.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-gray-400"})}):M.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-robot-line text-4xl mb-2"}),e.jsx("p",{children:"No trading bots found"})]}):e.jsx("div",{className:"space-y-3",children:M.map(s=>{var t;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Owner: ",s.users.email," â€¢ Trades: ",s.total_trades," â€¢ Win Rate: ",(t=s.win_rate)==null?void 0:t.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="running"?"bg-green-100 text-green-800":s.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.status}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(n,{size:"sm",variant:"secondary",onClick:()=>ae(s.id,"running"),disabled:s.status==="running",title:"Start bot",children:e.jsx("i",{className:"ri-play-line"})}),e.jsx(n,{size:"sm",variant:"secondary",onClick:()=>ae(s.id,"paused"),disabled:s.status==="paused",title:"Pause bot",children:e.jsx("i",{className:"ri-pause-line"})}),e.jsx(n,{size:"sm",variant:"secondary",onClick:()=>ae(s.id,"stopped"),disabled:s.status==="stopped",title:"Stop bot",children:e.jsx("i",{className:"ri-stop-line"})}),e.jsxs("div",{className:"ml-2 border-l border-gray-300 pl-2 flex space-x-1",children:[e.jsx(n,{size:"sm",variant:"primary",onClick:()=>Re(s.id,"paper"),disabled:s.status!=="running"||q[s.id]==="paper",title:"Test Paper Trade",className:"bg-blue-600 hover:bg-blue-700",children:q[s.id]==="paper"?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-1"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-file-paper-line mr-1"}),"Paper"]})}),e.jsx(n,{size:"sm",variant:"danger",onClick:()=>Re(s.id,"real"),disabled:s.status!=="running"||q[s.id]==="real",title:"Test Real Trade (WARNING: Uses Live Funds!)",className:"bg-red-600 hover:bg-red-700",children:q[s.id]==="real"?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-1"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-money-dollar-circle-line mr-1"}),"Real"]})})]})]})]})]},s.id)})})]})}),p==="pablo-ready"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Pablo Ready Bots"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Manage pre-configured bots available to all users"})]}),e.jsxs(n,{onClick:P,variant:"secondary",size:"sm",disabled:ve,children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Refresh"]})]}),ve?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Loading bots..."})]}):fe.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-robot-line text-4xl mb-2"}),e.jsx("p",{children:"No Pablo Ready bots found"})]}):e.jsx("div",{className:"space-y-4",children:fe.map(s=>e.jsx(d,{className:`p-4 border-2 ${s.enabled?"border-green-200 bg-green-50/50 dark:border-green-900/40 dark:bg-green-900/10":"border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800/50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[Qe===s.id?e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("input",{type:"text",value:X,onChange:t=>O(t.target.value),onKeyDown:t=>{t.key==="Enter"?Pe(s.id):t.key==="Escape"&&Ee()},className:"flex-1 px-3 py-1 border border-blue-500 rounded-lg text-lg font-semibold focus:ring-2 focus:ring-blue-500 focus:outline-none dark:bg-gray-800 dark:text-white",autoFocus:!0}),e.jsx("button",{onClick:()=>Pe(s.id),className:"px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-sm",title:"Save (Enter)",children:e.jsx("i",{className:"ri-check-line"})}),e.jsx("button",{onClick:Ee,className:"px-3 py-1 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition text-sm",title:"Cancel (Esc)",children:e.jsx("i",{className:"ri-close-line"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:s.name}),e.jsx("button",{onClick:()=>ms(s),className:"p-1 text-gray-500 hover:text-blue-600 dark:hover:text-blue-400 transition",title:"Edit name",children:e.jsx("i",{className:"ri-edit-line text-sm"})})]}),s.featured&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200",children:[e.jsx("i",{className:"ri-star-fill mr-1"}),"Featured"]}),e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${s.enabled?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:s.enabled?"Enabled":"Disabled"})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs mb-1",children:"Exchange"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white capitalize",children:s.exchange})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs mb-1",children:"Symbol"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:s.symbol})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs mb-1",children:"Type"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white capitalize",children:s.trading_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs mb-1",children:"Leverage"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[s.leverage,"x"]})]})]})]}),e.jsxs("div",{className:"ml-4 flex flex-col gap-2",children:[e.jsxs(n,{onClick:()=>hs(s),variant:"secondary",size:"sm",children:[e.jsx("i",{className:"ri-edit-line mr-2"}),"Edit"]}),e.jsx(n,{onClick:()=>Be(s,"paper"),variant:"primary",size:"sm",disabled:V===s.id,children:V===s.id?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-flask-line mr-2"}),"Test (Paper)"]})}),e.jsx(n,{onClick:()=>Be(s,"real"),variant:"warning",size:"sm",disabled:V===s.id,children:V===s.id?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-flask-line mr-2"}),"Test (Real)"]})}),e.jsxs(n,{onClick:()=>xs(s.id,s.enabled),variant:s.enabled?"danger":"primary",size:"sm",children:[e.jsx("i",{className:`mr-2 ${s.enabled?"ri-eye-off-line":"ri-eye-line"}`}),s.enabled?"Disable":"Enable"]}),e.jsx(n,{onClick:()=>gs(s.id,s.name),variant:"danger",size:"sm",disabled:ke===s.id,children:ke===s.id?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-delete-bin-line mr-2"}),"Delete"]})})]})]})},s.id))})]})}),p==="latest-trades"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Latest Trades"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["View the 100 most recent trades ",D==="all"?"from all users":`from ${((Ae=o.find(s=>s.id===D))==null?void 0:Ae.email)||"selected user"}`," across the platform"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:D,onChange:s=>{console.log("ðŸ“‹ User filter changed:",s.target.value),is(s.target.value),setTimeout(()=>te(),100)},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white min-w-[200px]",children:[e.jsx("option",{value:"all",children:"All Users"}),o.length===0?e.jsx("option",{value:"",disabled:!0,children:"Loading users..."}):o.map(s=>e.jsx("option",{value:s.id,children:s.email||`User ${s.id.substring(0,8)}...`},s.id))]}),e.jsxs("select",{value:_,onChange:s=>ls(s.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",children:[e.jsx("option",{value:"all",children:"All Trades"}),e.jsx("option",{value:"real",children:"Real Trades Only"}),e.jsx("option",{value:"paper",children:"Paper Trades Only"})]}),e.jsxs(n,{onClick:te,variant:"secondary",size:"sm",disabled:_e,children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Refresh"]})]})]}),_e?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Loading trades..."})]}):Ce.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-exchange-line text-4xl mb-2"}),e.jsx("p",{children:"No trades found"}),e.jsx("p",{className:"text-sm mt-1",children:"Trades will appear here once users start trading"})]}):(()=>{const s=Ce.filter(t=>_==="all"?!0:_==="real"?t.trade_type==="REAL":_==="paper"?t.trade_type==="PAPER":!0);return s.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-exchange-line text-4xl mb-2"}),e.jsxs("p",{children:["No ",_==="real"?"real":_==="paper"?"paper":""," trades found"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-300",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-300",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-300",children:"Bot"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-300",children:"Symbol"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-300",children:"Side"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300",children:"PnL"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold text-gray-700 dark:text-gray-300",children:"Fee"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 dark:text-gray-300",children:"Time"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:s.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.trade_type==="REAL"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:t.trade_type})}),e.jsx("td",{className:"px-4 py-3 text-gray-700 dark:text-gray-300",children:t.user_email}),e.jsx("td",{className:"px-4 py-3 text-gray-700 dark:text-gray-300",children:t.bot_name}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white",children:t.symbol}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.side==="buy"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200"}`,children:t.side.toUpperCase()})}),e.jsx("td",{className:"px-4 py-3 text-right text-gray-700 dark:text-gray-300",children:typeof t.amount=="number"?t.amount.toFixed(4):t.amount}),e.jsxs("td",{className:"px-4 py-3 text-right text-gray-700 dark:text-gray-300",children:["$",typeof t.price=="number"?t.price.toFixed(2):t.price]}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("span",{className:`font-medium ${t.pnl>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:["$",typeof t.pnl=="number"?t.pnl.toFixed(2):"0.00"]})}),e.jsxs("td",{className:"px-4 py-3 text-right text-gray-700 dark:text-gray-300",children:["$",typeof t.fee=="number"?t.fee.toFixed(2):"0.00"]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.status==="filled"||t.status==="completed"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":t.status==="pending"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200"}`,children:t.status})}),e.jsx("td",{className:"px-4 py-3 text-gray-500 dark:text-gray-400 text-xs",children:t.minutes_ago!==null?t.minutes_ago<60?`${t.minutes_ago}m ago`:t.minutes_ago<1440?`${Math.floor(t.minutes_ago/60)}h ago`:`${Math.floor(t.minutes_ago/1440)}d ago`:t.executed_at?new Date(t.executed_at).toLocaleString():"N/A"})]},`${t.trade_type}-${t.trade_id}`))})]})})})()]})}),p==="analytics"&&e.jsx("div",{className:"space-y-6",children:f?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin text-4xl text-gray-400"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"Loading analytics data..."})]}):m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(d,{className:"text-center p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(m==null?void 0:m.totalTrades)||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Trades"})]}),e.jsxs(d,{className:"text-center p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(m==null?void 0:m.filledTrades)||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Successful"})]}),e.jsxs(d,{className:"text-center p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:(m==null?void 0:m.failedTrades)||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Failed"})]}),e.jsxs(d,{className:"text-center p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[((Ie=m==null?void 0:m.successRate)==null?void 0:Ie.toFixed(1))||"0.0","%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Success Rate"})]})]}),e.jsxs(d,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Exchange Statistics"}),!m||Object.keys((m==null?void 0:m.exchangeStats)||{}).length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-bar-chart-line text-4xl mb-2"}),e.jsx("p",{children:"No exchange statistics available"})]}):e.jsx("div",{className:"space-y-3",children:Object.entries((m==null?void 0:m.exchangeStats)||{}).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.count," trades"]})]}),e.jsxs("div",{className:`font-medium ${t.pnl>=0?"text-green-600":"text-red-600"}`,children:["$",t.pnl.toFixed(2)]})]},s))})]})]}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("i",{className:"ri-bar-chart-line text-4xl mb-2"}),e.jsx("p",{children:"No trading analytics available"})]})}),p==="financial"&&e.jsx("div",{className:"space-y-6",children:f?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin text-4xl text-gray-400"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"Loading financial data..."})]}):y?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(d,{className:"text-center p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["$",((ze=y==null?void 0:y.totalVolume)==null?void 0:ze.toFixed(2))||"0.00"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Volume"})]}),e.jsxs(d,{className:"text-center p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",((Me=y==null?void 0:y.totalPnL)==null?void 0:Me.toFixed(2))||"0.00"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total PnL"})]}),e.jsxs(d,{className:"text-center p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["$",((Oe=y==null?void 0:y.totalFees)==null?void 0:Oe.toFixed(2))||"0.00"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Fees"})]}),e.jsxs(d,{className:"text-center p-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["$",((qe=y==null?void 0:y.netProfit)==null?void 0:qe.toFixed(2))||"0.00"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Net Profit"})]})]}),y.dailyPnL&&Object.keys(y.dailyPnL).length>0&&e.jsxs(d,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Daily PnL (Last 30 Days)"}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:Object.entries(y.dailyPnL).slice(-30).reverse().map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600",children:new Date(s).toLocaleDateString()}),e.jsxs("span",{className:`font-medium ${t>=0?"text-green-600":"text-red-600"}`,children:["$",t.toFixed(2)]})]},s))})]})]}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("i",{className:"ri-money-dollar-circle-line text-4xl mb-2"}),e.jsx("p",{children:"No financial data available"})]})}),p==="monitoring"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"System Logs"}),f?e.jsx("div",{className:"text-center py-8",children:e.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-gray-400"})}):!ee||ee.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-file-list-line text-4xl mb-2"}),e.jsx("p",{children:"No system logs available"})]}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:ee.map((s,t)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${s.level==="error"?"bg-red-500":s.level==="warning"?"bg-yellow-500":s.level==="success"?"bg-green-500":"bg-blue-500"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.message||s.event_message||"No message"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.category||s.event_type||"System"," â€¢ ",s.created_at?new Date(s.created_at).toLocaleString():"Unknown date"]})]})]},t))})]}),e.jsxs(d,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"User Activity"}),f?e.jsx("div",{className:"text-center py-8",children:e.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-gray-400"})}):!Z||Z.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-user-line text-4xl mb-2"}),e.jsx("p",{children:"No user activity data available"})]}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:Z.slice(0,20).map(s=>{var t,a;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.email}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Bots: ",((t=s.trading_bots)==null?void 0:t.length)||0," â€¢ Trades: ",((a=s.trades)==null?void 0:a.length)||0," â€¢ Last Active: ",s.last_sign_in_at?new Date(s.last_sign_in_at).toLocaleDateString():"Never"]})]}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(s.created_at).toLocaleDateString()})]},s.id)})})]})]}),p==="security"&&e.jsx("div",{className:"space-y-6",children:e.jsxs(d,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Risk Monitoring"}),f?e.jsx("div",{className:"text-center py-8",children:e.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl text-gray-400"})}):j?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:(j==null?void 0:j.riskScore)||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Risk Score"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:((Ve=j==null?void 0:j.largeTrades)==null?void 0:Ve.length)||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Large Trades"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Large Trades (â‰¥ $1000)"}),!j.largeTrades||j.largeTrades.length===0?e.jsx("div",{className:"text-center py-4 text-gray-400 text-sm",children:"No large trades found"}):e.jsx("div",{className:"space-y-2",children:j.largeTrades.slice(0,10).map((s,t)=>{var a;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.symbol," - ",s.side]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.exchange," â€¢ Amount: $",((a=s.amount)==null?void 0:a.toFixed(2))||"0.00"," â€¢ ",s.created_at?new Date(s.created_at).toLocaleString():"Unknown date"]})]}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800",children:"Large"})]},t)})})]}),e.jsxs("div",{className:"space-y-3 mt-4",children:[e.jsx("h4",{className:"font-medium",children:"Recent Failed Trades"}),!j.failedTrades||j.failedTrades.length===0?e.jsx("div",{className:"text-center py-4 text-gray-400 text-sm",children:"No failed trades in the last 24 hours"}):e.jsx("div",{className:"space-y-2",children:j.failedTrades.slice(0,10).map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.symbol," - ",s.side]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.exchange," â€¢ ",s.created_at?new Date(s.created_at).toLocaleString():"Unknown date"]})]}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"Failed"})]},t))})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-shield-check-line text-4xl mb-2"}),e.jsx("p",{children:"No risk metrics available"})]})]})}),p==="system"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Data Export"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs(n,{variant:"secondary",onClick:()=>Y("all_trades"),className:"h-16 flex flex-col items-center justify-center",children:[e.jsx("i",{className:"ri-download-line text-2xl mb-2"}),"Export All Trades"]}),e.jsxs(n,{variant:"secondary",onClick:()=>Y("users"),className:"h-16 flex flex-col items-center justify-center",children:[e.jsx("i",{className:"ri-user-line text-2xl mb-2"}),"Export Users"]}),e.jsxs(n,{variant:"secondary",onClick:()=>Y("all_trades"),className:"h-16 flex flex-col items-center justify-center",children:[e.jsx("i",{className:"ri-database-line text-2xl mb-2"}),"Export System Data"]})]})]}),e.jsxs(d,{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"System Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Database Status:"}),e.jsx("span",{className:"text-green-600 font-medium",children:"Connected"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"API Status:"}),e.jsx("span",{className:"text-green-600 font-medium",children:"Operational"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Last Backup:"}),e.jsx("span",{className:"text-gray-800",children:new Date().toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"System Uptime:"}),e.jsx("span",{className:"text-gray-800",children:"99.9%"})]})]})]})]}),ns&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(d,{className:"w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Create New User"}),H&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600",children:H})}),J&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-600",children:J})}),e.jsxs("form",{onSubmit:ys,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:k.email,onChange:s=>K({...k,email:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:k.password,onChange:s=>K({...k,password:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:k.role,onChange:s=>K({...k,role:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(n,{type:"button",variant:"secondary",onClick:()=>{W(!1),$(null),F(null)},className:"flex-1",children:"Cancel"}),e.jsx(n,{type:"submit",variant:"primary",className:"flex-1",children:"Create User"})]})]})]})}),ds&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(d,{className:"w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Create Invitation Code"}),H&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600",children:H})}),J&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-600",children:J})}),e.jsxs("form",{onSubmit:ps,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:E.email,onChange:s=>se({...E,email:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expires in (days)"}),e.jsxs("select",{value:E.expiresInDays,onChange:s=>se({...E,expiresInDays:parseInt(s.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:1,children:"1 day"}),e.jsx("option",{value:3,children:"3 days"}),e.jsx("option",{value:7,children:"7 days"}),e.jsx("option",{value:14,children:"14 days"}),e.jsx("option",{value:30,children:"30 days"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(n,{type:"button",variant:"secondary",onClick:()=>{G(!1),$(null),F(null)},className:"flex-1",children:"Cancel"}),e.jsx(n,{type:"submit",variant:"primary",className:"flex-1",children:"Create Invitation"})]})]})]})})]}),e.jsx(Us,{})]})}export{Bs as default};
