import{r as w,j as e,s as B,b as ve,A as Pe}from"./index-083772a1.js";import{C as V}from"./Card-13f990a5.js";import{B as ie}from"./Button-26f47c54.js";function ze({selectedPair:I="",onReset:Z}){const[oe,U]=w.useState(null),[A,C]=w.useState([]),[de,O]=w.useState(!0),[ce,ee]=w.useState(!1),[xe,te]=w.useState(!1),[se,we]=w.useState([]),[me,Te]=w.useState(!1),[K,ge]=w.useState(!1),T=w.useRef(null),ue=async()=>{const{data:{session:t}}=await B.auth.getSession();if(!t)return null;const n=await fetch(`${{}.VITE_PUBLIC_SUPABASE_URL}/functions/v1/paper-trading`,{method:"POST",headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"get_balance"})});if(!n.ok){const r=await n.json().catch(()=>({}));return console.error("Failed to ensure paper account exists:",(r==null?void 0:r.error)||n.statusText),null}const h=await n.json().catch(()=>null);return(h==null?void 0:h.account)??null},D=async()=>{try{const{data:{user:t}}=await B.auth.getUser();if(!t){U({totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,totalPnLBeforeFees:0,totalFees:0,totalPnLPercentage:0,averageWin:0,averageLoss:0,profitFactor:0,maxDrawdown:0,currentBalance:1e4,initialBalance:1e4,openPositions:0,totalVolume:0,pairsPerformance:[]}),C([]);return}const{data:n}=await B.from("paper_trading_accounts").select("*").eq("user_id",t.id).single();let h=B.from("paper_trading_trades").select("*").eq("user_id",t.id).eq("status","closed").order("closed_at",{ascending:!1});I&&(h=h.eq("symbol",I));const{data:r}=await h;let E=B.from("paper_trading_positions").select("*").eq("user_id",t.id).eq("status","open").order("opened_at",{ascending:!1});I&&(E=E.eq("symbol",I));const{data:m}=await E,W=new Set;r&&r.forEach(a=>{a.bot_id&&W.add(a.bot_id)}),m&&m.forEach(a=>{a.bot_id&&W.add(a.bot_id)});const y=new Map;if(W.size>0){const{data:a}=await B.from("trading_bots").select("id, name").in("id",Array.from(W));a&&a.forEach(g=>{y.set(g.id,g.name||"Unknown Bot")})}const N=n||await ue(),ae=(a,g={})=>{const f=(_,J=0)=>{const z=typeof _=="number"?_:parseFloat(_??"");return Number.isFinite(z)?z:J},p=f(a.entry_price),v=f(a.quantity),d=f(a.leverage,1),b=f(a.margin_used),c=g.current_price!==void 0?g.current_price:f(a.current_price,p),P=g.unrealized_pnl!==void 0?g.unrealized_pnl:f(a.unrealized_pnl),R=(a.side||"long").toString().toLowerCase()==="short"?"short":"long";return{id:a.id,symbol:a.symbol||"UNKNOWN",side:R,entry_price:p,current_price:c,quantity:v,leverage:d,unrealized_pnl:P,margin_used:b,status:a.status||"open",opened_at:a.opened_at||a.created_at||new Date().toISOString()}};let j=[];if(m&&m.length>0?(j=await Promise.all(m.map(async a=>{try{const g=a.symbol;try{const f=await ve(`${Pe.BOT_EXECUTOR}?action=market-data&symbol=${g}&exchange=bybit`),p=(f==null?void 0:f.price)||0;if(p>0){const v=parseFloat(a.entry_price??"")||0,d=parseFloat(a.leverage??"1")||1,b=parseFloat(a.margin_used??"")||0;let c=0;return v>0&&b!==0&&((a.side||"").toLowerCase()==="long"?c=(p-v)/v*b*d:c=(v-p)/v*b*d),ae(a,{current_price:p,unrealized_pnl:c})}}catch(f){console.error(`Error fetching price for ${a.symbol} via API:`,f)}}catch(g){console.error(`Error fetching price for ${a.symbol}:`,g)}return ae(a)})),C(j)):C([]),r&&r.length>0){const a=r.filter(s=>(s.pnl||0)>0),g=r.filter(s=>(s.pnl||0)<0),f=r.reduce((s,l)=>s+(l.fees||0),0),p=r.reduce((s,l)=>s+(l.pnl||0),0),v=p+f,d=r.reduce((s,l)=>{const o=parseFloat(l.quantity||0)*parseFloat(l.price||0);return s+o},0),b=a.reduce((s,l)=>s+(l.pnl||0),0),c=Math.abs(g.reduce((s,l)=>s+(l.pnl||0),0)),P=(N==null?void 0:N.initial_balance)||(n==null?void 0:n.initial_balance)||1e4,R=r.length>0?a.length/r.length*100:0,L=a.length>0?b/a.length:0,_=g.length>0?c/g.length:0,J=c>0?b/c:b>0?999:0;let z=P,H=P,Q=0;for(const s of r.sort((l,o)=>new Date(l.closed_at||l.executed_at).getTime()-new Date(o.closed_at||o.executed_at).getTime())){z+=s.pnl||0,z>H&&(H=z);const l=(H-z)/H*100;l>Q&&(Q=l)}let ne=0,pe=0;j&&j.length>0&&j.forEach(s=>{ne+=s.unrealized_pnl||0,pe+=s.margin_used||0});const be=p,Ne=P+parseFloat(((N==null?void 0:N.total_deposited)??(n==null?void 0:n.total_deposited))||0)+be+ne,$=new Map;r.forEach(s=>{const l=s.symbol||"UNKNOWN";$.has(l)||$.set(l,{symbol:l,totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,totalFees:0,totalVolume:0,averageWin:0,averageLoss:0,profitFactor:0,openPositions:0,unrealizedPnL:0,runningHours:0,botNames:[]});const o=$.get(l);if(o.totalTrades++,o.totalPnL+=s.pnl||0,o.totalFees+=s.fees||0,o.totalVolume+=parseFloat(s.quantity||0)*parseFloat(s.price||0),s.bot_id&&y.has(s.bot_id)){const F=y.get(s.bot_id);o.botNames.includes(F)||o.botNames.push(F)}(s.pnl||0)>0?o.winningTrades++:(s.pnl||0)<0&&o.losingTrades++}),m&&j&&m.forEach(s=>{const l=s.symbol||"UNKNOWN";$.has(l)||$.set(l,{symbol:l,totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,totalFees:0,totalVolume:0,averageWin:0,averageLoss:0,profitFactor:0,openPositions:0,unrealizedPnL:0,runningHours:0,botNames:[]});const o=$.get(l);if(o.openPositions++,s.bot_id&&y.has(s.bot_id)){const k=y.get(s.bot_id);o.botNames.includes(k)||o.botNames.push(k)}const F=j.find(k=>k.id===s.id);F?o.unrealizedPnL+=F.unrealized_pnl||0:o.unrealizedPnL+=parseFloat(s.unrealized_pnl||0)});const ye=Array.from($.values()).map(s=>{const l=r.filter(u=>(u.symbol||"UNKNOWN")===s.symbol),o=l.filter(u=>(u.pnl||0)>0),F=l.filter(u=>(u.pnl||0)<0),k=o.reduce((u,x)=>u+(x.pnl||0),0),Y=Math.abs(F.reduce((u,x)=>u+(x.pnl||0),0)),re=(m==null?void 0:m.filter(u=>(u.symbol||"UNKNOWN")===s.symbol))||[];let S=null,M=null;if(l.length>0){const u=l.map(x=>new Date(x.executed_at||x.closed_at||x.created_at)).filter(x=>!isNaN(x.getTime()));if(u.length>0){const x=Math.min(...u.map(X=>X.getTime())),q=Math.max(...u.map(X=>X.getTime())),G=S??Number.POSITIVE_INFINITY,je=M??Number.NEGATIVE_INFINITY;x<G&&(S=x),q>je&&(M=q)}}if(re.length>0){const u=re.map(x=>new Date(x.opened_at||x.created_at)).filter(x=>!isNaN(x.getTime()));if(u.length>0){const x=Math.min(...u.map(G=>G.getTime())),q=S??Number.POSITIVE_INFINITY;x<q&&(S=x),M=Date.now()}}let le=0;return S!==null&&M!==null&&(le=(M-S)/(1e3*60*60)),{...s,winRate:s.totalTrades>0?s.winningTrades/s.totalTrades*100:0,averageWin:s.winningTrades>0?k/s.winningTrades:0,averageLoss:s.losingTrades>0?Y/s.losingTrades:0,profitFactor:Y>0?k/Y:k>0?999:0,runningHours:le}}).sort((s,l)=>{const o=s.totalPnL+s.unrealizedPnL;return l.totalPnL+l.unrealizedPnL-o});U({totalTrades:r.length,winningTrades:a.length,losingTrades:g.length,winRate:R,totalPnL:p,totalPnLBeforeFees:v,totalFees:f,totalPnLPercentage:p/P*100,averageWin:L,averageLoss:_,profitFactor:J,maxDrawdown:Q,currentBalance:Ne,initialBalance:P,openPositions:(m==null?void 0:m.length)||0,totalVolume:d,pairsPerformance:ye})}else{const a=(N==null?void 0:N.initial_balance)||(n==null?void 0:n.initial_balance)||1e4;let g=0;j&&j.length>0&&j.forEach(d=>{g+=d.unrealized_pnl||0});const f=a+parseFloat(((N==null?void 0:N.total_deposited)??(n==null?void 0:n.total_deposited))||0)+g,p=new Map;m&&j&&m.forEach(d=>{const b=d.symbol||"UNKNOWN";p.has(b)||p.set(b,{symbol:b,totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,totalFees:0,totalVolume:0,averageWin:0,averageLoss:0,profitFactor:0,openPositions:0,unrealizedPnL:0,runningHours:0,botNames:[]});const c=p.get(b);if(c.openPositions++,d.bot_id&&y.has(d.bot_id)){const L=y.get(d.bot_id);c.botNames.includes(L)||c.botNames.push(L)}const P=j.find(L=>L.id===d.id);P?c.unrealizedPnL+=P.unrealized_pnl||0:c.unrealizedPnL+=parseFloat(d.unrealized_pnl||0);const R=new Date(d.opened_at||d.created_at);if(!isNaN(R.getTime())){const _=(new Date().getTime()-R.getTime())/(1e3*60*60);(c.runningHours===0||_>c.runningHours)&&(c.runningHours=_)}});const v=Array.from(p.values()).sort((d,b)=>{const c=d.totalPnL+d.unrealizedPnL;return b.totalPnL+b.unrealizedPnL-c});U({totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,totalPnLBeforeFees:0,totalFees:0,totalPnLPercentage:0,averageWin:0,averageLoss:0,profitFactor:0,maxDrawdown:0,currentBalance:f,initialBalance:a,openPositions:(m==null?void 0:m.length)||0,totalVolume:0,pairsPerformance:v})}}catch(t){console.error("Error fetching performance:",t),U({totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,totalPnLBeforeFees:0,totalFees:0,totalPnLPercentage:0,averageWin:0,averageLoss:0,profitFactor:0,maxDrawdown:0,currentBalance:1e4,initialBalance:1e4,openPositions:0,totalVolume:0,pairsPerformance:[]}),C([])}finally{O(!1),ee(!1),T.current&&(clearTimeout(T.current),T.current=null)}};w.useEffect(()=>{T.current&&clearTimeout(T.current),T.current=setTimeout(()=>{console.warn("Paper Trading Performance: Loading timeout, showing default data"),O(!1),U(n=>n||{totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,totalPnLBeforeFees:0,totalFees:0,totalPnLPercentage:0,averageWin:0,averageLoss:0,profitFactor:0,maxDrawdown:0,currentBalance:1e4,initialBalance:1e4,openPositions:0,totalVolume:0,pairsPerformance:[]}),C([])},1e4),D();const t=setInterval(()=>{D()},3e4);return()=>{clearInterval(t),T.current&&clearTimeout(T.current)}},[I]);const he=async()=>{ee(!0),await D()},fe=async()=>{if(window.confirm("Resetting will clear all paper trades, performance stats, and open positions. Continue?")){te(!0),O(!0);try{const{data:{session:n}}=await B.auth.getSession();if(!n)throw new Error("Not authenticated");const h=await fetch(`${{}.VITE_PUBLIC_SUPABASE_URL}/functions/v1/paper-trading`,{method:"POST",headers:{Authorization:`Bearer ${n.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"reset_performance"})});if(!h.ok){const r=await h.json().catch(()=>null);throw new Error((r==null?void 0:r.error)||"Failed to reset paper performance")}await D(),Z&&await Z(),alert("âœ… Paper trading performance reset successfully")}catch(n){console.error("Error resetting paper performance:",n),alert("Error resetting paper performance: "+((n==null?void 0:n.message)||"Unknown error"))}finally{te(!1),O(!1)}}},i=oe||{totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,totalPnLBeforeFees:0,totalFees:0,totalPnLPercentage:0,averageWin:0,averageLoss:0,profitFactor:0,maxDrawdown:0,currentBalance:1e4,initialBalance:1e4,openPositions:0,totalVolume:0,pairsPerformance:[]};return de?e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading performance data..."})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"ðŸ“Š Paper Trading Performance"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ie,{onClick:he,variant:"secondary",size:"sm",loading:ce,children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Refresh"]}),e.jsxs(ie,{onClick:fe,variant:"danger",size:"sm",loading:xe,children:[e.jsx("i",{className:"ri-history-line mr-2"}),"Reset"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total PnL"}),e.jsxs("div",{className:`text-2xl font-bold ${i.totalPnL>=0?"text-green-600":"text-red-600"}`,children:["$",i.totalPnL.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[i.totalPnLPercentage>=0?"+":"",i.totalPnLPercentage.toFixed(2),"%"]}),i.totalFees>0&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Fees: $",i.totalFees.toFixed(2)]})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Win Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[i.winRate.toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[i.winningTrades,"W / ",i.losingTrades,"L"]})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Trades"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.totalTrades}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[i.openPositions," open positions"]})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Current Balance"}),e.jsxs("div",{className:`text-2xl font-bold ${i.currentBalance>=i.initialBalance?"text-green-600":"text-red-600"}`,children:["$",i.currentBalance.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Initial: $",i.initialBalance.toFixed(2)]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Average Win"}),e.jsxs("div",{className:"text-lg font-semibold text-green-600",children:["$",i.averageWin.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Average Loss"}),e.jsxs("div",{className:"text-lg font-semibold text-red-600",children:["$",i.averageLoss.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Profit Factor"}),e.jsxs("div",{className:`text-lg font-semibold ${i.profitFactor>=1?"text-green-600":"text-red-600"}`,children:[i.profitFactor.toFixed(2),"x"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Max Drawdown"}),e.jsxs("div",{className:"text-lg font-semibold text-orange-600",children:[i.maxDrawdown.toFixed(2),"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Fees"}),e.jsxs("div",{className:"text-lg font-semibold text-red-600",children:["$",i.totalFees.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[i.totalVolume>0?(i.totalFees/i.totalVolume*100).toFixed(3)+"%":"0%"," of volume"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Volume"}),e.jsxs("div",{className:"text-lg font-semibold text-blue-600",children:["$",i.totalVolume.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[i.totalTrades," trades"]})]})]})]}),e.jsxs(V,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["ðŸ“ˆ Open Positions",e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",A.length," ",A.length===1?"position":"positions",")"]})]}),A.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-inbox-line text-4xl mb-3 block"}),e.jsx("p",{children:"No open positions"}),e.jsx("p",{className:"text-sm mt-1",children:"Positions will appear here when bots open trades"})]}):e.jsx("div",{className:"space-y-3",children:A.map(t=>{var r;const n=Number(t.margin_used??0),h=t.entry_price>0&&n!==0?t.unrealized_pnl/n*100:0;return e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-bold ${t.side==="long"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.side.toUpperCase()}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:t.symbol}),e.jsxs("span",{className:"text-sm text-gray-500 bg-gray-200 px-2 py-0.5 rounded",children:[t.leverage,"x"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-xl font-bold ${t.unrealized_pnl>=0?"text-green-600":"text-red-600"}`,children:[t.unrealized_pnl>=0?"+":"","$",t.unrealized_pnl.toFixed(2)]}),e.jsxs("div",{className:`text-xs mt-1 ${h>=0?"text-green-600":"text-red-600"}`,children:[h>=0?"+":"",h.toFixed(2),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block text-xs mb-1",children:"Entry Price"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["$",t.entry_price.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs mb-1",children:"Current Price"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["$",((r=t.current_price)==null?void 0:r.toFixed(2))||"Loading..."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs mb-1",children:"Quantity"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.quantity.toFixed(6)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs mb-1",children:"Margin Used"}),e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["$",n.toFixed(2)]})]})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200 flex items-center justify-between text-xs text-gray-400",children:[e.jsxs("span",{children:["Opened: ",new Date(t.opened_at).toLocaleString()]}),e.jsx("span",{className:"capitalize",children:t.status})]})]},t.id)})})]}),i.pairsPerformance&&i.pairsPerformance.length>0&&e.jsxs(V,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["ðŸ“Š Performance by Trading Pair",e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500 dark:text-gray-400",children:["(",i.pairsPerformance.length," ",i.pairsPerformance.length===1?"pair":"pairs",")"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.pairsPerformance.map(t=>{const n=t.totalPnL+t.unrealizedPnL;return e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white text-lg",children:t.symbol}),t.botNames&&t.botNames.length>0&&e.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:t.botNames.map((h,r)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200",children:[e.jsx("i",{className:"ri-robot-line mr-1"}),h]},r))})]}),e.jsxs("div",{className:`text-right ${n>=0?"text-green-600":"text-red-600"}`,children:[e.jsxs("div",{className:"text-xl font-bold",children:[n>=0?"+":"","$",n.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[t.unrealizedPnL!==0&&e.jsxs("span",{children:["$",t.totalPnL.toFixed(2)," realized",t.unrealizedPnL>0?" +":" ","$",t.unrealizedPnL.toFixed(2)," unrealized"]}),t.unrealizedPnL===0&&t.totalPnL!==0&&e.jsx("span",{children:"Realized PnL"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block text-xs mb-1",children:"Win Rate"}),e.jsxs("span",{className:`font-semibold ${t.winRate>=50?"text-green-600":"text-red-600"}`,children:[t.winRate.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 block text-xs mb-1",children:"Trades"}),e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[t.totalTrades," (",t.winningTrades,"W / ",t.losingTrades,"L)"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs mb-1",children:"Profit Factor"}),e.jsxs("span",{className:`font-semibold ${t.profitFactor>=1?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[t.profitFactor.toFixed(2),"x"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 block text-xs mb-1",children:"Open Positions"}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:t.openPositions})]})]}),e.jsx("div",{className:"pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Avg Win:"}),e.jsxs("span",{className:"ml-1 font-medium text-green-600",children:["$",t.averageWin.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Avg Loss:"}),e.jsxs("span",{className:"ml-1 font-medium text-red-600",children:["$",t.averageLoss.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Volume:"}),e.jsxs("span",{className:"ml-1 font-medium text-gray-900 dark:text-white",children:["$",t.totalVolume.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Fees:"}),e.jsxs("span",{className:"ml-1 font-medium text-red-600",children:["$",t.totalFees.toFixed(2)]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500",children:"Running Hours:"}),e.jsx("span",{className:"ml-1 font-medium text-blue-600",children:t.runningHours>=24?`${Math.floor(t.runningHours/24)}d ${Math.floor(t.runningHours%24)}h`:`${t.runningHours.toFixed(1)}h`})]})]})})]},t.symbol)})})]}),e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"ðŸ“‹ Activity Logs"}),e.jsxs("button",{onClick:()=>ge(!K),className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:[K?"Hide":"Show"," Logs"]})]}),K&&e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:me?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Loading logs..."})]}):se.length===0?e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx("i",{className:"ri-file-list-line text-2xl mb-2"}),e.jsx("p",{className:"text-sm",children:"No activity logs available"})]}):se.map(t=>{const n=r=>{switch(r==null?void 0:r.toLowerCase()){case"error":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200";case"warning":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200";case"success":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200";case"info":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},h=r=>{const E=new Date(r),W=new Date().getTime()-E.getTime(),y=Math.floor(W/6e4);if(y<1)return"Just now";if(y<60)return`${y}m ago`;const N=Math.floor(y/60);return N<24?`${N}h ago`:E.toLocaleDateString()};return e.jsx("div",{className:`p-3 rounded-lg border ${n(t.level)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-semibold uppercase",children:t.level}),t.category&&e.jsxs("span",{className:"text-xs text-gray-500",children:["â€¢ ",t.category]})]}),e.jsx("p",{className:"text-sm",children:t.message}),t.details&&typeof t.details=="object"&&e.jsxs("details",{className:"mt-2 text-xs",children:[e.jsx("summary",{className:"cursor-pointer text-gray-500 hover:text-gray-700",children:"View details"}),e.jsx("pre",{className:"mt-1 p-2 bg-gray-50 dark:bg-gray-800 rounded text-xs overflow-x-auto",children:JSON.stringify(t.details,null,2)})]})]}),e.jsx("span",{className:"text-xs text-gray-500 ml-4 whitespace-nowrap",children:h(t.timestamp)})]})},t.id)})})]})]})}export{ze as P};
