import{a as G,r as x,j as e,g as X,s as V}from"./index-617375de.js";import{C as h}from"./Card-015d7526.js";import{B as u}from"./Button-0907088e.js";import{H as q}from"./Header-70c524ce.js";import{H as K,a as J}from"./strategyOptions-9891a54c.js";const Y={}.VITE_PUBLIC_SUPABASE_URL||{}.VITE_SUPABASE_URL,Z={}.VITE_PUBLIC_SUPABASE_ANON_KEY||{}.VITE_SUPABASE_ANON_KEY;function le(){var F,$;const N=G(),[a,m]=x.useState({name:"",symbols:["BTCUSDT"],customPairs:"",useCustomPairs:!1,exchange:"bybit",tradingType:"futures",timeframe:"1h",leverage:5,riskLevel:"medium",tradeAmount:100,stopLoss:2,takeProfit:4,startDate:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[g,L]=x.useState({rsiThreshold:70,adxThreshold:25,bbWidthThreshold:.02,emaSlope:.5,atrPercentage:2.5,vwapDistance:1.2,momentumThreshold:.8,useMLPrediction:!0,minSamplesForML:100}),[l,i]=x.useState({bias_mode:"auto",htf_timeframe:"4h",htf_trend_indicator:"EMA200",ema_fast_period:50,require_price_vs_trend:"any",adx_min_htf:23,require_adx_rising:!0,regime_mode:"auto",adx_trend_min:25,adx_meanrev_max:19,session_filter_enabled:!1,allowed_hours_utc:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],cooldown_bars:8,atr_percentile_min:20,bb_width_min:.012,bb_width_max:.03,min_24h_volume_usd:5e8,max_spread_bps:3,risk_per_trade_pct:.75,daily_loss_limit_pct:3,weekly_loss_limit_pct:6,max_trades_per_day:8,max_concurrent:2,sl_atr_mult:1.3,tp1_r:1,tp2_r:2,tp1_size:.5,breakeven_at_r:.8,trail_after_tp1_atr:1,time_stop_hours:48,rsi_period:14,rsi_oversold:30,rsi_overbought:70,atr_period:14,atr_tp_multiplier:3,use_ml_prediction:!0,ml_confidence_threshold:.6,ml_min_samples:100}),[v,D]=x.useState(!1),[y,f]=x.useState(!1),[w,j]=x.useState(0),[k,S]=x.useState(null),[Q,A]=x.useState(null),[r,E]=x.useState(null),[R,T]=x.useState(!1),[_,B]=x.useState(""),[C,P]=x.useState(!1),p=(s,t)=>{L(c=>({...c,[s]:t}))},I=async()=>{if(!r||!a.name.trim()){alert("Please complete a backtest first");return}P(!0);try{const s=X(Y,Z),{data:{session:t}}=await s.auth.getSession();if(!t)throw new Error("Not authenticated");const c=a.useCustomPairs&&a.customPairs.trim()?a.customPairs.split(/[\n,]/).map(o=>o.trim().toUpperCase()).filter(o=>o.length>0):a.symbols,{data:n,error:d}=await s.from("backtests").insert({user_id:t.user.id,name:a.name,symbols:c,custom_pairs:a.useCustomPairs?a.customPairs:null,exchange:a.exchange,trading_type:a.tradingType,timeframe:a.timeframe,leverage:a.leverage,risk_level:a.riskLevel,trade_amount:a.tradeAmount,stop_loss:a.stopLoss,take_profit:a.takeProfit,strategy:g,strategy_config:l,start_date:a.startDate,end_date:a.endDate,status:"completed",progress:100,total_trades:r.total_trades||0,winning_trades:r.winning_trades||0,losing_trades:r.losing_trades||0,win_rate:r.win_rate||0,total_pnl:r.total_pnl||0,total_pnl_percentage:r.total_pnl_percentage||0,max_drawdown:r.max_drawdown||0,sharpe_ratio:r.sharpe_ratio||0,profit_factor:r.profit_factor||0,results_per_pair:r.results_per_pair||{},completed_at:new Date().toISOString()}).select().single();if(d)throw d;alert("âœ… Backtest saved successfully!"),A(n.id)}catch(s){console.error("Error saving backtest:",s),alert(`Failed to save backtest: ${s.message}`)}finally{P(!1)}},U=()=>{if(!r)return;let s=`Backtest Results
`;s+=`Backtest Name: ${a.name}
`,s+=`Date Range: ${a.startDate} to ${a.endDate}
`,s+=`Exchange: ${a.exchange.toUpperCase()}
`,s+=`Trading Type: ${a.tradingType}
`,s+=`Generated: ${new Date().toISOString()}

`,s+=`OVERVIEW SUMMARY
`,s+=`Total Trades,${r.total_trades||0}
`,s+=`Winning Trades,${r.winning_trades||0}
`,s+=`Losing Trades,${r.losing_trades||0}
`,s+=`Win Rate,${(r.win_rate||0).toFixed(2)}%
`,s+=`Gross Profit,$${(r.gross_profit||0).toFixed(2)}
`,s+=`Gross Loss,$${(r.gross_loss||0).toFixed(2)}
`,s+=`Net Profit,$${(r.net_profit||r.total_pnl||0).toFixed(2)}
`,s+=`Total P&L %,${(r.total_pnl_percentage||0).toFixed(2)}%
`,s+=`Max Drawdown (%),${(r.max_drawdown||0).toFixed(2)}%
`,s+=`Max Drawdown ($),$${Math.abs(r.max_drawdown_value||0).toFixed(2)}
`,s+=`Avg Drawdown,${(r.avg_drawdown||0).toFixed(2)}%
`,s+=`Sharpe Ratio,${(r.sharpe_ratio||0).toFixed(2)}
`,s+=`Profit Factor,${(r.profit_factor||0).toFixed(2)}

`,s+=`POSITION SIZE
`,s+=`Average Size,${(r.avg_position_size||0).toFixed(4)}
`,s+=`Min Size,${(r.min_position_size||0).toFixed(4)}
`,s+=`Max Size,${(r.max_position_size||0).toFixed(4)}

`,s+=`LONG/SHORT BREAKDOWN
`,s+=`Long Trades,${r.long_trades||0}
`,s+=`Long Wins,${r.long_wins||0}
`,s+=`Long Losses,${r.long_losses||0}
`,s+=`Long Win Rate,${(r.long_win_rate||0).toFixed(2)}%
`,s+=`Long PnL,$${(r.long_pnl||0).toFixed(2)}
`,s+=`Short Trades,${r.short_trades||0}
`,s+=`Short Wins,${r.short_wins||0}
`,s+=`Short Losses,${r.short_losses||0}
`,s+=`Short Win Rate,${(r.short_win_rate||0).toFixed(2)}%
`,s+=`Short PnL,$${(r.short_pnl||0).toFixed(2)}

`,r.results_per_pair&&Object.keys(r.results_per_pair).length>0&&(s+=`PER-PAIR PERFORMANCE
`,s+=`Pair,Trades,Win Rate,Total P&L,Long Trades,Short Trades,Long Wins,Long Losses,Short Wins,Short Losses,Gross Profit,Gross Loss
`,Object.entries(r.results_per_pair).forEach(([d,o])=>{s+=`${d},${o.trades||0},${(o.win_rate||0).toFixed(2)}%,$${(o.pnl||0).toFixed(2)},${o.long_trades||0},${o.short_trades||0},${o.long_wins||0},${o.long_losses||0},${o.short_wins||0},${o.short_losses||0},$${(o.gross_profit||0).toFixed(2)},$${(o.gross_loss||0).toFixed(2)}
`}));const t=new Blob([s],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(t),n=document.createElement("a");n.href=c,n.download=`backtest-${a.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(c)},M=()=>{if(!r)return;const s={backtest_name:a.name,date_range:{start:a.startDate,end:a.endDate},configuration:{exchange:a.exchange,trading_type:a.tradingType,timeframe:a.timeframe,leverage:a.leverage,risk_level:a.riskLevel,trade_amount:a.tradeAmount,stop_loss:a.stopLoss,take_profit:a.takeProfit,symbols:a.useCustomPairs&&a.customPairs.trim()?a.customPairs.split(/[\n,]/).map(o=>o.trim().toUpperCase()).filter(o=>o.length>0):a.symbols},strategy:g,strategy_config:l,results:r,generated_at:new Date().toISOString()},t=JSON.stringify(s,null,2),c=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(c),d=document.createElement("a");d.href=n,d.download=`backtest-${a.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(n)},O=async()=>{if(!r||!_.trim()){alert("Please enter a bot name");return}try{N("/create-bot",{state:{fromBacktest:!0,backtestResults:r,botName:_,backtestConfig:a,backtestStrategy:g,backtestAdvancedConfig:l}})}catch(s){console.error("Error creating bot from results:",s),alert("Failed to create bot. Please try again.")}},W=["BTCUSDT","ETHUSDT","SOLUSDT","ADAUSDT","DOTUSDT","AVAXUSDT","BNBUSDT","XRPUSDT","MATICUSDT","LINKUSDT","UNIUSDT","LTCUSDT"],z=async()=>{f(!0),S(null);try{if(!a.name.trim())throw new Error("Please enter a backtest name");let s=[];if(a.useCustomPairs){if(!a.customPairs.trim())throw new Error("Please enter at least one trading pair when using custom pairs");if(s=a.customPairs.split(/[\n,]/).map(d=>d.trim().toUpperCase()).filter(d=>d.length>0),s.length===0)throw new Error("Please enter at least one valid trading pair (e.g., BTCUSDT, ETHUSDT)");const n=s.filter(d=>!/^[A-Z]{2,10}USDT$/i.test(d));if(n.length>0)throw new Error(`Invalid pair format: ${n.join(", ")}. Pairs should be in format like BTCUSDT, ETHUSDT`)}else{if(a.symbols.length===0)throw new Error("Please select at least one trading pair");s=a.symbols}const t={name:a.name,symbols:s,customPairs:a.useCustomPairs?a.customPairs:void 0,exchange:a.exchange,tradingType:a.tradingType,timeframe:a.timeframe,leverage:a.leverage,riskLevel:a.riskLevel,tradeAmount:a.tradeAmount,stopLoss:a.stopLoss,takeProfit:a.takeProfit,strategy:g,strategyConfig:l,startDate:a.startDate,endDate:a.endDate};console.log("Starting backtest with data:",t),console.log(`Parsed ${s.length} symbols:`,s),f(!0),j(0);const c=setInterval(()=>{j(n=>n>=95?n:n+1)},500);try{const{data:n,error:d}=await V.functions.invoke("backtest-engine",{body:t});if(clearInterval(c),j(100),d)throw new Error(d.message||"Backtest failed");if(n.error)throw new Error(n.error);console.log("Backtest results:",n),E(n)}catch(n){throw clearInterval(c),new Error(n.message||"Failed to run backtest")}finally{f(!1)}}catch(s){S(s.message||"Failed to start backtest"),f(!1),j(0)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(q,{title:"Multiple Pairs Backtesting"}),e.jsx("div",{className:"pt-16 pb-6 px-4",children:e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs(h,{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"ðŸ“Š New Backtest"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Backtest Name"}),e.jsx("input",{type:"text",value:a.name,onChange:s=>m(t=>({...t,name:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter backtest name",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ðŸ“ˆ Trading Pairs to Test"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"pairMode",checked:!a.useCustomPairs,onChange:()=>m(s=>({...s,useCustomPairs:!1})),className:"mr-2"}),e.jsx("label",{className:"text-sm text-gray-700",children:"Select from popular pairs"})]}),a.useCustomPairs?e.jsx("textarea",{value:a.customPairs,onChange:s=>m(t=>({...t,customPairs:s.target.value})),placeholder:`Enter pairs separated by comma or new line
Example: BTCUSDT, ETHUSDT, SOLUSDT`,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:4}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:W.map(s=>e.jsx("button",{type:"button",onClick:()=>{const t=a.symbols.includes(s)?a.symbols.filter(c=>c!==s):[...a.symbols,s];m(c=>({...c,symbols:t}))},className:`px-3 py-2 rounded-lg border-2 ${a.symbols.includes(s)?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"}`,children:s},s))}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"pairMode",checked:a.useCustomPairs,onChange:()=>m(s=>({...s,useCustomPairs:!0})),className:"mr-2"}),e.jsx("label",{className:"text-sm text-gray-700",children:"Use custom pairs"})]}),(()=>{const s=a.useCustomPairs&&a.customPairs.trim()?a.customPairs.split(/[\n,]/).map(t=>t.trim().toUpperCase()).filter(t=>t.length>0):a.symbols;return s.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-700",children:["âœ… Selected ",s.length," pair",s.length!==1?"s":"",": ",s.join(", ")]})})})()]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:a.startDate,onChange:s=>m(t=>({...t,startDate:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:a.endDate,onChange:s=>m(t=>({...t,endDate:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exchange"}),e.jsxs("select",{value:a.exchange,onChange:s=>m(t=>({...t,exchange:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"bybit",children:"Bybit"}),e.jsx("option",{value:"okx",children:"OKX"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trading Type"}),e.jsxs("select",{value:a.tradingType,onChange:s=>m(t=>({...t,tradingType:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"spot",children:"Spot Trading"}),e.jsx("option",{value:"futures",children:"Futures Trading"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timeframe"}),e.jsxs("select",{value:a.timeframe,onChange:s=>m(t=>({...t,timeframe:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"1m",children:"1 Minute"}),e.jsx("option",{value:"3m",children:"3 Minutes"}),e.jsx("option",{value:"5m",children:"5 Minutes"}),e.jsx("option",{value:"15m",children:"15 Minutes"}),e.jsx("option",{value:"30m",children:"30 Minutes"}),e.jsx("option",{value:"1h",children:"1 Hour"}),e.jsx("option",{value:"2h",children:"2 Hours"}),e.jsx("option",{value:"4h",children:"4 Hours"}),e.jsx("option",{value:"6h",children:"6 Hours"}),e.jsx("option",{value:"12h",children:"12 Hours"}),e.jsx("option",{value:"1d",children:"1 Day"}),e.jsx("option",{value:"1w",children:"1 Week"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Leverage"}),e.jsx("input",{type:"number",value:a.leverage,onChange:s=>m(t=>({...t,leverage:parseInt(s.target.value)||1})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1",max:"100",step:"1",disabled:a.tradingType==="spot"}),a.tradingType==="spot"&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leverage not available for spot trading"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trade Amount ($)"}),e.jsx("input",{type:"number",value:a.tradeAmount,onChange:s=>m(t=>({...t,tradeAmount:parseFloat(s.target.value)||100})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"10",max:"10000",step:"10"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stop Loss (%)"}),e.jsx("input",{type:"number",value:a.stopLoss,onChange:s=>m(t=>({...t,stopLoss:parseFloat(s.target.value)||2})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0.5",max:"10",step:"0.5"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum loss percentage before closing position"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Take Profit (%)"}),e.jsx("input",{type:"number",value:a.takeProfit,onChange:s=>m(t=>({...t,takeProfit:parseFloat(s.target.value)||4})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1",max:"20",step:"0.5"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Target profit percentage before closing position"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cooldown (Bars)"}),e.jsx("input",{type:"number",value:l.cooldown_bars,onChange:s=>i(t=>({...t,cooldown_bars:parseInt(s.target.value)||8})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1",max:"100",step:"1"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Number of bars to wait between trades (prevents overtrading)"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allowed Trading Hours (EST)"}),e.jsxs("div",{className:"border border-gray-300 rounded-lg p-3 bg-gray-50 max-h-48 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",checked:l.allowed_hours_utc.length===24,onChange:s=>{s.target.checked?i(t=>({...t,allowed_hours_utc:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],session_filter_enabled:!1})):i(t=>({...t,allowed_hours_utc:[],session_filter_enabled:!0}))},className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Select All (24/7)"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:Array.from({length:24},(s,t)=>{const c=(t-5+24)%24,n=l.allowed_hours_utc.includes(t);return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:n,onChange:d=>{d.target.checked?i(o=>({...o,allowed_hours_utc:[...o.allowed_hours_utc,t].sort((b,H)=>b-H),session_filter_enabled:!0})):i(o=>({...o,allowed_hours_utc:o.allowed_hours_utc.filter(b=>b!==t),session_filter_enabled:o.allowed_hours_utc.filter(b=>b!==t).length>0}))},className:"mr-1 h-3 w-3 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("span",{className:"text-xs text-gray-700",children:[c.toString().padStart(2,"0"),":00 EST"]})]},t)})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select hours when bot is allowed to trade (stored in UTC, displayed in EST)"})]}),e.jsxs(h,{className:"p-6 mt-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-900",children:"Strategy Parameters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RSI Threshold"}),e.jsx("input",{type:"number",value:g.rsiThreshold,onChange:s=>p("rsiThreshold",parseFloat(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"30",max:"90",step:"5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ADX Threshold"}),e.jsx("input",{type:"number",value:g.adxThreshold,onChange:s=>p("adxThreshold",parseFloat(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"10",max:"50",step:"5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"BB Width Threshold"}),e.jsx("input",{type:"number",value:g.bbWidthThreshold,onChange:s=>p("bbWidthThreshold",parseFloat(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0.01",max:"0.1",step:"0.005"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ATR Percentage"}),e.jsx("input",{type:"number",value:g.atrPercentage,onChange:s=>p("atrPercentage",parseFloat(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1",max:"10",step:"0.5"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:g.useMLPrediction,onChange:s=>p("useMLPrediction",s.target.checked),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable ML Prediction"})]})})]}),e.jsxs(h,{className:"p-6 mt-6",children:[e.jsxs("button",{type:"button",onClick:()=>D(!v),className:"w-full flex items-center justify-between text-left",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"âš™ï¸ Advanced Strategy Configuration"}),e.jsx("i",{className:`ri-arrow-${v?"up":"down"}-s-line text-2xl text-gray-600`})]}),v&&e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"border-l-4 border-purple-500 pl-4",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-800 mb-3",children:"ðŸŽ¯ Directional Bias"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bias Mode"}),e.jsxs("select",{value:l.bias_mode,onChange:s=>i(t=>({...t,bias_mode:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"auto",children:"Auto (Follow HTF Trend)"}),e.jsx("option",{value:"long-only",children:"Long Only"}),e.jsx("option",{value:"short-only",children:"Short Only"}),e.jsx("option",{value:"both",children:"Both Directions"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"HTF Timeframe"}),e.jsx("select",{value:l.htf_timeframe,onChange:s=>i(t=>({...t,htf_timeframe:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:K.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"HTF Trend Indicator"}),e.jsx("select",{value:l.htf_trend_indicator,onChange:s=>i(t=>({...t,htf_trend_indicator:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:J.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["ADX Min (HTF): ",l.adx_min_htf]}),e.jsx("input",{type:"range",value:l.adx_min_htf,onChange:s=>i(t=>({...t,adx_min_htf:parseFloat(s.target.value)})),className:"w-full",min:"15",max:"35",step:"1"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Minimum ADX for trend confirmation"})]})]})]}),e.jsxs("div",{className:"border-l-4 border-indigo-500 pl-4",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-800 mb-3",children:"ðŸ“ Indicator Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EMA Length"}),e.jsx("input",{type:"number",value:l.ema_fast_period??50,onChange:s=>i(t=>({...t,ema_fast_period:parseInt(s.target.value)||50})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:1,max:500})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ATR Length"}),e.jsx("input",{type:"number",value:l.atr_period??14,onChange:s=>i(t=>({...t,atr_period:parseInt(s.target.value)||14})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:1,max:200})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ATR TP Multiplier"}),e.jsx("input",{type:"number",value:l.atr_tp_multiplier??3,onChange:s=>i(t=>({...t,atr_tp_multiplier:parseFloat(s.target.value)||3})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:.5,max:10,step:.1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ATR SL Multiplier"}),e.jsx("input",{type:"number",value:l.sl_atr_mult,onChange:s=>i(t=>({...t,sl_atr_mult:parseFloat(s.target.value)||t.sl_atr_mult})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:.5,max:5,step:.1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RSI Length"}),e.jsx("input",{type:"number",value:l.rsi_period??14,onChange:s=>i(t=>({...t,rsi_period:parseInt(s.target.value)||14})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:5,max:50})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RSI Overbought"}),e.jsx("input",{type:"number",value:l.rsi_overbought??70,onChange:s=>i(t=>({...t,rsi_overbought:parseInt(s.target.value)||70})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:50,max:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RSI Oversold"}),e.jsx("input",{type:"number",value:l.rsi_oversold??30,onChange:s=>i(t=>({...t,rsi_oversold:parseInt(s.target.value)||30})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:0,max:50})]})]})]}),e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-800 mb-3",children:"ðŸ“Š Regime Filter"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Regime Mode"}),e.jsxs("select",{value:l.regime_mode,onChange:s=>i(t=>({...t,regime_mode:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"auto",children:"Auto Detect"}),e.jsx("option",{value:"trend",children:"Trend Only"}),e.jsx("option",{value:"mean-reversion",children:"Mean Reversion Only"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["ADX Trend Min: ",l.adx_trend_min]}),e.jsx("input",{type:"range",value:l.adx_trend_min,onChange:s=>i(t=>({...t,adx_trend_min:parseFloat(s.target.value)})),className:"w-full",min:"20",max:"35",step:"1"}),e.jsx("p",{className:"text-xs text-gray-500",children:"ADX â‰¥ this = trending"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["ADX Mean Rev Max: ",l.adx_meanrev_max]}),e.jsx("input",{type:"range",value:l.adx_meanrev_max,onChange:s=>i(t=>({...t,adx_meanrev_max:parseFloat(s.target.value)})),className:"w-full",min:"15",max:"25",step:"1"}),e.jsx("p",{className:"text-xs text-gray-500",children:"ADX â‰¤ this = ranging"})]})]})]}),e.jsxs("div",{className:"border-l-4 border-red-500 pl-4",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-800 mb-3",children:"ðŸ›¡ï¸ Risk Management"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Risk Per Trade: ",l.risk_per_trade_pct,"%"]}),e.jsx("input",{type:"range",value:l.risk_per_trade_pct,onChange:s=>i(t=>({...t,risk_per_trade_pct:parseFloat(s.target.value)})),className:"w-full",min:"0.25",max:"2.0",step:"0.25"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Daily Loss Limit: ",l.daily_loss_limit_pct,"%"]}),e.jsx("input",{type:"range",value:l.daily_loss_limit_pct,onChange:s=>i(t=>({...t,daily_loss_limit_pct:parseFloat(s.target.value)})),className:"w-full",min:"1",max:"10",step:"0.5"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Max Trades/Day: ",l.max_trades_per_day]}),e.jsx("input",{type:"range",value:l.max_trades_per_day,onChange:s=>i(t=>({...t,max_trades_per_day:parseInt(s.target.value)})),className:"w-full",min:"1",max:"200",step:"1"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Weekly Loss Limit: ",l.weekly_loss_limit_pct,"%"]}),e.jsx("input",{type:"range",value:l.weekly_loss_limit_pct,onChange:s=>i(t=>({...t,weekly_loss_limit_pct:parseFloat(s.target.value)})),className:"w-full",min:"2",max:"15",step:"0.5"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Auto-pause if weekly loss exceeds"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Max Concurrent Positions: ",l.max_concurrent]}),e.jsx("input",{type:"range",value:l.max_concurrent,onChange:s=>i(t=>({...t,max_concurrent:parseInt(s.target.value)})),className:"w-full",min:"1",max:"5",step:"1"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Max open positions simultaneously"})]})]})]}),e.jsxs("div",{className:"border-l-4 border-orange-500 pl-4 mt-6",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-800 mb-3",children:"ðŸ›¡ï¸ Safety Features"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Configure automatic safety limits to protect your bot from excessive losses."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Max Consecutive Losses: ",l.max_consecutive_losses||5]}),e.jsx("input",{type:"range",value:l.max_consecutive_losses||5,onChange:s=>i(t=>({...t,max_consecutive_losses:parseInt(s.target.value)})),className:"w-full",min:"2",max:"10",step:"1"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-pause bot after this many consecutive losses"})]})})]}),e.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-800 mb-3",children:"ðŸŽ¯ Exit Strategy"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["TP1 (R): ",l.tp1_r]}),e.jsx("input",{type:"range",value:l.tp1_r,onChange:s=>i(t=>({...t,tp1_r:parseFloat(s.target.value)})),className:"w-full",min:"0.5",max:"3.0",step:"0.25"}),e.jsx("p",{className:"text-xs text-gray-500",children:"First take profit (R = Risk units)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["TP2 (R): ",l.tp2_r]}),e.jsx("input",{type:"range",value:l.tp2_r,onChange:s=>i(t=>({...t,tp2_r:parseFloat(s.target.value)})),className:"w-full",min:"1.0",max:"5.0",step:"0.25"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Second take profit"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["TP1 Size: ",(l.tp1_size*100).toFixed(0),"%"]}),e.jsx("input",{type:"range",value:l.tp1_size,onChange:s=>i(t=>({...t,tp1_size:parseFloat(s.target.value)})),className:"w-full",min:"0.25",max:"0.75",step:"0.05"}),e.jsx("p",{className:"text-xs text-gray-500",children:"% to close at TP1"})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"âš¡ Quick Presets"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("button",{type:"button",onClick:()=>i({...l,bias_mode:"auto",regime_mode:"trend",risk_per_trade_pct:.5,max_trades_per_day:6,tp1_r:1.5,tp2_r:3}),className:"px-4 py-2 bg-white border-2 border-blue-300 text-blue-700 rounded-lg hover:bg-blue-50 font-medium",children:"ðŸ¢ Conservative"}),e.jsx("button",{type:"button",onClick:()=>i({...l,bias_mode:"auto",regime_mode:"auto",risk_per_trade_pct:.75,max_trades_per_day:8,tp1_r:1,tp2_r:2}),className:"px-4 py-2 bg-white border-2 border-blue-300 text-blue-700 rounded-lg hover:bg-blue-50 font-medium",children:"âš–ï¸ Balanced"}),e.jsx("button",{type:"button",onClick:()=>i({...l,bias_mode:"both",regime_mode:"auto",risk_per_trade_pct:1,max_trades_per_day:12,tp1_r:.8,tp2_r:1.5}),className:"px-4 py-2 bg-white border-2 border-blue-300 text-blue-700 rounded-lg hover:bg-blue-50 font-medium",children:"ðŸš€ Aggressive"})]})]})]})]}),k&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700",children:k})}),r&&e.jsxs(h,{className:"p-6 mt-6 bg-green-50 border-green-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"ðŸ“Š Backtest Results"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.total_trades||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Trades"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(r.win_rate||0).toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Win Rate"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["$",(r.net_profit||r.total_pnl||0).toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Net Profit"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(r.sharpe_ratio||0).toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Sharpe Ratio"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-800",children:"ðŸ’° Profit Breakdown"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:["$",(r.gross_profit||0).toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Gross Profit"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-red-600",children:["$",(r.gross_loss||0).toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Gross Loss"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:`text-lg font-bold ${(r.net_profit||r.total_pnl||0)>=0?"text-green-600":"text-red-600"}`,children:["$",(r.net_profit||r.total_pnl||0).toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Net Profit"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-800",children:"ðŸ“ Position Size"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:(r.avg_position_size||0).toFixed(4)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Average Size"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-gray-600",children:(r.min_position_size||0).toFixed(4)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Min Size"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-gray-600",children:(r.max_position_size||0).toFixed(4)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Max Size"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-800",children:"ðŸ“ˆ Long/Short Performance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[e.jsx("h5",{className:"font-medium text-green-700 mb-2",children:"ðŸ”¼ Long Trades"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total:"}),e.jsx("span",{className:"font-semibold",children:r.long_trades||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Wins:"}),e.jsx("span",{className:"font-semibold text-green-600",children:r.long_wins||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Losses:"}),e.jsx("span",{className:"font-semibold text-red-600",children:r.long_losses||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Win Rate:"}),e.jsxs("span",{className:"font-semibold",children:[(r.long_win_rate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-gray-600",children:"PnL:"}),e.jsxs("span",{className:`font-bold ${(r.long_pnl||0)>=0?"text-green-600":"text-red-600"}`,children:["$",(r.long_pnl||0).toFixed(2)]})]})]})]}),e.jsxs("div",{className:"border-l-4 border-red-500 pl-4",children:[e.jsx("h5",{className:"font-medium text-red-700 mb-2",children:"ðŸ”½ Short Trades"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total:"}),e.jsx("span",{className:"font-semibold",children:r.short_trades||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Wins:"}),e.jsx("span",{className:"font-semibold text-green-600",children:r.short_wins||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Losses:"}),e.jsx("span",{className:"font-semibold text-red-600",children:r.short_losses||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Win Rate:"}),e.jsxs("span",{className:"font-semibold",children:[(r.short_win_rate||0).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-gray-600",children:"PnL:"}),e.jsxs("span",{className:`font-bold ${(r.short_pnl||0)>=0?"text-green-600":"text-red-600"}`,children:["$",(r.short_pnl||0).toFixed(2)]})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-800",children:"ðŸ“‰ Drawdown Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-red-600",children:[(r.max_drawdown||0).toFixed(2),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Max Drawdown (%)"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-red-600",children:["$",Math.abs(r.max_drawdown_value||0).toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Max Drawdown ($)"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[(r.avg_drawdown||0).toFixed(2),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Avg Drawdown (%)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("div",{className:"text-xl font-bold text-green-600",children:r.winning_trades||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Winning Trades"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("div",{className:"text-xl font-bold text-red-600",children:r.losing_trades||0}),e.jsx("div",{className:"text-sm text-gray-500",children:"Losing Trades"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:(r.profit_factor||0).toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Profit Factor"})]})]}),r.results_per_pair&&Object.keys(r.results_per_pair).length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Performance by Pair"}),e.jsx("div",{className:"space-y-2",children:Object.entries(r.results_per_pair).map(([s,t])=>e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-lg",children:s}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.trades||0," trades"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`font-bold text-lg ${(t.pnl||0)>=0?"text-green-600":"text-red-600"}`,children:["$",(t.pnl||0).toFixed(2)]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[(t.win_rate||0).toFixed(1),"% win"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mt-3 pt-3 border-t border-gray-200 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-gray-500",children:["Long: ",t.long_trades||0]}),e.jsxs("div",{className:"text-gray-500",children:["Short: ",t.short_trades||0]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-green-600",children:["Wins: ",(t.long_wins||0)+(t.short_wins||0)]}),e.jsxs("div",{className:"text-red-600",children:["Losses: ",(t.long_losses||0)+(t.short_losses||0)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Gross Profit:"}),e.jsxs("div",{className:"text-green-600 font-semibold",children:["$",(t.gross_profit||0).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Gross Loss:"}),e.jsxs("div",{className:"text-red-600 font-semibold",children:["$",(t.gross_loss||0).toFixed(2)]})]})]})]},s))})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-green-300 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:I,disabled:C,className:"w-full",children:C?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-save-line mr-2"}),"Save to Database"]})}),e.jsxs(u,{type:"button",variant:"secondary",onClick:U,className:"w-full",children:[e.jsx("i",{className:"ri-file-download-line mr-2"}),"Export CSV"]}),e.jsxs(u,{type:"button",variant:"secondary",onClick:M,className:"w-full",children:[e.jsx("i",{className:"ri-file-code-line mr-2"}),"Export JSON"]})]}),e.jsxs(u,{type:"button",variant:"primary",onClick:()=>T(!0),className:"w-full",children:[e.jsx("i",{className:"ri-robot-add-line mr-2"}),"Create Trading Bot from This Backtest"]})]})]}),R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(h,{className:"w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Create Trading Bot from Backtest"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Use this successful backtest to create a live trading bot with the same strategy."}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bot Name"}),e.jsx("input",{type:"text",value:_,onChange:s=>B(s.target.value),placeholder:"Enter bot name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-gray-500",children:"Win Rate"}),e.jsxs("div",{className:"text-xl font-bold text-green-600",children:[(F=r==null?void 0:r.win_rate)==null?void 0:F.toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-gray-500",children:"Total PnL"}),e.jsxs("div",{className:"text-xl font-bold text-purple-600",children:["$",($=r==null?void 0:r.total_pnl)==null?void 0:$.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:()=>T(!1),className:"flex-1",children:"Cancel"}),e.jsx(u,{type:"button",variant:"primary",onClick:O,className:"flex-1",disabled:!_.trim(),children:"Create Bot"})]})]})}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:()=>N("/bots"),className:"flex-1",children:"Cancel"}),e.jsx(u,{type:"button",variant:"primary",onClick:z,loading:y,className:"flex-1",children:y?"Running Backtest...":"ðŸš€ Start Backtest"})]}),y&&e.jsxs(h,{className:"p-6 mt-6",children:[e.jsxs("div",{className:"mb-2 flex justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Backtest Progress"}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[Math.floor(w),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-300",style:{width:`${w}%`}})}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:(()=>{const s=a.useCustomPairs&&a.customPairs.trim()?a.customPairs.split(/[\n,]/).map(t=>t.trim().toUpperCase()).filter(t=>t.length>0).length:a.symbols.length;return`Simulating trades across ${s} pair${s!==1?"s":""}...`})()})]})]})})})]})}export{le as default};
