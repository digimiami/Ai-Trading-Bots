import{s as T,r as v,j as e,a as U,c as $}from"./index-2e73d2fc.js";import{B as P}from"./Button-5c616256.js";import{C as L}from"./Card-78cb4995.js";import{H as F}from"./Header-0462d24a.js";import{u as V}from"./useBots-603bab49.js";import{o as q}from"./openai-6b21b11d.js";import{S as H}from"./strategyPresets-48507061.js";const W={adx_min_htf:{min:15,max:35},adx_trend_min:{min:15,max:50},adx_meanrev_max:{min:10,max:25},risk_per_trade_pct:{min:.1,max:5},daily_loss_limit_pct:{min:.5,max:10},weekly_loss_limit_pct:{min:1,max:20},max_trades_per_day:{min:1,max:200},max_concurrent:{min:1,max:10},sl_atr_mult:{min:.5,max:5},tp1_r:{min:.5,max:10},tp2_r:{min:1,max:20},tp1_size:{min:.1,max:1},breakeven_at_r:{min:.1,max:2},trail_after_tp1_atr:{min:.1,max:5},time_stop_hours:{min:1,max:168},rsi_period:{min:5,max:50},rsi_oversold:{min:0,max:50},rsi_overbought:{min:50,max:100},ema_fast_period:{min:5,max:200},atr_percentile_min:{min:0,max:100},bb_width_min:{min:0,max:.1},bb_width_max:{min:0,max:.2},max_spread_bps:{min:0,max:100},cooldown_bars:{min:1,max:100},atr_period:{min:1,max:200},atr_tp_multiplier:{min:.5,max:10}},K={bias_mode:["long-only","short-only","both","auto"],htf_timeframe:["15m","30m","1h","2h","4h","6h","12h","1d","1w"],htf_trend_indicator:["EMA50","EMA100","EMA200","SMA50","SMA200","MA_CROSSOVER_50_200","Supertrend","DonchianChannel20","KeltnerChannelMidline","BollingerBasis20SMA","HullMA55","HullMA100","VWAP","GChannelBaseline","MACDZeroLine","RSI50Baseline","HeikinAshiTrend","IchimokuKumoTrend"],require_price_vs_trend:["above","below","any"],regime_mode:["trend","mean-reversion","auto"]};function J(g){const i={...g};for(const[r,s]of Object.entries(W))r in i&&typeof i[r]=="number"&&(i[r]=Math.max(s.min,Math.min(s.max,i[r])));for(const[r,s]of Object.entries(K))r in i&&!s.includes(i[r])&&(console.warn(`Invalid ${r}: ${i[r]}. Setting to default: ${s[0]}`),i[r]=s[0]);return i.allowed_hours_utc&&Array.isArray(i.allowed_hours_utc)&&(i.allowed_hours_utc=i.allowed_hours_utc.filter(r=>typeof r=="number"&&r>=0&&r<=23).slice(0,24)),i}let Y=class{constructor(){this.optimizationInterval=36e5,this.minTradesForOptimization=10}async analyzeBotPerformance(i){try{const{data:r,error:s}=await T.from("trading_bots").select("*").eq("id",i).single();if(s||!r)return console.error("Error fetching bot:",s),null;const o=new Date;o.setDate(o.getDate()-30);const{data:u,error:m}=await T.from("trades").select("*").eq("bot_id",i).gte("created_at",o.toISOString()).order("created_at",{ascending:!1});if(m)return console.error("Error fetching trades:",m),null;if(!u||u.length<this.minTradesForOptimization)return console.log(`Insufficient trades for optimization. Need ${this.minTradesForOptimization}, have ${(u==null?void 0:u.length)||0}`),null;const p=u.filter(n=>n.status==="closed"&&n.pnl!==null),d=p.filter(n=>n.pnl>0),c=p.filter(n=>n.pnl<=0),l=p.reduce((n,f)=>n+(f.pnl||0),0),_=p.length>0?d.length/p.length*100:0,h=d.length>0?d.reduce((n,f)=>n+(f.pnl||0),0)/d.length:0,x=c.length>0?c.reduce((n,f)=>n+Math.abs(f.pnl||0),0)/c.length:0,b=x!==0?Math.abs(h/x):0;let w=0,j=0,N=0;for(const n of p.sort((f,z)=>new Date(f.created_at||f.timestamp).getTime()-new Date(z.created_at||z.timestamp).getTime())){N+=n.pnl||0,N>j&&(j=N);const f=j-N;f>w&&(w=f)}const O=p.reduce((n,f)=>(n[f.symbol]||(n[f.symbol]=[]),n[f.symbol].push(f),n),{});let t="",a="",S=-1/0,E=1/0;for(const[n,f]of Object.entries(O)){const z=f.reduce((I,R)=>I+(R.pnl||0),0);z>S&&(S=z,t=n),z<E&&(E=z,a=n)}const C=p.map(n=>(n.pnl||0)/(n.entry_price||1)),k=C.reduce((n,f)=>n+f,0)/C.length,A=C.reduce((n,f)=>n+Math.pow(f-k,2),0)/C.length,M=A!==0?k/Math.sqrt(A):0;let y={};try{typeof r.strategy=="string"?(y=JSON.parse(r.strategy),typeof y=="string"&&(y=JSON.parse(y))):r.strategy&&typeof r.strategy=="object"&&(y=r.strategy),y={rsiThreshold:y.rsiThreshold||70,adxThreshold:y.adxThreshold||25,bbWidthThreshold:y.bbWidthThreshold||.02,emaSlope:y.emaSlope||.5,atrPercentage:y.atrPercentage||2.5,vwapDistance:y.vwapDistance||1.2,momentumThreshold:y.momentumThreshold||.8,useMLPrediction:y.useMLPrediction||!1,minSamplesForML:y.minSamplesForML||100}}catch(n){console.error("Error parsing strategy:",n),y={rsiThreshold:70,adxThreshold:25,bbWidthThreshold:.02,emaSlope:.5,atrPercentage:2.5,vwapDistance:1.2,momentumThreshold:.8,useMLPrediction:!1,minSamplesForML:100}}let D;try{if(r.strategy_config){let n=typeof r.strategy_config=="string"?JSON.parse(r.strategy_config):r.strategy_config;n&&typeof n=="object"&&(D={bias_mode:n.bias_mode,risk_per_trade_pct:n.risk_per_trade_pct,adx_min_htf:n.adx_min_htf,regime_mode:n.regime_mode,sl_atr_mult:n.sl_atr_mult,tp1_r:n.tp1_r,tp2_r:n.tp2_r})}}catch(n){console.error("Error parsing strategy_config:",n),D=void 0}return{botId:i,totalTrades:u.length,closedTrades:p.length,winRate:_,totalPnL:l,avgWinPnL:h,avgLossPnL:x,maxDrawdown:w,sharpeRatio:M,profitFactor:b,bestPerformingPair:t,worstPerformingPair:a,recentTrades:u.slice(0,50).map(n=>({id:n.id,symbol:n.symbol,side:n.side,entryPrice:n.entry_price,exitPrice:n.exit_price,pnl:n.pnl,status:n.status,timestamp:n.created_at||n.timestamp})),timeRange:"30 days",currentStrategy:y,currentAdvancedConfig:D}}catch(r){return console.error("Error analyzing bot performance:",r),null}}async optimizeStrategy(i){try{const r=await this.analyzeBotPerformance(i);if(!r)return null;const s=r.recentTrades.slice(-5),o=await q.optimizeStrategy({strategy:r.currentStrategy,advancedConfig:r.currentAdvancedConfig},s.map(d=>({symbol:d.symbol,entryPrice:d.entryPrice,exitPrice:d.exitPrice||d.entryPrice,pnl:d.pnl||0,outcome:(d.pnl||0)>0?"win":"loss",timestamp:d.timestamp})),{winRate:r.winRate,totalPnL:r.totalPnL,avgWin:r.avgWinPnL,avgLoss:r.avgLossPnL,profitFactor:r.profitFactor,sharpeRatio:r.sharpeRatio,maxDrawdown:r.maxDrawdown}),u=[],m=r.currentStrategy,p=o.strategy||m;return Object.keys(p).forEach(d=>{const c=m[d],l=p[d];c!==l&&u.push({parameter:`strategy.${d}`,oldValue:c,newValue:l,reason:o.reasoning||"AI optimization"})}),r.currentAdvancedConfig&&o.advancedConfig&&Object.keys(o.advancedConfig).forEach(d=>{const c=r.currentAdvancedConfig[d],l=o.advancedConfig[d];c!==l&&u.push({parameter:`advancedConfig.${d}`,oldValue:c,newValue:l,reason:o.reasoning||"AI optimization"})}),{success:!0,botId:i,originalStrategy:m,optimizedStrategy:p,originalAdvancedConfig:r.currentAdvancedConfig,optimizedAdvancedConfig:o.advancedConfig||r.currentAdvancedConfig,reasoning:o.reasoning||"AI-generated optimization",expectedImprovement:o.expectedImprovement||"Unknown",confidence:o.confidence||.7,changes:u}}catch(r){return console.error("Error optimizing strategy:",r),null}}async autoApplyOptimization(i,r=.75){try{const s=await this.optimizeStrategy(i);if(!s||!s.success)return console.warn("⚠️ Optimization failed or returned null:",s),!1;if(s.confidence<r)return console.warn(`⚠️ Optimization confidence ${(s.confidence*100).toFixed(1)}% below threshold ${(r*100).toFixed(1)}%`),!1;const o=await this.getPerformanceSnapshot(i),u=({}.VITE_DEEPSEEK_API_KEY?"DeepSeek":"OpenAI")||"Unknown",m={}.VITE_DEEPSEEK_API_KEY?"deepseek-chat":"gpt-4o",p={bot_id:i,original_strategy:s.originalStrategy,suggested_changes:{strategy:s.optimizedStrategy,advancedConfig:s.optimizedAdvancedConfig},reasoning:s.reasoning,expected_improvement:Math.min(999.99,Math.max(-999.99,parseFloat(s.expectedImprovement.replace(/[^0-9.-]/g,""))||0)),performance_before:{...o,timestamp:new Date().toISOString(),ai_provider:u,ai_model:m,confidence:s.confidence},status:"applied",applied_at:new Date().toISOString()};try{p.ai_provider=u,p.ai_model=m,p.confidence=s.confidence}catch{console.log("Note: AI metadata columns not found, storing in performance_before JSONB")}const{data:d,error:c}=await T.from("strategy_optimizations").insert(p).select().single();c?console.error("Error recording optimization:",c):console.log(`✅ Optimization record created: ${d==null?void 0:d.id} using ${u}`),await this.logOptimization(i,{...s});let l=s.optimizedAdvancedConfig;l&&(l=J(l),console.log("✅ Validated and clamped advanced strategy config"));const{error:_}=await T.from("trading_bots").update({strategy:s.optimizedStrategy,strategy_config:l||s.optimizedAdvancedConfig,updated_at:new Date().toISOString()}).eq("id",i);return _?(console.error("Error applying optimization:",_),!1):(await this.logOptimization(i,s),console.log(`✅ Successfully optimized bot ${i}`),!0)}catch(s){return console.error("Error auto-applying optimization:",s),!1}}async getPerformanceSnapshot(i){const{data:r}=await T.from("trading_bots").select("pnl, pnl_percentage, total_trades, win_rate").eq("id",i).single();return r||{}}async logOptimization(i,r){try{const s=r.changes.map(c=>`${c.parameter}: ${JSON.stringify(c.oldValue)} → ${JSON.stringify(c.newValue)}`).join(", "),o=({}.VITE_DEEPSEEK_API_KEY?"DeepSeek":"OpenAI")||"Unknown",u={}.VITE_DEEPSEEK_API_KEY?"deepseek-chat":"gpt-4o",m=`${o} Auto-Optimization Applied (Confidence: ${(r.confidence*100).toFixed(1)}%)`,p={type:"ai_ml_optimization_applied",ai_provider:o,ai_model:u,confidence:r.confidence,reasoning:r.reasoning,expectedImprovement:r.expectedImprovement,changes:r.changes,changeCount:r.changes.length,changeSummary:s,optimizedStrategy:r.optimizedStrategy,optimizedAdvancedConfig:r.optimizedAdvancedConfig,originalStrategy:r.originalStrategy,originalAdvancedConfig:r.originalAdvancedConfig,applied_at:new Date().toISOString(),trigger:"auto-pilot_mode"},{error:d}=await T.from("bot_activity_logs").insert({bot_id:i,level:"success",category:"strategy",message:m,details:p,timestamp:new Date().toISOString()});d?console.error("Error logging optimization:",d):console.log(`✅ Optimization logged to bot_activity_logs for bot ${i} using ${o}`)}catch(s){console.error("Error logging optimization:",s)}}async learnFromTrade(i,r){try{const{data:s,error:o}=await T.from("trades").select("*").eq("id",i).single();if(o||!s||s.status!=="closed")return;const{error:u}=await T.from("ai_learning_data").insert({bot_id:r,trade_id:i,symbol:s.symbol,market_conditions:{side:s.side,entryPrice:s.entry_price,exitPrice:s.exit_price},outcome:(s.pnl||0)>0?"win":"loss",pnl:s.pnl||0});u&&console.error("Error storing learning data:",u)}catch(s){console.error("Error learning from trade:",s)}}async optimizeAllActiveBots(i){try{let r=T.from("trading_bots").select("id, user_id, ai_ml_enabled").eq("status","running").eq("ai_ml_enabled",!0);i&&(r=r.eq("user_id",i));const{data:s,error:o}=await r;if(o||!s||s.length===0){console.log("No active bots with AI/ML enabled for optimization");return}console.log(`Running optimization for ${s.length} active bots...`);for(const u of s)try{await this.autoApplyOptimization(u.id,.7),await new Promise(m=>setTimeout(m,1e3))}catch(m){console.error(`Error optimizing bot ${u.id}:`,m)}}catch(r){console.error("Error optimizing all bots:",r)}}};const B=new Y;function X(g){const[i,r]=v.useState(!1),[s,o]=v.useState(null),[u,m]=v.useState(null),p=g?`auto-pilot-enabled-${g}`:null,[d,c]=v.useState(()=>p&&typeof window<"u"?localStorage.getItem(p)==="true":!1),l=x=>{c(x),p&&typeof window<"u"&&localStorage.setItem(p,x.toString())},_=v.useCallback(async()=>{if(g)try{r(!0),m(null);const x=await B.optimizeStrategy(g);return o(x),x}catch(x){const b=x instanceof Error?x.message:"Optimization failed";return m(b),console.error("Optimization error:",x),null}finally{r(!1)}},[g]),h=v.useCallback(async(x=.75)=>{if(!g)return!1;try{r(!0),m(null);const b=await B.autoApplyOptimization(g,x);return b&&await _(),b}catch(b){const w=b instanceof Error?b.message:"Auto-apply failed";return m(w),!1}finally{r(!1)}},[g,_]);return v.useEffect(()=>{if(!d||!g)return;const x=setInterval(async()=>{try{await B.autoApplyOptimization(g,.7)}catch(b){console.error("Automatic optimization error:",b)}},36e5);return()=>clearInterval(x)},[d,g]),{isOptimizing:i,optimizationResult:s,error:u,optimizeBot:_,autoApplyOptimization:h,autoOptimizeEnabled:d,setAutoOptimizeEnabled:l}}function G({botId:g}){const[i,r]=v.useState([]),[s,o]=v.useState(!0),[u,m]=v.useState(null);v.useEffect(()=>{p()},[g]);const p=async()=>{try{o(!0);const{data:{session:l}}=await T.auth.getSession();if(!l){console.warn("AiOptimizationLogs: No active session, skipping fetch"),r([]);return}const{data:_,error:h}=await T.from("bot_activity_logs").select("*").eq("bot_id",g).eq("category","strategy").order("timestamp",{ascending:!1}).limit(50);if(h){console.error("Error fetching optimization logs:",h);return}const x=(_||[]).filter(b=>{var w;return((w=b.details)==null?void 0:w.type)==="ai_ml_optimization"||b.message&&b.message.includes("AI/ML")});r(x)}catch(l){console.error("Error fetching logs:",l)}finally{o(!1)}},d=l=>new Date(l).toLocaleString(),c=l=>l>=.75?"text-green-600 dark:text-green-400":l>=.6?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400";return s?e.jsx(L,{title:"AI/ML Optimization History",className:"mt-4",children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Loading optimization history..."})]})}):i.length===0?e.jsx(L,{title:"AI/ML Optimization History",className:"mt-4",children:e.jsx("div",{className:"text-center py-6",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No AI/ML optimizations yet. Optimizations will appear here once applied."})})}):e.jsx(L,{title:"AI/ML Optimization History",className:"mt-4",children:e.jsx("div",{className:"space-y-3",children:i.map(l=>{var _,h,x,b,w,j,N,O,t,a,S,E,C,k,A,M,y,D,n,f;return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200",children:"AI/ML Optimized"}),e.jsxs("span",{className:`text-sm font-semibold ${c(((_=l.details)==null?void 0:_.confidence)||0)}`,children:[((((h=l.details)==null?void 0:h.confidence)??0)*100).toFixed(1),"% Confidence"]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:d(l.timestamp)})]}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-gray-100 mb-2",children:l.message}),((x=l.details)==null?void 0:x.expectedImprovement)&&e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 mb-2",children:["Expected: ",(b=l.details)==null?void 0:b.expectedImprovement]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("strong",{children:"Changes:"})," ",((j=(w=l.details)==null?void 0:w.changes)==null?void 0:j.length)||0," parameter(s) modified"]})]}),e.jsxs("button",{onClick:()=>m(u===l.id?null:l.id),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm font-medium",children:[u===l.id?"Hide":"View"," Details"]})]}),u===l.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 space-y-3",children:[((N=l.details)==null?void 0:N.reasoning)&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-1",children:"AI Reasoning:"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:(O=l.details)==null?void 0:O.reasoning})]}),((t=l.details)==null?void 0:t.changes)&&l.details.changes.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:"Parameter Changes:"}),e.jsx("div",{className:"space-y-2",children:(a=l.details)==null?void 0:a.changes.map((z,I)=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded p-2 text-xs",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100 mb-1",children:z.parameter}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[e.jsx("span",{className:"line-through text-red-600 dark:text-red-400",children:JSON.stringify(z.oldValue)}),e.jsx("span",{children:"→"}),e.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",children:JSON.stringify(z.newValue)})]})]},I))})]}),((S=l.details)==null?void 0:S.performanceBefore)&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-1",children:"Performance Before Optimization:"}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsxs("div",{children:["Win Rate: ",((k=(C=(E=l.details)==null?void 0:E.performanceBefore)==null?void 0:C.winRate)==null?void 0:k.toFixed(2))||"N/A","%"]}),e.jsxs("div",{children:["Total PnL: $",((y=(M=(A=l.details)==null?void 0:A.performanceBefore)==null?void 0:M.totalPnL)==null?void 0:y.toFixed(2))||"0.00"]}),e.jsxs("div",{children:["Profit Factor: ",((f=(n=(D=l.details)==null?void 0:D.performanceBefore)==null?void 0:n.profitFactor)==null?void 0:f.toFixed(2))||"N/A"]})]})]})]})]},l.id)})})})}function Z({bot:g}){const{isOptimizing:i,optimizationResult:r,error:s,optimizeBot:o,autoApplyOptimization:u,autoOptimizeEnabled:m,setAutoOptimizeEnabled:p}=X(g.id),[d,c]=v.useState(!1),l=async()=>{await o()&&c(!0)},_=async()=>{try{if(await u(.65))alert("✅ Optimization applied successfully! The bot will now use the optimized parameters."),await o();else if(r){const x=(r.confidence*100).toFixed(1);r.confidence<.65?alert(`⚠️ Optimization not applied - confidence too low (${x}%). Minimum required: 65%. Please review the optimization details before applying.`):alert("⚠️ Optimization not applied - failed to update bot. Please check console for details.")}else alert('⚠️ Optimization not applied - no optimization result available. Please run "Analyze & Optimize" first.')}catch(h){console.error("Error applying optimization:",h),alert(`❌ Error applying optimization: ${h instanceof Error?h.message:"Unknown error"}`)}};return e.jsxs(L,{title:"AI Auto-Optimization",className:"mt-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:g.aiMlEnabled?"AI/ML learning enabled - bot will analyze trades and optimize strategies":"Enable AI/ML in bot settings to use auto-optimization"}),r&&e.jsxs("p",{className:"text-sm mt-2",children:[e.jsx("span",{className:"font-semibold",children:"Confidence:"})," ",e.jsxs("span",{className:r.confidence>.7?"text-green-600":"text-yellow-600",children:[(r.confidence*100).toFixed(1),"%"]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(P,{onClick:l,disabled:i||!g.aiMlEnabled,loading:i,variant:"primary",children:"Analyze & Optimize"})})]}),g.aiMlEnabled&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"ri-flight-takeoff-line text-xl text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Auto-Pilot Mode"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:m?"✅ Optimizing automatically every 1 hour":"Bot will automatically optimize every hour when enabled"}),m&&e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Uses 70% confidence threshold for auto-apply"})]})]})}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:h=>p(h.target.checked),className:"sr-only peer",disabled:!g.aiMlEnabled}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),s&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200",children:s})}),r&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"Optimization Available"}),e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 mb-3",children:r.reasoning}),e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("strong",{children:"Expected Improvement:"})," ",r.expectedImprovement]})]}),d&&r.changes.length>0&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[e.jsx("h5",{className:"font-semibold mb-2",children:"Suggested Changes:"}),e.jsx("ul",{className:"space-y-2",children:r.changes.map((h,x)=>e.jsxs("li",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[h.parameter,":"]})," ",e.jsx("span",{className:"text-red-600 dark:text-red-400",children:String(h.oldValue)})," → ",e.jsx("span",{className:"text-green-600 dark:text-green-400",children:String(h.newValue)}),h.reason&&e.jsx("span",{className:"text-gray-600 dark:text-gray-400 block ml-4",children:h.reason})]},x))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{onClick:()=>c(!d),variant:"secondary",children:d?"Hide Details":"Show Details"}),e.jsxs(P,{onClick:_,variant:"primary",disabled:r.confidence<.5,title:r.confidence<.65?`Confidence too low (${(r.confidence*100).toFixed(1)}%). Minimum: 65%`:"Apply optimization",children:["Apply Optimization ",(r.confidence*100).toFixed(0),"%"]})]})]}),!g.aiMlEnabled&&e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"⚠️ Enable AI/ML learning in bot settings to use auto-optimization features."})})]}),e.jsx(G,{botId:g.id})]})}function oe(){const g=U(),{botId:i}=$(),{bots:r,updateBot:s}=V(),[o,u]=v.useState({name:"",exchange:"bybit",tradingType:"spot",symbol:"BTCUSDT",timeframe:"1h",leverage:5,riskLevel:"medium",tradeAmount:100,stopLoss:2,takeProfit:4}),[m,p]=v.useState({rsiThreshold:70,adxThreshold:25,bbWidthThreshold:.02,emaSlope:.5,atrPercentage:2.5,vwapDistance:1.2,momentumThreshold:.8,useMLPrediction:!0,minSamplesForML:100}),[d,c]=v.useState({bias_mode:"auto",htf_timeframe:"4h",htf_trend_indicator:"EMA200",ema_fast_period:50,require_price_vs_trend:"any",adx_min_htf:23,require_adx_rising:!0,regime_mode:"auto",adx_trend_min:25,adx_meanrev_max:19,session_filter_enabled:!1,allowed_hours_utc:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],cooldown_bars:8,atr_percentile_min:20,bb_width_min:.012,bb_width_max:.03,min_24h_volume_usd:5e8,max_spread_bps:3,risk_per_trade_pct:.75,daily_loss_limit_pct:3,weekly_loss_limit_pct:6,max_trades_per_day:8,max_concurrent:2,max_consecutive_losses:5,sl_atr_mult:1.3,tp1_r:1,tp2_r:2,tp1_size:.5,breakeven_at_r:.8,trail_after_tp1_atr:1,time_stop_hours:48,rsi_period:14,rsi_oversold:30,rsi_overbought:70,atr_period:14,atr_tp_multiplier:3,use_ml_prediction:!0,ml_confidence_threshold:.6,ml_min_samples:100}),[l,_]=v.useState(!1),[h,x]=v.useState(null),b=["BTCUSDT","ETHUSDT","SOLUSDT","ADAUSDT","DOTUSDT","AVAXUSDT","BNBUSDT","XRPUSDT","MATICUSDT","LINKUSDT","UNIUSDT","LTCUSDT"];v.useEffect(()=>{if(i&&r.length>0){const t=r.find(a=>a.id===i);console.log("Edit bot: Found bot:",t),t?(u({name:t.name,exchange:t.exchange,tradingType:t.tradingType,symbol:t.symbol,timeframe:t.timeframe||"1h",leverage:t.leverage||5,riskLevel:t.riskLevel,tradeAmount:t.tradeAmount||100,stopLoss:t.stopLoss||2,takeProfit:t.takeProfit||4}),t.strategy&&p(t.strategy),t.strategyConfig&&c(a=>({...a,...t.strategyConfig,atr_period:t.strategyConfig.atr_period??a.atr_period??14,atr_tp_multiplier:t.strategyConfig.atr_tp_multiplier??a.atr_tp_multiplier??3,ema_fast_period:t.strategyConfig.ema_fast_period??a.ema_fast_period,rsi_period:t.strategyConfig.rsi_period??a.rsi_period??14,rsi_overbought:t.strategyConfig.rsi_overbought??a.rsi_overbought??70,rsi_oversold:t.strategyConfig.rsi_oversold??a.rsi_oversold??30,sl_atr_mult:t.strategyConfig.sl_atr_mult??a.sl_atr_mult})),console.log("Edit bot: Form data set:",o)):console.log("Edit bot: Bot not found with ID:",i)}},[i,r]);const w=async t=>{if(t.preventDefault(),!!i){_(!0),x(null);try{const a={name:o.name,exchange:o.exchange,tradingType:o.tradingType,symbol:o.symbol,timeframe:o.timeframe,leverage:o.leverage,riskLevel:o.riskLevel,tradeAmount:o.tradeAmount,stopLoss:o.stopLoss,takeProfit:o.takeProfit,strategy:m,strategyConfig:d};console.log("Edit bot: Updating bot data:",a),console.log("Edit bot: Bot ID:",i),await s(i,a),console.log("Edit bot: Update successful, navigating..."),g("/bots",{state:{message:`Bot "${o.name}" updated successfully!`}})}catch(a){console.error("Edit bot: Update failed:",a),x(a.message||"Failed to update bot")}finally{_(!1)}}},j=(t,a)=>{u(S=>({...S,[t]:a}))},N=(t,a)=>{p(S=>({...S,[t]:a}))},O=t=>{p({...t.strategy}),c(a=>({...a,...t.advanced,allowed_hours_utc:[...t.advanced.allowed_hours_utc]})),u(a=>({...a,tradeAmount:t.recommendedTradeAmount??a.tradeAmount,stopLoss:t.recommendedStopLoss??a.stopLoss,takeProfit:t.recommendedTakeProfit??a.takeProfit,riskLevel:t.recommendedRiskLevel??a.riskLevel})),console.log("Applied strategy preset:",t.key)};return i?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(F,{title:"Edit Bot"}),e.jsx("div",{className:"pt-16 pb-6 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsxs(P,{variant:"secondary",onClick:()=>g("/bots"),className:"mr-4",children:[e.jsx("i",{className:"ri-arrow-left-line mr-2"}),"Back to Bots"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Trading Bot"})]}),e.jsx("form",{onSubmit:w,children:e.jsx(L,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bot Name"}),e.jsx("input",{type:"text",value:o.name,onChange:t=>j("name",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter bot name",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exchange"}),e.jsxs("select",{value:o.exchange,onChange:t=>j("exchange",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"bybit",children:"Bybit"}),e.jsx("option",{value:"okx",children:"OKX"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trading Type"}),e.jsxs("select",{value:o.tradingType,onChange:t=>j("tradingType",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"spot",children:"Spot Trading"}),e.jsx("option",{value:"futures",children:"Futures Trading"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trading Pair"}),e.jsx("select",{value:o.symbol,onChange:t=>j("symbol",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:b.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Frame"}),e.jsxs("select",{value:o.timeframe,onChange:t=>j("timeframe",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"1m",children:"1 Minute"}),e.jsx("option",{value:"5m",children:"5 Minutes"}),e.jsx("option",{value:"15m",children:"15 Minutes"}),e.jsx("option",{value:"1h",children:"1 Hour"}),e.jsx("option",{value:"2h",children:"2 Hours"}),e.jsx("option",{value:"3h",children:"3 Hours"}),e.jsx("option",{value:"4h",children:"4 Hours"}),e.jsx("option",{value:"1d",children:"1 Day"}),e.jsx("option",{value:"1w",children:"1 Week"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Chart interval for technical analysis"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Leverage"}),e.jsxs("select",{value:o.leverage,onChange:t=>j("leverage",parseInt(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:1,children:"1x"}),e.jsx("option",{value:2,children:"2x"}),e.jsx("option",{value:3,children:"3x"}),e.jsx("option",{value:5,children:"5x"}),e.jsx("option",{value:10,children:"10x"}),e.jsx("option",{value:20,children:"20x"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Risk Level"}),e.jsxs("select",{value:o.riskLevel,onChange:t=>j("riskLevel",t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"low",children:"Low Risk"}),e.jsx("option",{value:"medium",children:"Medium Risk"}),e.jsx("option",{value:"high",children:"High Risk"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trade Amount (USD)"}),e.jsx("input",{type:"number",value:o.tradeAmount,onChange:t=>j("tradeAmount",parseFloat(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"10",max:"10000",step:"10",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Base trade amount in USD (will be multiplied by leverage and risk level)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stop Loss (%)"}),e.jsx("input",{type:"number",value:o.stopLoss,onChange:t=>j("stopLoss",parseFloat(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0.5",max:"10",step:"0.5",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum loss percentage before closing position"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Take Profit (%)"}),e.jsx("input",{type:"number",value:o.takeProfit,onChange:t=>j("takeProfit",parseFloat(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"20",step:"0.5",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Target profit percentage before closing position"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cooldown (Bars)"}),e.jsx("input",{type:"number",value:d.cooldown_bars,onChange:t=>c(a=>({...a,cooldown_bars:parseInt(t.target.value)||8})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"100",step:"1"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Number of bars to wait between trades (prevents overtrading)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Allowed Trading Hours (EST)"}),e.jsxs("div",{className:"border border-gray-300 rounded-lg p-3 bg-gray-50 max-h-48 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",checked:d.allowed_hours_utc.length===24,onChange:t=>{t.target.checked?c(a=>({...a,allowed_hours_utc:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],session_filter_enabled:!1})):c(a=>({...a,allowed_hours_utc:[],session_filter_enabled:!0}))},className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Select All (24/7)"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:Array.from({length:24},(t,a)=>{const S=(a-5+24)%24,E=d.allowed_hours_utc.includes(a);return e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:C=>{C.target.checked?c(k=>({...k,allowed_hours_utc:[...k.allowed_hours_utc,a].sort((A,M)=>A-M),session_filter_enabled:!0})):c(k=>({...k,allowed_hours_utc:k.allowed_hours_utc.filter(A=>A!==a),session_filter_enabled:k.allowed_hours_utc.filter(A=>A!==a).length>0}))},className:"mr-1 h-3 w-3 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("span",{className:"text-xs text-gray-700",children:[S.toString().padStart(2,"0"),":00 EST"]})]},a)})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select hours when bot is allowed to trade (stored in UTC, displayed in EST)"})]}),e.jsxs("div",{className:"border border-indigo-200 rounded-lg p-4 bg-indigo-50",children:[e.jsxs("h3",{className:"text-md font-semibold text-indigo-900 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"ri-sliders-line"}),"Indicator Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EMA Length"}),e.jsx("input",{type:"number",value:d.ema_fast_period??50,onChange:t=>c(a=>({...a,ema_fast_period:parseInt(t.target.value)||50})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:1,max:500})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ATR Length"}),e.jsx("input",{type:"number",value:d.atr_period??14,onChange:t=>c(a=>({...a,atr_period:parseInt(t.target.value)||14})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:1,max:200})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ATR TP Multiplier"}),e.jsx("input",{type:"number",value:d.atr_tp_multiplier??3,onChange:t=>c(a=>({...a,atr_tp_multiplier:parseFloat(t.target.value)||3})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:.5,max:10,step:.1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ATR SL Multiplier"}),e.jsx("input",{type:"number",value:d.sl_atr_mult,onChange:t=>c(a=>({...a,sl_atr_mult:parseFloat(t.target.value)||a.sl_atr_mult})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:.5,max:5,step:.1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RSI Length"}),e.jsx("input",{type:"number",value:d.rsi_period??14,onChange:t=>c(a=>({...a,rsi_period:parseInt(t.target.value)||14})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:5,max:50})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RSI Overbought"}),e.jsx("input",{type:"number",value:d.rsi_overbought??70,onChange:t=>c(a=>({...a,rsi_overbought:parseInt(t.target.value)||70})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:50,max:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RSI Oversold"}),e.jsx("input",{type:"number",value:d.rsi_oversold??30,onChange:t=>c(a=>({...a,rsi_oversold:parseInt(t.target.value)||30})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:0,max:50})]})]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Strategy Settings"}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"font-semibold text-purple-900 flex items-center gap-2 text-sm md:text-base",children:[e.jsx("i",{className:"ri-brain-line"}),"AI Strategy Presets"]}),e.jsx("span",{className:"hidden md:block text-xs text-purple-700",children:"Rapidly align this bot with proven AI templates"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:H.map(t=>e.jsxs("button",{type:"button",onClick:()=>O(t),className:"px-3 py-2 rounded-lg border border-purple-300 bg-white text-purple-700 hover:bg-purple-100 text-sm font-medium flex items-center gap-2 transition-colors",children:[e.jsx("i",{className:"ri-flashlight-line"}),t.label]},t.key))}),e.jsx("p",{className:"text-xs text-purple-700 mt-3",children:"Applying a preset updates strategy parameters, risk controls, and recommended trade sizing."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RSI Threshold"}),e.jsx("input",{type:"number",value:m.rsiThreshold,onChange:t=>N("rsiThreshold",parseInt(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"50",max:"90",step:"5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ADX Threshold"}),e.jsx("input",{type:"number",value:m.adxThreshold,onChange:t=>N("adxThreshold",parseInt(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"15",max:"50",step:"5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bollinger Band Width Threshold"}),e.jsx("input",{type:"number",value:m.bbWidthThreshold,onChange:t=>N("bbWidthThreshold",parseFloat(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0.01",max:"0.1",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"EMA Slope"}),e.jsx("input",{type:"number",value:m.emaSlope,onChange:t=>N("emaSlope",parseFloat(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0.1",max:"2.0",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ATR Percentage"}),e.jsx("input",{type:"number",value:m.atrPercentage,onChange:t=>N("atrPercentage",parseFloat(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1.0",max:"5.0",step:"0.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"VWAP Distance"}),e.jsx("input",{type:"number",value:m.vwapDistance,onChange:t=>N("vwapDistance",parseFloat(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0.5",max:"3.0",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Momentum Threshold"}),e.jsx("input",{type:"number",value:m.momentumThreshold,onChange:t=>N("momentumThreshold",parseFloat(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0.5",max:"2.0",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Min Samples for ML"}),e.jsx("input",{type:"number",value:m.minSamplesForML,onChange:t=>N("minSamplesForML",parseInt(t.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"50",max:"1000",step:"50"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:m.useMLPrediction,onChange:t=>N("useMLPrediction",t.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Use Machine Learning Prediction"})]})})]}),h&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-600",children:h})}),e.jsxs("div",{className:"flex space-x-4 pt-6 border-t",children:[e.jsx(P,{type:"submit",variant:"primary",className:"flex-1",disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Updating Bot..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-save-line mr-2"}),"Update Bot"]})}),e.jsx(P,{type:"button",variant:"secondary",onClick:()=>g("/bots"),children:"Cancel"})]})]})})}),i&&e.jsx("div",{className:"mt-6",children:(()=>{const t=r.find(a=>a.id===i);return t?e.jsx(Z,{bot:t}):e.jsx(L,{title:"AI Auto-Optimization",className:"mt-4",children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mb-2"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading bot information..."})]})})})()})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(F,{title:"Edit Bot"}),e.jsx("div",{className:"pt-16 pb-6 px-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(L,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500",children:"Bot not found"}),e.jsx(P,{variant:"primary",onClick:()=>g("/bots"),className:"mt-4",children:"Back to Bots"})]})})})})]})}export{oe as default};
