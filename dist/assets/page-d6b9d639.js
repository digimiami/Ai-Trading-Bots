import{r as S,j as e,g as O,s as R}from"./index-ccd4a5cb.js";import{H as U}from"./Header-d6a66a83.js";import{N as z}from"./Navigation-e6e83e37.js";import{B as y}from"./Button-68800a8d.js";import{C as $}from"./Card-4fe9f738.js";import{u as W}from"./useBotActivity-708ee786.js";import{u as G}from"./useBots-321504e8.js";function V({activity:t,onClearLogs:l,onSimulateActivity:h}){const[j,b]=S.useState(!1),[o,v]=S.useState("all"),[d,m]=S.useState("");S.useEffect(()=>{const n=()=>{if(t.lastActivity){const A=Date.now()-new Date(t.lastActivity).getTime(),i=Math.floor(A/1e3),x=Math.floor(i/60),C=Math.floor(x/60);C>0?m(`${C}h ${x%60}m ago`):x>0?m(`${x}m ${i%60}s ago`):m(`${i}s ago`)}};n();const L=setInterval(n,1e3);return()=>clearInterval(L)},[t.lastActivity]);const a=n=>{switch(n){case"info":return"text-blue-600 bg-blue-50";case"warning":return"text-yellow-600 bg-yellow-50";case"error":return"text-red-600 bg-red-50";case"success":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},w=n=>{switch(n){case"market":return"ri-line-chart-line";case"trade":return"ri-exchange-line";case"strategy":return"ri-brain-line";case"system":return"ri-settings-line";case"error":return"ri-error-warning-line";default:return"ri-information-line"}},r=n=>{switch(n){case"running":return"ri-play-circle-fill text-green-500";case"paused":return"ri-pause-circle-fill text-yellow-500";case"stopped":return"ri-stop-circle-fill text-red-500";default:return"ri-question-mark-circle-fill text-gray-500"}},p=n=>{switch(n){case"executing":return{icon:"ri-loader-4-line animate-spin",color:"bg-purple-100 text-purple-800 border-purple-200",label:"Executing",badge:"Executing Trade"};case"analyzing":return{icon:"ri-bar-chart-line",color:"bg-blue-100 text-blue-800 border-blue-200",label:"Analyzing",badge:"Analyzing Market"};case"waiting":return{icon:"ri-time-line",color:"bg-yellow-100 text-yellow-800 border-yellow-200",label:"Waiting",badge:"Waiting for Signal"};case"error":return{icon:"ri-error-warning-line",color:"bg-red-100 text-red-800 border-red-200",label:"Error",badge:"Error Detected"};case"idle":return{icon:"ri-pause-line",color:"bg-gray-100 text-gray-800 border-gray-200",label:"Idle",badge:"Not Running"};default:return{icon:"ri-question-line",color:"bg-gray-100 text-gray-800 border-gray-200",label:"Unknown",badge:"Unknown State"}}},N=t.logs.filter(n=>o==="all"||n.level===o),c=t.logs.find(n=>{var L,A;return((L=n.message)==null?void 0:L.includes("Performance Update"))||((A=n.details)==null?void 0:A.winTrades)!==void 0}),s=(c==null?void 0:c.details)||null,g=(s==null?void 0:s.winTrades)||0,_=(s==null?void 0:s.lossTrades)||0,f=(s==null?void 0:s.drawdown)||0,u=(s==null?void 0:s.drawdownPercentage)||0,F=(s==null?void 0:s.winRate)||0,E=(s==null?void 0:s.totalTrades)||0,T=n=>new Date(n).toLocaleTimeString();return e.jsxs($,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("i",{className:`${r(t.status)} text-xl`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.botName}),t.executionState&&e.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium border ${p(t.executionState).color}`,children:[e.jsx("i",{className:`${p(t.executionState).icon} mr-1`}),p(t.executionState).badge]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:t.currentAction||"No recent activity"}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[d&&e.jsxs("span",{children:[e.jsx("i",{className:"ri-time-line mr-1"}),d]}),t.lastExecutionTime&&e.jsxs("span",{children:[e.jsx("i",{className:"ri-exchange-line mr-1"}),"Last trade: ",new Date(t.lastExecutionTime).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.status}),e.jsx(y,{variant:"secondary",size:"sm",onClick:()=>b(!j),children:e.jsx("i",{className:`ri-${j?"arrow-up":"arrow-down"}-line`})})]})]}),s&&e.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-line-chart-line mr-2 text-blue-600"}),"Performance Metrics"]}),c&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Updated: ",T(c.timestamp)]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Win Trades"}),e.jsx("i",{className:"ri-arrow-up-line text-green-600"})]}),e.jsx("div",{className:"text-xl font-bold text-green-600",children:g}),e.jsxs("div",{className:"text-xs text-gray-500",children:[E>0?`${(g/E*100).toFixed(1)}%`:"0%"," of total"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-red-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Loss Trades"}),e.jsx("i",{className:"ri-arrow-down-line text-red-600"})]}),e.jsx("div",{className:"text-xl font-bold text-red-600",children:_}),e.jsxs("div",{className:"text-xs text-gray-500",children:[E>0?`${(_/E*100).toFixed(1)}%`:"0%"," of total"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Win Rate"}),e.jsx("i",{className:"ri-percent-line text-blue-600"})]}),e.jsxs("div",{className:"text-xl font-bold text-blue-600",children:[F.toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[E," total trades"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-orange-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Drawdown"}),e.jsx("i",{className:"ri-line-chart-line text-orange-600"})]}),e.jsxs("div",{className:"text-xl font-bold text-orange-600",children:["$",f.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[u.toFixed(1),"% of peak"]})]})]}),s.peakPnL!==void 0&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200 grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Peak P&L:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["$",(s.peakPnL||0).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Current P&L:"}),e.jsxs("span",{className:`font-medium ${(s.currentPnL||0)>=0?"text-green-600":"text-red-600"}`,children:["$",(s.currentPnL||0).toFixed(2)]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:t.logs.length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Logs"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:t.successCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Success"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-yellow-600",children:t.logs.filter(n=>n.level==="warning").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Warnings"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-red-600",children:t.errorCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Errors"})]})]}),e.jsx("div",{className:"mb-4 p-3 rounded-lg border-2",style:{backgroundColor:t.executionState==="executing"?"#f3e8ff":t.executionState==="analyzing"?"#eff6ff":t.executionState==="waiting"?"#fefce8":t.executionState==="error"?"#fef2f2":"#f9fafb",borderColor:t.executionState==="executing"?"#c084fc":t.executionState==="analyzing"?"#60a5fa":t.executionState==="waiting"?"#eab308":t.executionState==="error"?"#f87171":"#e5e7eb"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[t.executionState&&e.jsx("i",{className:`${p(t.executionState).icon} text-lg ${t.executionState==="executing"?"text-purple-600":t.executionState==="analyzing"?"text-blue-600":t.executionState==="waiting"?"text-yellow-600":t.executionState==="error"?"text-red-600":"text-gray-600"}`}),e.jsxs("div",{children:[e.jsxs("span",{className:`text-sm font-medium ${t.executionState==="executing"?"text-purple-800":t.executionState==="analyzing"?"text-blue-800":t.executionState==="waiting"?"text-yellow-800":t.executionState==="error"?"text-red-800":"text-gray-800"}`,children:[t.executionState?p(t.executionState).label:"Status",":"]}),e.jsx("span",{className:`ml-2 text-sm ${t.executionState==="executing"?"text-purple-700":t.executionState==="analyzing"?"text-blue-700":t.executionState==="waiting"?"text-yellow-700":t.executionState==="error"?"text-red-700":"text-gray-700"}`,children:t.currentAction||"No activity"})]})]}),t.waitingFor&&e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("i",{className:"ri-hourglass-line mr-1"}),t.waitingFor]})]})}),j&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex space-x-2",children:["all","info","warning","error","success"].map(n=>e.jsx("button",{onClick:()=>v(n),className:`px-3 py-1 rounded-full text-xs font-medium ${o===n?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:n.charAt(0).toUpperCase()+n.slice(1)},n))}),e.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:N.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("i",{className:"ri-file-list-line text-2xl mb-2"}),e.jsx("p",{children:"No logs found"})]}):N.map(n=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${a(n.level)}`,children:e.jsx("i",{className:`${w(n.category)} text-sm`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a(n.level)}`,children:n.level}),e.jsx("span",{className:"text-xs text-gray-500",children:T(n.timestamp)})]}),e.jsx("p",{className:"text-sm text-gray-900 mb-1",children:n.message}),n.details&&e.jsxs("details",{className:"text-xs text-gray-600",children:[e.jsx("summary",{className:"cursor-pointer hover:text-gray-800",children:"Details"}),e.jsx("pre",{className:"mt-1 p-2 bg-white rounded border text-xs overflow-x-auto",children:JSON.stringify(n.details,null,2)})]})]})]},n.id))}),e.jsxs("div",{className:"flex space-x-2 pt-4 border-t border-gray-200",children:[e.jsxs(y,{variant:"secondary",size:"sm",onClick:()=>h(t.botId),children:[e.jsx("i",{className:"ri-play-line mr-1"}),"Simulate Activity"]}),e.jsxs(y,{variant:"danger",size:"sm",onClick:()=>l(t.botId),children:[e.jsx("i",{className:"ri-delete-bin-line mr-1"}),"Clear Logs"]})]})]})]})}const B={}.VITE_PUBLIC_SUPABASE_URL||{}.VITE_SUPABASE_URL,M={}.VITE_PUBLIC_SUPABASE_ANON_KEY||{}.VITE_SUPABASE_ANON_KEY;async function Y(){const t=O(B,M),{data:{session:l}}=await t.auth.getSession();if(!l)throw new Error("Not authenticated");const h=await fetch(`${B}/functions/v1/bot-report`,{method:"GET",headers:{Authorization:`Bearer ${l.access_token}`,"Content-Type":"application/json"}});if(!h.ok){const b=await h.json();throw new Error(b.error||"Failed to generate report")}return(await h.json()).report}function J(){const[t,l]=S.useState(null),[h,j]=S.useState(!1),[b,o]=S.useState(null),v=async()=>{j(!0),o(null);try{const a=await Y();l(a)}catch(a){o(a.message||"Failed to generate report")}finally{j(!1)}},d=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(a),m=(a,w)=>{if(a)if(w==="json"){const r=JSON.stringify(a,null,2),p=new Blob([r],{type:"application/json"}),N=URL.createObjectURL(p),c=document.createElement("a");c.href=N,c.download=`bot-performance-report-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(N)}else{let r=`Bot Performance Report
`;r+=`Generated: ${new Date(a.generated_at).toLocaleString()}

`,r+=`OVERVIEW SUMMARY
`,r+=`Total Bots,${a.overview.total_bots}
`,r+=`Active Bots,${a.overview.active_bots}
`,r+=`Total P&L,${a.overview.total_pnl.toFixed(2)}
`,r+=`Total Fees Paid,${a.overview.total_fees.toFixed(2)}
`,r+=`Net Profit/Loss,${a.overview.net_profit_loss.toFixed(2)}
`,r+=`Total Trades,${a.overview.total_trades}

`,a.contract_summary&&a.contract_summary.length>0&&(r+=`CONTRACT PERFORMANCE
`,r+=`Contract,Exchange,Trades,Total P&L,Total Fees Paid,Net Profit/Loss
`,a.contract_summary.forEach(s=>{r+=`${s.contract},${s.exchange},${s.total_trades},${s.total_net_pnl.toFixed(2)},${s.total_fees_paid.toFixed(2)},${s.net_profit_loss.toFixed(2)}
`}),r+=`
`),a.active_bots&&a.active_bots.length>0&&(r+=`ACTIVE BOTS
`,r+=`Bot Name,Symbol,Exchange,P&L,Total Fees,Net Profit/Loss,Total Trades,Win Rate
`,a.active_bots.forEach(s=>{r+=`${s.name},${s.symbol},${s.exchange},${s.pnl.toFixed(2)},${(s.total_fees||0).toFixed(2)},${(s.net_profit_loss||0).toFixed(2)},${s.total_trades},${s.win_rate.toFixed(2)}%
`}));const p=new Blob([r],{type:"text/csv;charset=utf-8;"}),N=URL.createObjectURL(p),c=document.createElement("a");c.href=N,c.download=`bot-performance-report-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(N)}};return e.jsxs($,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bot Performance Report"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Generate comprehensive report with P&L and fees"})]}),e.jsxs("div",{className:"flex space-x-2",children:[t&&e.jsxs(y,{variant:"secondary",onClick:()=>m(t,"csv"),children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Download CSV"]}),t&&e.jsxs(y,{variant:"secondary",onClick:()=>m(t,"json"),children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Download JSON"]}),e.jsx(y,{variant:"primary",onClick:v,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-file-chart-line mr-2"}),"Generate Report"]})})]})]}),b&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600 text-sm",children:b})}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Overview Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.overview.total_bots}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Bots"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.overview.active_bots}),e.jsx("div",{className:"text-sm text-gray-500",children:"Active Bots"})]}),e.jsxs("div",{children:[e.jsx("div",{className:`text-2xl font-bold ${t.overview.total_pnl>=0?"text-green-600":"text-red-600"}`,children:d(t.overview.total_pnl)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total P&L"})]}),e.jsxs("div",{children:[e.jsx("div",{className:`text-2xl font-bold ${t.overview.net_profit_loss>=0?"text-green-600":"text-red-600"}`,children:d(t.overview.net_profit_loss)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Net Profit/Loss"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-700",children:d(t.overview.total_fees)}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Fees Paid"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-700",children:t.overview.total_trades}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Trades"})]}),e.jsx("div",{children:e.jsxs("div",{className:"text-xs text-gray-500",children:["Generated: ",new Date(t.generated_at).toLocaleString()]})})]})]}),t.contract_summary&&t.contract_summary.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Contract Performance"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Contract"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Exchange"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Trades"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Win/Loss"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Win Rate"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Total P&L"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Fees"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Net Profit/Loss"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Drawdown"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Peak/Current P&L"})]})}),e.jsx("tbody",{children:t.contract_summary.map((a,w)=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:a.contract}),e.jsx("td",{className:"py-2 px-3 text-gray-600",children:a.exchange}),e.jsx("td",{className:"py-2 px-3 text-right",children:a.total_trades}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("span",{className:"text-green-600 font-medium",children:a.win_trades||0}),e.jsx("span",{className:"text-gray-400 mx-1",children:"/"}),e.jsx("span",{className:"text-red-600 font-medium",children:a.loss_trades||0})]}),e.jsx("td",{className:"py-2 px-3 text-right",children:e.jsxs("span",{className:`font-medium ${(a.win_rate||0)>=50?"text-green-600":"text-red-600"}`,children:[(a.win_rate||0).toFixed(1),"%"]})}),e.jsx("td",{className:`py-2 px-3 text-right font-medium ${a.total_net_pnl>=0?"text-green-600":"text-red-600"}`,children:d(a.total_net_pnl)}),e.jsx("td",{className:"py-2 px-3 text-right text-gray-600",children:d(a.total_fees_paid)}),e.jsx("td",{className:`py-2 px-3 text-right font-semibold ${a.net_profit_loss>=0?"text-green-600":"text-red-600"}`,children:d(a.net_profit_loss)}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("div",{className:"text-red-600 font-medium",children:d(a.drawdown||0)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(a.drawdown_percentage||0).toFixed(1),"%"]})]}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("div",{className:"text-green-600 font-medium",children:d(a.peak_pnl||0)}),e.jsx("div",{className:`text-xs font-medium ${(a.current_pnl||0)>=0?"text-green-600":"text-red-600"}`,children:d(a.current_pnl||0)})]})]},w))})]})})]}),t.active_bots&&t.active_bots.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Active Bots"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Bot Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Symbol"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Exchange"}),e.jsx("th",{className:"text-right py-2 px-3",children:"P&L"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Fees"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Net Profit/Loss"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Trades"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Win/Loss"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Win Rate"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Drawdown"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Peak/Current P&L"})]})}),e.jsx("tbody",{children:t.active_bots.map(a=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:a.name}),e.jsx("td",{className:"py-2 px-3 text-gray-600",children:a.symbol}),e.jsx("td",{className:"py-2 px-3 text-gray-600",children:a.exchange}),e.jsx("td",{className:`py-2 px-3 text-right font-medium ${a.pnl>=0?"text-green-600":"text-red-600"}`,children:d(a.pnl)}),e.jsx("td",{className:"py-2 px-3 text-right text-gray-600",children:d(a.total_fees||0)}),e.jsx("td",{className:`py-2 px-3 text-right font-semibold ${(a.net_profit_loss||0)>=0?"text-green-600":"text-red-600"}`,children:d(a.net_profit_loss||0)}),e.jsx("td",{className:"py-2 px-3 text-right",children:a.total_trades}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("span",{className:"text-green-600 font-medium",children:a.win_trades||0}),e.jsx("span",{className:"text-gray-400 mx-1",children:"/"}),e.jsx("span",{className:"text-red-600 font-medium",children:a.loss_trades||0})]}),e.jsx("td",{className:"py-2 px-3 text-right",children:e.jsxs("span",{className:`font-medium ${a.win_rate>=50?"text-green-600":"text-red-600"}`,children:[a.win_rate.toFixed(1),"%"]})}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("div",{className:"text-red-600 font-medium",children:d(a.drawdown||0)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(a.drawdown_percentage||0).toFixed(1),"%"]})]}),e.jsxs("td",{className:"py-2 px-3 text-right",children:[e.jsx("div",{className:"text-green-600 font-medium",children:d(a.peak_pnl||0)}),e.jsx("div",{className:`text-xs font-medium ${(a.current_pnl||0)>=0?"text-green-600":"text-red-600"}`,children:d(a.current_pnl||0)})]})]},a.id))})]})})]})]})]})}async function q(t,l){const{data:{user:h}}=await R.auth.getUser();if(!h)throw new Error("Not authenticated");const j=l||new Date,b=t||new Date(Date.now()-7*24*60*60*1e3),{data:o,error:v}=await R.from("trading_bots").select("id, name, status").eq("user_id",h.id);if(v)throw v;const d=(o==null?void 0:o.map(i=>i.id))||[];let m=[];if(d.length>0){const{data:i,error:x}=await R.from("bot_activity_logs").select("*").in("bot_id",d).gte("timestamp",b.toISOString()).lte("timestamp",j.toISOString()).order("timestamp",{ascending:!1}).limit(1e4);if(x)throw x;m=i||[]}const{data:a,error:w}=await R.from("trades").select("pnl, status, created_at").eq("user_id",h.id).gte("created_at",b.toISOString()).lte("created_at",j.toISOString());if(w)throw w;const r=(o==null?void 0:o.length)||0,p=(o==null?void 0:o.filter(i=>i.status==="running").length)||0,N=m.length,c=m.filter(i=>i.level==="error").length,s=m.filter(i=>i.level==="warning").length,g=m.filter(i=>i.level==="success").length,_=m.filter(i=>i.level==="info").length,f=(a==null?void 0:a.filter(i=>i.status==="filled"||i.status==="closed"))||[],u=f.length;f.reduce((i,x)=>i+(parseFloat(x.pnl||"0")||0),0);const F=f.filter(i=>(parseFloat(i.pnl||"0")||0)>0).length,E=u>0?F/u*100:0,T=new Map;o==null||o.forEach(i=>{T.set(i.id,{bot_id:i.id,bot_name:i.name,status:i.status,total_logs:0,errors:0,warnings:0,successes:0,last_activity:"",recent_logs:[]})}),m.forEach(i=>{const x=T.get(i.bot_id);x&&(x.total_logs++,i.level==="error"&&x.errors++,i.level==="warning"&&x.warnings++,i.level==="success"&&x.successes++,(!x.last_activity||i.timestamp>x.last_activity)&&(x.last_activity=i.timestamp),x.recent_logs.length<10&&x.recent_logs.push({timestamp:i.timestamp,level:i.level,category:i.category,message:i.message,details:i.details}))});const n=[];T.forEach((i,x)=>{var C;if(i.errors>0){const k=m.filter(P=>P.bot_id===x&&P.level==="error"),D=k.map(P=>P.message),I=Array.from(new Set(D.slice(0,5)));n.push({bot_name:i.bot_name,error_count:i.errors,last_error:((C=k[0])==null?void 0:C.timestamp)||"",common_errors:I})}});const{data:L}=await R.from("trading_bots").select("id, pnl").eq("user_id",h.id).in("id",d),A=(L==null?void 0:L.filter(i=>(parseFloat(i.pnl||"0")||0)>0).length)||0;return{generated_at:new Date().toISOString(),period:{start:b.toISOString(),end:j.toISOString()},overview:{total_bots:r,active_bots:p,total_logs:N,errors:c,warnings:s,successes:g,info_logs:_},bot_activity:Array.from(T.values()),performance_summary:{total_trades:u,total_pnl,win_rate:E,profitable_bots:A},errors_summary:n}}function K(){var p,N,c;const[t,l]=S.useState(null),[h,j]=S.useState(!1),[b,o]=S.useState(null),[v,d]=S.useState("7d"),m=async()=>{j(!0),o(null);try{let s;const g=new Date;switch(v){case"7d":s=new Date(Date.now()-7*24*60*60*1e3);break;case"30d":s=new Date(Date.now()-30*24*60*60*1e3);break;case"60d":s=new Date(Date.now()-60*24*60*60*1e3);break;case"90d":s=new Date(Date.now()-90*24*60*60*1e3);break;default:s=new Date(Date.now()-7*24*60*60*1e3)}const _=await q(s,g);l(_)}catch(s){o(s.message||"Failed to generate report"),console.error("Report generation error:",s)}finally{j(!1)}},a=()=>{if(!t)return;const s=H(t),g=window.open("","_blank");g&&(g.document.write(s),g.document.close(),g.focus(),setTimeout(()=>{g.print()},250))},w=()=>{if(!t)return;let s=`Activity Report
`;s+=`Generated: ${new Date(t.generated_at).toLocaleString()}
`,s+=`Period: ${new Date(t.period.start).toLocaleDateString()} - ${new Date(t.period.end).toLocaleDateString()}

`,s+=`OVERVIEW
`,s+=`Total Bots,${t.overview.total_bots}
`,s+=`Active Bots,${t.overview.active_bots}
`,s+=`Total Logs,${t.overview.total_logs}
`,s+=`Errors,${t.overview.errors}
`,s+=`Warnings,${t.overview.warnings}
`,s+=`Successes,${t.overview.successes}
`,s+=`Info Logs,${t.overview.info_logs}

`,s+=`PERFORMANCE SUMMARY
`,s+=`Total Trades,${t.performance_summary.total_trades}
`,s+=`Total P&L,${t.performance_summary.total_pnl.toFixed(2)}
`,s+=`Win Rate,${t.performance_summary.win_rate.toFixed(2)}%
`,s+=`Profitable Bots,${t.performance_summary.profitable_bots}

`,s+=`BOT ACTIVITY
`,s+=`Bot Name,Status,Total Logs,Errors,Warnings,Successes,Last Activity
`,t.bot_activity.forEach(u=>{s+=`${u.bot_name},${u.status},${u.total_logs},${u.errors},${u.warnings},${u.successes},${new Date(u.last_activity).toLocaleString()}
`}),s+=`
`,t.errors_summary.length>0&&(s+=`ERRORS SUMMARY
`,s+=`Bot Name,Error Count,Last Error,Common Errors
`,t.errors_summary.forEach(u=>{s+=`${u.bot_name},${u.error_count},${new Date(u.last_error).toLocaleString()},"${u.common_errors.join("; ")}"
`}));const g=new Blob([s],{type:"text/csv;charset=utf-8;"}),_=URL.createObjectURL(g),f=document.createElement("a");f.href=_,f.download=`activity-report-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(_)},r=()=>{if(!t)return;const s=JSON.stringify(t,null,2),g=new Blob([s],{type:"application/json"}),_=URL.createObjectURL(g),f=document.createElement("a");f.href=_,f.download=`activity-report-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(_)};return e.jsxs($,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-file-chart-2-line mr-2 text-blue-600"}),"Activity Report Generator"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Generate comprehensive reports from bot activity logs"})]}),e.jsxs("div",{className:"flex space-x-2",children:[t&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{variant:"secondary",size:"sm",onClick:a,children:[e.jsx("i",{className:"ri-file-pdf-line mr-2"}),"Export PDF"]}),e.jsxs(y,{variant:"secondary",size:"sm",onClick:w,children:[e.jsx("i",{className:"ri-file-excel-line mr-2"}),"Export CSV"]}),e.jsxs(y,{variant:"secondary",size:"sm",onClick:r,children:[e.jsx("i",{className:"ri-file-code-line mr-2"}),"Export JSON"]})]}),e.jsx(y,{variant:"primary",size:"sm",onClick:m,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-file-chart-line mr-2"}),"Generate Report"]})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Report Period"}),e.jsx("div",{className:"flex space-x-2",children:["7d","30d","60d","90d"].map(s=>e.jsxs("button",{onClick:()=>d(s),className:`px-3 py-2 rounded text-sm font-medium ${v===s?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Last ",s]},s))})]}),b&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600 text-sm",children:b})}),t&&e.jsxs("div",{className:"space-y-6 mt-6",children:[e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Overview Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.overview.total_bots}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Bots"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.overview.active_bots}),e.jsx("div",{className:"text-sm text-gray-500",children:"Active Bots"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.overview.errors}),e.jsx("div",{className:"text-sm text-gray-500",children:"Errors"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.overview.warnings}),e.jsx("div",{className:"text-sm text-gray-500",children:"Warnings"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-gray-700",children:t.overview.total_logs}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Logs"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-green-600",children:t.overview.successes}),e.jsx("div",{className:"text-xs text-gray-500",children:"Successes"})]}),e.jsx("div",{children:e.jsxs("div",{className:"text-xs text-gray-500",children:["Period: ",new Date(t.period.start).toLocaleDateString()," - ",new Date(t.period.end).toLocaleDateString()]})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Performance Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-700",children:t.performance_summary.total_trades}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Trades"})]}),e.jsxs("div",{className:`p-3 rounded-lg ${(((p=t.performance_summary)==null?void 0:p.total_pnl)||0)>=0?"bg-green-50":"bg-red-50"}`,children:[e.jsxs("div",{className:`text-lg font-semibold ${(((N=t.performance_summary)==null?void 0:N.total_pnl)||0)>=0?"text-green-600":"text-red-600"}`,children:["$",(((c=t.performance_summary)==null?void 0:c.total_pnl)||0).toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total P&L"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-700",children:[t.performance_summary.win_rate.toFixed(2),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Win Rate"})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[e.jsx("div",{className:"text-lg font-semibold text-green-600",children:t.performance_summary.profitable_bots}),e.jsx("div",{className:"text-xs text-gray-500",children:"Profitable Bots"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Bot Activity Details"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 px-3",children:"Bot Name"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Status"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Total Logs"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Errors"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Warnings"}),e.jsx("th",{className:"text-right py-2 px-3",children:"Successes"}),e.jsx("th",{className:"text-left py-2 px-3",children:"Last Activity"})]})}),e.jsx("tbody",{children:t.bot_activity.map((s,g)=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-2 px-3 font-medium",children:s.bot_name}),e.jsx("td",{className:"py-2 px-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="running"?"bg-green-100 text-green-800":s.status==="paused"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status})}),e.jsx("td",{className:"py-2 px-3 text-right",children:s.total_logs}),e.jsx("td",{className:"py-2 px-3 text-right text-red-600",children:s.errors}),e.jsx("td",{className:"py-2 px-3 text-right text-yellow-600",children:s.warnings}),e.jsx("td",{className:"py-2 px-3 text-right text-green-600",children:s.successes}),e.jsx("td",{className:"py-2 px-3 text-gray-600 text-xs",children:s.last_activity?new Date(s.last_activity).toLocaleString():"N/A"})]},g))})]})})]}),t.errors_summary.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3 text-red-600",children:"Errors Summary"}),e.jsx("div",{className:"space-y-2",children:t.errors_summary.map((s,g)=>e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.bot_name}),e.jsxs("span",{className:"text-red-600 font-semibold",children:[s.error_count," error(s)"]})]}),e.jsxs("div",{className:"text-xs text-gray-600 mb-1",children:["Last Error: ",new Date(s.last_error).toLocaleString()]}),e.jsxs("div",{className:"text-xs text-gray-700",children:[e.jsx("strong",{children:"Common Errors:"})," ",s.common_errors.join(", ")]})]},g))})]})]})]})}function H(t){return`
<!DOCTYPE html>
<html>
<head>
  <title>Activity Report - ${new Date().toISOString().split("T")[0]}</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      color: #333;
    }
    h1 {
      color: #2563eb;
      border-bottom: 2px solid #2563eb;
      padding-bottom: 10px;
    }
    h2 {
      color: #1f2937;
      margin-top: 30px;
      margin-bottom: 15px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f3f4f6;
      font-weight: bold;
    }
    .stat-box {
      display: inline-block;
      padding: 15px;
      margin: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      min-width: 150px;
    }
    .stat-value {
      font-size: 24px;
      font-weight: bold;
      color: #2563eb;
    }
    .stat-label {
      font-size: 12px;
      color: #666;
      margin-top: 5px;
    }
    .error-box {
      background-color: #fef2f2;
      border-left: 4px solid #ef4444;
      padding: 10px;
      margin: 10px 0;
    }
    @media print {
      body { padding: 0; }
      .no-print { display: none; }
    }
  </style>
</head>
<body>
  <h1>Bot Activity Report</h1>
  <p><strong>Generated:</strong> ${new Date(t.generated_at).toLocaleString()}</p>
  <p><strong>Period:</strong> ${new Date(t.period.start).toLocaleDateString()} - ${new Date(t.period.end).toLocaleDateString()}</p>
  
  <h2>Overview Summary</h2>
  <div>
    <div class="stat-box">
      <div class="stat-value">${t.overview.total_bots}</div>
      <div class="stat-label">Total Bots</div>
    </div>
    <div class="stat-box">
      <div class="stat-value">${t.overview.active_bots}</div>
      <div class="stat-label">Active Bots</div>
    </div>
    <div class="stat-box">
      <div class="stat-value">${t.overview.total_logs}</div>
      <div class="stat-label">Total Logs</div>
    </div>
    <div class="stat-box">
      <div class="stat-value" style="color: #ef4444;">${t.overview.errors}</div>
      <div class="stat-label">Errors</div>
    </div>
    <div class="stat-box">
      <div class="stat-value" style="color: #f59e0b;">${t.overview.warnings}</div>
      <div class="stat-label">Warnings</div>
    </div>
  </div>
  
  <h2>Performance Summary</h2>
  <table>
    <tr>
      <th>Metric</th>
      <th>Value</th>
    </tr>
    <tr>
      <td>Total Trades</td>
      <td>${t.performance_summary.total_trades}</td>
    </tr>
    <tr>
      <td>Total P&L</td>
      <td>$${t.performance_summary.total_pnl.toFixed(2)}</td>
    </tr>
    <tr>
      <td>Win Rate</td>
      <td>${t.performance_summary.win_rate.toFixed(2)}%</td>
    </tr>
    <tr>
      <td>Profitable Bots</td>
      <td>${t.performance_summary.profitable_bots}</td>
    </tr>
  </table>
  
  <h2>Bot Activity Details</h2>
  <table>
    <tr>
      <th>Bot Name</th>
      <th>Status</th>
      <th>Total Logs</th>
      <th>Errors</th>
      <th>Warnings</th>
      <th>Successes</th>
      <th>Last Activity</th>
    </tr>
    ${t.bot_activity.map(l=>`
    <tr>
      <td>${l.bot_name}</td>
      <td>${l.status}</td>
      <td>${l.total_logs}</td>
      <td>${l.errors}</td>
      <td>${l.warnings}</td>
      <td>${l.successes}</td>
      <td>${l.last_activity?new Date(l.last_activity).toLocaleString():"N/A"}</td>
    </tr>
    `).join("")}
  </table>
  
  ${t.errors_summary.length>0?`
  <h2>Errors Summary</h2>
  ${t.errors_summary.map(l=>`
  <div class="error-box">
    <strong>${l.bot_name}</strong> - ${l.error_count} error(s)<br>
    Last Error: ${new Date(l.last_error).toLocaleString()}<br>
    Common Errors: ${l.common_errors.join(", ")}
  </div>
  `).join("")}
  `:""}
  
  <script>
    window.onload = function() {
      setTimeout(function() {
        window.print();
      }, 500);
    };
  <\/script>
</body>
</html>
  `}function ae(){const{bots:t}=G(),{activities:l,loading:h,addLog:j,clearBotLogs:b,simulateBotActivity:o}=W(t),[v,d]=S.useState("all"),m=l.filter(r=>v==="all"||r.status===v),a=async r=>{await j(r,{level:"info",category:"system",message:"Manual test log added",details:{timestamp:new Date().toISOString(),source:"manual"}})},w=async r=>{await j(r,{level:"error",category:"error",message:"Simulated error for testing",details:{error:"Connection timeout",retry:!0}})};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(U,{title:"Bot Activity Logs",subtitle:"Monitor bot operations and debug issues",rightAction:e.jsx("div",{className:"flex space-x-2",children:e.jsxs(y,{variant:"primary",size:"sm",onClick:()=>window.location.reload(),children:[e.jsx("i",{className:"ri-refresh-line mr-1"}),"Refresh"]})})}),e.jsxs("div",{className:"pt-20 pb-20 px-4 space-y-6",children:[e.jsxs($,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("i",{className:"ri-pulse-line mr-2 text-blue-600 animate-pulse"}),"Recent Activity"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Updates every 10s"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[l.filter(r=>r.executionState==="executing").length>0&&e.jsxs("div",{className:"p-4 bg-purple-50 border-2 border-purple-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Executing"}),e.jsx("i",{className:"ri-loader-4-line animate-spin text-purple-600"})]}),e.jsxs("div",{className:"space-y-2",children:[l.filter(r=>r.executionState==="executing").slice(0,3).map(r=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-purple-900",children:r.botName}),e.jsxs("span",{className:"text-purple-700 ml-2",children:["• ",r.currentAction]})]},r.botId)),l.filter(r=>r.executionState==="executing").length>3&&e.jsxs("div",{className:"text-xs text-purple-600",children:["+",l.filter(r=>r.executionState==="executing").length-3," more"]})]})]}),l.filter(r=>r.executionState==="analyzing").length>0&&e.jsxs("div",{className:"p-4 bg-blue-50 border-2 border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Analyzing Market"}),e.jsx("i",{className:"ri-bar-chart-line text-blue-600"})]}),e.jsxs("div",{className:"space-y-2",children:[l.filter(r=>r.executionState==="analyzing").slice(0,3).map(r=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-blue-900",children:r.botName}),e.jsxs("span",{className:"text-blue-700 ml-2",children:["• ",r.currentAction]})]},r.botId)),l.filter(r=>r.executionState==="analyzing").length>3&&e.jsxs("div",{className:"text-xs text-blue-600",children:["+",l.filter(r=>r.executionState==="analyzing").length-3," more"]})]})]}),l.filter(r=>r.executionState==="waiting").length>0&&e.jsxs("div",{className:"p-4 bg-yellow-50 border-2 border-yellow-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-yellow-800",children:"Waiting"}),e.jsx("i",{className:"ri-time-line text-yellow-600"})]}),e.jsxs("div",{className:"space-y-2",children:[l.filter(r=>r.executionState==="waiting").slice(0,3).map(r=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-yellow-900",children:r.botName}),e.jsx("span",{className:"text-yellow-700 ml-2",children:r.waitingFor?`• Waiting: ${r.waitingFor}`:`• ${r.currentAction}`})]},r.botId)),l.filter(r=>r.executionState==="waiting").length>3&&e.jsxs("div",{className:"text-xs text-yellow-600",children:["+",l.filter(r=>r.executionState==="waiting").length-3," more"]})]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 grid grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:l.filter(r=>r.executionState==="executing").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Executing"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.filter(r=>r.executionState==="analyzing").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Analyzing"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:l.filter(r=>r.executionState==="waiting").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Waiting"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:l.filter(r=>r.executionState==="error").length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Errors"})]})]})]}),e.jsx("div",{className:"flex space-x-2 overflow-x-auto",children:["all","running","paused","stopped"].map(r=>e.jsx("button",{onClick:()=>d(r),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap ${v===r?"bg-blue-600 text-white":"bg-white text-gray-600 border border-gray-200"}`,children:r.charAt(0).toUpperCase()+r.slice(1)},r))}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs($,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Bots"})]}),e.jsxs($,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.filter(r=>r.status==="running").length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Active"})]}),e.jsxs($,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:l.reduce((r,p)=>r+p.logs.filter(N=>N.level==="warning").length,0)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Warnings"})]}),e.jsxs($,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:l.reduce((r,p)=>r+p.errorCount,0)}),e.jsx("div",{className:"text-sm text-gray-500",children:"Errors"})]})]}),e.jsx("div",{className:"space-y-4",children:h?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading bot activities..."})]}):m.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-robot-line text-4xl text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No bots found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create some bots to see their activity logs"})]}):m.map(r=>e.jsx(V,{activity:r,onClearLogs:b,onSimulateActivity:o},r.botId))}),e.jsx(K,{}),e.jsx(J,{}),e.jsxs($,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Debug Tools"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Test Logging"}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Add test logs to verify the logging system is working"}),e.jsx("div",{className:"space-x-2",children:l.slice(0,3).map(r=>e.jsxs(y,{variant:"secondary",size:"sm",onClick:()=>a(r.botId),children:["Test ",r.botName]},r.botId))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Error Simulation"}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Simulate errors to test error handling and logging"}),e.jsx("div",{className:"space-x-2",children:l.slice(0,3).map(r=>e.jsxs(y,{variant:"danger",size:"sm",onClick:()=>w(r.botId),children:["Error ",r.botName]},r.botId))})]})]})]})]}),e.jsx(z,{})]})}export{ae as default};
